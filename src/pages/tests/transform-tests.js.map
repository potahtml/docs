{"version":3,"file":"transform-tests.js","sources":["../../../../pota/src/lib/std.js","../../../../pota/src/constants.js","../../../../pota/src/lib/solid.js","../../../../pota/src/lib/reactive.js","../../../../pota/src/use/dom.js","../../../../pota/src/use/css.js","../../../../pota/src/core/scheduler.js","../../../../pota/src/core/props/plugin.js","../../../../pota/src/core/props/property.js","../../../../pota/src/core/props/event.js","../../../../pota/src/use/random.js","../../../../pota/src/core/props/css.js","../../../../pota/src/core/props/lifecycle.js","../../../../pota/src/core/props/style.js","../../../../pota/src/core/props/class.js","../../../../pota/src/core/props/attribute.js","../../../../pota/src/core/props/@main.js","../../../../pota/src/core/renderer.js","transform-tests.jsx"],"sourcesContent":["export const window = globalThis\n\nexport const requestAnimationFrame = window.requestAnimationFrame\nexport const queueMicrotask = window.queueMicrotask\n\nexport const history = window.history\nexport const navigator = window.navigator\nexport const location = window.location\nexport const origin = location?.origin\n\nexport const Object = window.Object\nexport const Array = window.Array\nexport const Promise = window.Promise\nexport const Symbol = window.Symbol\n\nexport const assign = Object.assign\nexport const create = Object.create\nexport const defineProperties = Object.defineProperties\nexport const defineProperty = Object.defineProperty\nexport const entries = Object.entries\nexport const freeze = Object.freeze\nexport const fromEntries = Object.fromEntries\nexport const getOwnPropertyDescriptor =\n\tObject.getOwnPropertyDescriptor\nexport const getOwnPropertyDescriptors =\n\tObject.getOwnPropertyDescriptors\nexport const getOwnPropertyNames = Object.getOwnPropertyNames\nexport const getOwnPropertySymbols = Object.getOwnPropertySymbols\nexport const getPrototypeOf = Object.getPrototypeOf\nexport const groupBy = Object.groupBy\nexport const hasOwnProperty = Object.hasOwn\nexport const is = Object.is\nexport const isExtensible = Object.isExtensible\nexport const keys = Object.keys\nexport const values = Object.values\nexport const setPrototypeOf = Object.setPrototypeOf\n\nexport const toArray = Array.from\n\n/**\n * @template T\n * @param {T} value\n */\nexport const toValues = value =>\n\tisArray(value)\n\t\t? value\n\t\t: isObject(value) && 'values' in value\n\t\t\t? /** @type {{ values(): IterableIterator<T> }} */ (\n\t\t\t\t\tvalue\n\t\t\t\t).values()\n\t\t\t: toArray(/** @type {Iterable<T> | ArrayLike<T>} */ (value))\n\n/**\n * @template T\n * @param {T} value\n */\nexport const toEntries = value =>\n\tisObject(value) && 'entries' in value\n\t\t? /** @type {{ entries(): IterableIterator<[string, T]> }} */ (\n\t\t\t\tvalue\n\t\t\t).entries()\n\t\t: toArray(/** @type {Iterable<T> | ArrayLike<T>} */ (value))\n\nexport const iterator = Symbol.iterator\nexport const Iterator = window.Iterator\n\nexport const stringify = JSON.stringify\n\n/** @param {unknown} o */\nexport const stringifyReadable = o => stringify(o, null, 2)\n\n/** @param {unknown} o */\nexport const stringifySorted = o => {\n\tfunction sort(o) {\n\t\tif (!isObject(o)) {\n\t\t\treturn o\n\t\t}\n\n\t\tconst asArray = isArray(o)\n\t\t/** @type {unknown[] | { [key: string]: unknown }} */\n\t\tconst tmp = asArray ? [] : {}\n\t\tkeys(o)\n\t\t\t.sort()\n\t\t\t.map(k => (tmp[k] = sort(o[k])))\n\n\t\tif (asArray) {\n\t\t\t/** @type {unknown[]} */ tmp.sort((a, b) =>\n\t\t\t\tstringify(a).localeCompare(stringify(b)),\n\t\t\t)\n\t\t}\n\t\treturn tmp\n\t}\n\treturn stringifyReadable(sort(o))\n}\n\nexport const PrototypeArray = Array.prototype\nexport const PrototypeMap = Map.prototype\n\n/**\n * @param {(\n * \tresolve: (value: unknown) => void,\n * \treject: (reason?: any) => void,\n * ) => void} fn\n */\nexport const promise = fn => new Promise(fn)\n\nexport const withResolvers = () => Promise.withResolvers()\n\n/**\n * Given a promise it adds `onDone` to `then` and `catch`\n *\n * ```js\n * resolved(promise, onDone)\n * // is same as\n * promise.then(onDone).catch(onDone)\n * ```\n */\nexport const resolved = (promise, onDone) =>\n\tpromise.then(onDone).catch(onDone)\n\n/**\n * Runs an array of functions\n *\n * @param {Iterable<Function>} fns\n */\nexport const call = fns => {\n\tfor (const fn of fns) fn()\n}\n\n/**\n * @template T\n * @param {T} o\n * @param {Map<T, T>} [seen]\n * @returns {T}\n */\nexport function copy(o, seen = new Map()) {\n\tif (!isObject(o)) {\n\t\treturn o\n\t}\n\n\tif (\n\t\to instanceof Node ||\n\t\to instanceof Date ||\n\t\to instanceof Set ||\n\t\to instanceof Map ||\n\t\to instanceof WeakSet ||\n\t\to instanceof WeakMap ||\n\t\to instanceof Promise ||\n\t\to instanceof RegExp\n\t) {\n\t\treturn o\n\t}\n\n\tif (seen.has(o)) {\n\t\treturn /** @type {T} */ (seen.get(o))\n\t}\n\n\tconst c = /** @type {T} */ isArray(o)\n\t\t? []\n\t\t: /** @type {{ [key: string]: unknown }} */ ({})\n\n\tseen.set(o, c)\n\n\tfor (const k in o) {\n\t\tc[k] = copy(o[k], seen)\n\t}\n\treturn c\n}\n\n/**\n * Object.defineProperty with `enumerable` and `configurable` set to\n * `true` unless overwriten by `descriptor` argument\n *\n * @template T\n * @param {T} target\n * @param {PropertyKey} key\n * @param {PropertyDescriptor} descriptor\n */\nexport const redefineProperty = (target, key, descriptor) =>\n\tdefineProperty(\n\t\ttarget,\n\t\tkey,\n\t\tassign(create(redefinePropertyDefailts), descriptor),\n\t)\n\nconst redefinePropertyDefailts = {\n\t__proto__: null,\n\tconfigurable: true,\n\tenumerable: true,\n}\n\n/**\n * Object.defineProperty with `configurable`, `writable` and\n * `enumerable` as `false`\n *\n * @template T\n * @param {T} target\n * @param {PropertyKey} key\n * @param {any} value\n */\nexport const definePropertyReadOnly = (target, key, value) => {\n\tconst descriptor = create(definePropertyReadOnlyDefaults)\n\tdescriptor.value = value\n\tdefineProperty(target, key, descriptor)\n}\n\nconst definePropertyReadOnlyDefaults = {\n\t__proto__: null,\n\tconfigurable: false,\n\tenumerable: false,\n\twritable: false,\n\tvalue: undefined,\n}\n\n/**\n * Returns an object without a prototype\n *\n * @type {Function}\n */\nexport const empty = Object.create.bind(null, null)\n\n/**\n * An empty frozen array\n *\n * @type {readonly unknown[]}\n */\nexport const emptyArray = freeze([])\n\n/** An empty frozen object */\nexport const nothing = freeze(empty())\n\nexport function* entriesIncludingSymbols(target) {\n\tfor (const item of entries(target)) {\n\t\tyield item\n\t}\n\n\tfor (const item of getOwnPropertySymbols(target)) {\n\t\t// todo: causes access!\n\t\tyield [item, target[item]]\n\t}\n}\n\n// modified version of https://github.com/epoberezkin/fast-deep-equal\n\nexport function equals(a, b) {\n\tif (a === b) {\n\t\treturn true\n\t}\n\n\tif (a && b && typeof a == 'object' && typeof b == 'object') {\n\t\tif (a.constructor !== b.constructor) {\n\t\t\treturn false\n\t\t}\n\n\t\tlet length, i, k\n\t\tif (isArray(a)) {\n\t\t\tlength = a.length\n\t\t\tif (length != b.length) {\n\t\t\t\treturn false\n\t\t\t}\n\t\t\tfor (i = length; i-- !== 0; ) {\n\t\t\t\tif (!equals(a[i], b[i])) {\n\t\t\t\t\treturn false\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn true\n\t\t}\n\n\t\tif (a.constructor === RegExp)\n\t\t\treturn a.source === b.source && a.flags === b.flags\n\t\tif (a.valueOf !== Object.prototype.valueOf)\n\t\t\treturn a.valueOf() === b.valueOf()\n\t\tif (a.toString !== Object.prototype.toString)\n\t\t\treturn a.toString() === b.toString()\n\n\t\tk = keys(a)\n\t\tlength = k.length\n\t\tif (length !== keys(b).length) {\n\t\t\treturn false\n\t\t}\n\n\t\tfor (i = length; i-- !== 0; ) {\n\t\t\tif (!Object.prototype.hasOwnProperty.call(b, k[i])) {\n\t\t\t\treturn false\n\t\t\t}\n\t\t}\n\n\t\tfor (i = length; i-- !== 0; ) {\n\t\t\tvar key = k[i]\n\n\t\t\tif (!equals(a[key], b[key])) {\n\t\t\t\treturn false\n\t\t\t}\n\t\t}\n\n\t\treturn true\n\t}\n\n\t// true if both NaN, false otherwise\n\treturn a !== a && b !== b\n}\n\n/**\n * Unwraps an array/childNodes to the first item if the length is 1\n *\n * @param {any[] | NodeListOf<ChildNode>} arr\n * @returns {any}\n */\nexport const unwrapArray = arr => (arr.length === 1 ? arr[0] : arr)\n\n/**\n * Flats an array/childNodes recursively\n *\n * @template T\n * @param {T[] | T} arr\n */\nexport const flatToArray = arr =>\n\tisArray(arr) ? arr.flat(Infinity) : [arr]\n\n/**\n * Keeps state in the function as the first param\n *\n * @template T\n * @param {T} fn - Function to which add state to it\n * @param {DataStore<Map> | DataStore<WeakMap>} [state] - Passed to\n *   `fn` as first param\n * @returns {T} A copy of the function with the state\n */\nexport const withState = /* #__NO_SIDE_EFFECTS__ */ (\n\tfn,\n\tstate = cacheStore,\n) => fn.bind(null, state())\n\n/** Memoize functions with a map cache */\nexport const withCache = fn =>\n\twithState(\n\t\t(cache, thing) => cache.get(thing, thing => fn(thing)),\n\t\tcacheStore,\n\t)\n/** Memoize functions with a weak cache */\nexport const withWeakCache = fn =>\n\twithState(\n\t\t(cache, thing) => cache.get(thing, thing => fn(thing)),\n\t\tweakStore,\n\t)\n\nexport const getOwnValues = o =>\n\tgetOwnPropertyNames(o).map(key => {\n\t\ttry {\n\t\t\treturn o[key]\n\t\t} catch (e) {}\n\t})\n\nexport function getSetterNamesFromPrototype(object, set = new Set()) {\n\tconst descriptors = getOwnPropertyDescriptors(object)\n\n\tfor (const key in descriptors) {\n\t\tif (descriptors[key].set) {\n\t\t\tset.add(key)\n\t\t}\n\t}\n\n\treturn set\n}\n\n/**\n * Unwraps values. If the argument is a function then it runs it\n * recursively and returns the value\n *\n * @template T\n * @param {Accessor<T>} value - Maybe function\n * @returns T\n */\nexport function getValue(value) {\n\twhile (typeof value === 'function')\n\t\tvalue = /** @type {() => T} */ (value)()\n\treturn value\n}\n\nexport const getValueWithArguments = (value, ...args) =>\n\ttypeof value === 'function'\n\t\t? args.length\n\t\t\t? getValue(value(...args))\n\t\t\t: getValue(value())\n\t\t: value\n\n/**\n * Identity function, given `x` returns `x`\n *\n * @template T\n * @param {T} x\n * @returns {T}\n */\nexport const identity = x => x\n\n/**\n * When `value` is an object, it will check if the `key` on `target`\n * is `configurable`\n *\n * @param {object} target\n * @param {PropertyKey} key\n * @param {boolean | undefined} value\n */\nexport const isConfigurable = (target, key, value) => {\n\tif (isObject(value)) {\n\t\tconst descriptor = getOwnPropertyDescriptor(target, key)\n\t\tif (descriptor) {\n\t\t\treturn descriptor.configurable\n\t\t}\n\t}\n\treturn true\n}\n\n/**\n * Returns `true` when `typeof` of `value` is `function`\n *\n * @param {unknown} value\n * @returns {value is function}\n */\nexport const isFunction = value => typeof value === 'function'\n\nexport const isNaN = Number.isNaN\n\n/**\n * Returns `true` when value is Iterable\n *\n * @param {unknown} value\n * @returns {value is Iterable<unknown>}\n */\nexport const isIterable = value => value?.[iterator]\n\n/**\n * Returns `true` if the value is `null` or `undefined`\n *\n * @param {unknown} value\n * @returns {value is null | undefined}\n */\nexport const isNullUndefined = value =>\n\tvalue === undefined || value === null\n\n/**\n * Returns `true` when typeof of value is object and not null\n *\n * @template T\n * @param {T} value\n * @returns {value is object}\n */\nexport const isObject = value =>\n\tvalue !== null && typeof value === 'object'\n\n/**\n * Returns `true` when `typeof` of `value` is `string`\n *\n * @param {unknown} value\n * @returns {value is string}\n */\nexport const isString = value => typeof value === 'string'\n\n/**\n * Returns `true` when `typeof` of `value` is `number`\n *\n * @param {unknown} value\n * @returns {value is number}\n */\nexport const isNumber = value => typeof value === 'number'\n\n/**\n * Returns `true` when `typeof` of `value` is `symbol`\n *\n * @param {unknown} value\n * @returns {value is symbol}\n */\nexport const isSymbol = value => typeof value === 'symbol'\n\n/**\n * Returns `true` when `typeof` of `value` is `boolean`\n *\n * @param {unknown} value\n * @returns {value is boolean}\n */\nexport const isBoolean = value => typeof value === 'boolean'\n\n/**\n * Returns `true` when `value` may be a promise\n *\n * @param {unknown} value\n * @returns {value is Promise<unknown>}\n */\nexport const isPromise = value =>\n\tisFunction(/** @type {any} */ (value)?.then)\n\n/**\n * @template T\n * @param {T} value\n * @returns {value is array}\n */\nexport const isArray = Array.isArray\n\n/**\n * Returns `true` when object morphed between array/object\n *\n * @param {unknown} a\n * @param {unknown} b\n * @returns {boolean}\n */\nexport const morphedBetweenArrayAndObject = (a, b) =>\n\t(isObject(a) && !isObject(b)) ||\n\t(isObject(b) && !isObject(a)) ||\n\t(isArray(a) && !isArray(b)) ||\n\t(isArray(b) && !isArray(a))\n\n/**\n * Returns `true` if the property is defined in the `prototype` and\n * absent in the `object`\n *\n * @param {object} target\n * @param {PropertyKey} key\n */\nexport const isPrototypeProperty = (target, key) =>\n\t// must do `key in target` to check that it DOES have it somewhere\n\t// must do !hasOwnProperty to check that isnt an own property\n\tkey in target && !hasOwnProperty(target, key)\n\nexport const noop = () => {}\n\n// an optional value is `true` by default, so most of the time is undefined which means is `true`\n// to avoid having conditions like `if(something.bla === undefined || something.bla)`\n// this function will short it to `if(optional(something.bla))`\n// additionally the value is resolved, for cases like `when={() => show() && optional(props.when)}`\n\n/**\n * Returns `true` when value is `true` or `undefined`\n *\n * @template T\n * @param {T} value\n * @returns {true | T} True when value is true or undefined\n */\nexport const optional = value =>\n\tvalue === undefined || getValue(value)\n\nexport function* range(start, stop, step) {\n\tif (step < 0) step = Math.abs(step)\n\tyield start\n\tif (start < stop) {\n\t\twhile (start < stop) {\n\t\t\tyield (start += step)\n\t\t}\n\t} else {\n\t\twhile (start > stop) {\n\t\t\tyield (start -= step)\n\t\t}\n\t}\n}\n\nexport const {\n\townKeys: reflectOwnKeys,\n\thas: reflectHas,\n\tdeleteProperty: reflectDeleteProperty,\n\tgetOwnPropertyDescriptor: reflectGetOwnPropertyDescriptor,\n\tget: reflectGet,\n\tapply: reflectApply,\n\tset: reflectSet,\n} = Reflect\n\n/**\n * Removes a value from an array\n *\n * @template T\n * @param {T[]} array\n * @param {T} value To remove from the array\n */\nexport function removeFromArray(array, value) {\n\tconst index = array.indexOf(value)\n\tif (index !== -1) array.splice(index, 1)\n}\n/**\n * Removes values from an array based on a condition\n *\n * @template T\n * @param {T[]} array\n * @param {(index: number, value: T) => boolean} cb Function with\n *   condition\n */\nexport function removeFromArrayConditionally(array, cb) {\n\tlet i = array.length\n\twhile (i--) {\n\t\tif (cb(i, array[i])) {\n\t\t\tarray.splice(i, 1)\n\t\t}\n\t}\n}\n/**\n * Removes values from an array based on a condition\n *\n * @template T\n * @param {Iterable<T>} iterable\n * @param {PropertyKey} key Function with condition\n */\nexport function indexByKey(iterable, key) {\n\tconst byKey = empty()\n\tfor (const item of iterable) {\n\t\tbyKey[item[key]] = item\n\t}\n\treturn byKey\n}\n\n/**\n * Replace a prototype in the prototype chain with another prototype\n *\n * @param {object} target - Target object\n * @param {object} search - The prototype to replace\n * @param {object} replacement - The replacement prototype\n */\nexport function replacePrototypeWith(target, search, replacement) {\n\tlet prototype = target\n\twhile (getPrototypeOf(prototype) !== search) {\n\t\tprototype = getPrototypeOf(prototype)\n\t}\n\n\tsetPrototypeOf(prototype, replacement)\n}\n\nexport const typeString = obj =>\n\tObject.prototype.toString.call(obj).slice(8, -1)\n\nexport function walkParents(context, propertyName, cb) {\n\twhile (context) {\n\t\tif (cb(context)) return true\n\t\tcontext = context[propertyName]\n\t}\n\treturn false\n}\n\n/** @template T */\nclass DataStore {\n\t/** @param {T extends FunctionConstructor} kind */\n\tconstructor(kind) {\n\t\tconst store = new kind()\n\n\t\tconst get = store.get.bind(store)\n\t\tconst set = store.set.bind(store)\n\t\tconst has = store.has.bind(store)\n\t\tconst del = store.delete.bind(store)\n\n\t\tthis.set = set\n\t\tthis.has = has\n\t\tthis.delete = del\n\n\t\tthis.get = (target, defaults = null) => {\n\t\t\tconst o = get(target)\n\n\t\t\tif (defaults !== null && o === undefined) {\n\t\t\t\t/**\n\t\t\t\t * Default values should be passed as a function, so we dont\n\t\t\t\t * constantly initialize values when giving them\n\t\t\t\t */\n\t\t\t\tdefaults = defaults(target)\n\t\t\t\tset(target, defaults)\n\t\t\t\treturn defaults\n\t\t\t}\n\t\t\treturn o\n\t\t}\n\t}\n\n\t*[Symbol.iterator]() {\n\t\tyield this.get\n\t\tyield this.set\n\t\tyield this.has\n\t\tyield this.delete\n\t}\n}\n\n/**\n * Store template\n *\n * @typedef {(\n * \treference: any,\n * \tcreateIfNotExistsAs?: ((target: any) => any) | Function,\n * ) => any} DataStoreGet\n *\n *\n * @typedef {(key: any, value: any) => void} DataStoreSet\n *\n * @typedef {(key: any) => boolean} DataStoreHas\n *\n * @typedef {(key: any) => boolean} DataStoreDelete\n *\n * @typedef {[\n * \tDataStoreGet,\n * \tDataStoreSet,\n * \tDataStoreHas,\n * \tDataStoreDelete,\n * ] & {\n * \tget: DataStoreGet\n * \tset: DataStoreSet\n * \thas: DataStoreHas\n * \tdelete: DataStoreDelete\n * }} DataStoreT\n */\n\n/**\n * Creates a WeakMap to store data\n *\n * @returns {DataStoreT}\n */\nexport const weakStore = () => new DataStore(WeakMap)\n\n/**\n * Creates a Map to store data\n *\n * @returns {DataStoreT}\n */\nexport const cacheStore = () => new DataStore(Map)\n\nexport const warn = (...args) => console.warn(...args)\nexport const error = (...args) => console.error(...args)\n","// symbols\n\nimport { Symbol } from './lib/std.js'\n\nexport const $isComponent = Symbol()\nexport const $isClass = Symbol()\nexport const $isMap = Symbol()\n\n// supported namespaces\n\nconst prefix = 'http://www.w3.org/'\n\n// when a tag/attribute is missing the namespace this puts it back in\n\nexport const NS = {\n\t__proto__: null,\n\tsvg: prefix + '2000/svg',\n\tmath: prefix + '1998/Math/MathML',\n\thtml: prefix + '1999/xhtml',\n\txlink: prefix + '1999/xlink',\n}\n","import {\n\tassign,\n\tisArray,\n\tnoop,\n\tremoveFromArray,\n\tSymbol,\n\twalkParents,\n} from './std.js'\n\n/**\n * This is so far the core of Solid JS 1.x Reactivity, but ported to\n * classes and adapted to my taste.\n *\n * Adaptation for potas needs include:\n *\n * - Ported to Classes what does fit\n * - Signal has more options: `label` and `save` previous value\n * - Writing to a signal returns `bollean` to tell if the value changed\n * - Signal is an object that could be used as signal.read/write or\n *   destructured as an array\n * - Signals can save and won't run functions\n * - `update` function on Signal that could be used to use the old value\n *   to set a new value\n * - The system is wrapped in a `createReactiveSystem` function so many\n *   systems can be run at the same time, for example for the\n *   developer tools context, so dev-tools context doesnt mess up the\n *   real context\n *\n * WARNING: typings here are a mess, Im slowly working on it.\n *\n * @url https://www.solidjs.com/\n * @url https://github.com/solidjs/solid\n * @url https://github.com/solidjs/signals\n */\n\nexport function createReactiveSystem() {\n\tconst CLEAN = 0\n\tconst STALE = 1\n\tconst CHECK = 2\n\n\t/** @type {Computation} */\n\tlet Owner\n\n\t/** @type {Computation | undefined} */\n\tlet Listener\n\n\t/** @type {Memo[]} */\n\tlet Updates = null\n\n\t/** @type {undefined | null | any[]} */\n\tlet Effects = null\n\n\tlet Time = 0\n\n\t// ROOT\n\n\tclass Root {\n\t\t/** @type {Root | undefined} */\n\t\towner\n\n\t\t/** @type {Computation | Computation[]} */\n\t\towned\n\n\t\t/** @type {Function | Function[]} */\n\t\tcleanups\n\n\t\t/** @type {Record<symbol, unknown>} */\n\t\tcontext\n\n\t\t/**\n\t\t * @param {Root} owner\n\t\t * @param {object} [options]\n\t\t */\n\t\tconstructor(owner, options) {\n\t\t\tif (owner) {\n\t\t\t\tthis.owner = owner\n\n\t\t\t\tif (owner.context) {\n\t\t\t\t\tthis.context = owner.context\n\t\t\t\t}\n\t\t\t}\n\n\t\t\toptions && assign(this, options)\n\t\t}\n\t\t/** @param {Function} fn */\n\t\taddCleanups(fn) {\n\t\t\tif (!this.cleanups) {\n\t\t\t\tthis.cleanups = fn\n\t\t\t} else if (isArray(this.cleanups)) {\n\t\t\t\tthis.cleanups.push(fn)\n\t\t\t} else {\n\t\t\t\tthis.cleanups = [this.cleanups, fn]\n\t\t\t}\n\t\t}\n\t\t/** @param {Function} fn */\n\t\tremoveCleanups(fn) {\n\t\t\tif (!this.cleanups) {\n\t\t\t} else if (this.cleanups === fn) {\n\t\t\t\tthis.cleanups = null\n\t\t\t} else {\n\t\t\t\tremoveFromArray(this.cleanups, fn)\n\t\t\t}\n\t\t}\n\t\t/** @param {Computation} value */\n\t\taddOwned(value) {\n\t\t\tif (!this.owned) {\n\t\t\t\tthis.owned = value\n\t\t\t} else if (isArray(this.owned)) {\n\t\t\t\tthis.owned.push(value)\n\t\t\t} else {\n\t\t\t\tthis.owned = [this.owned, value]\n\t\t\t}\n\t\t}\n\n\t\tdispose() {\n\t\t\tthis.disposeOwned()\n\t\t\tthis.doCleanups()\n\t\t}\n\n\t\tdisposeOwned() {\n\t\t\tif (!this.owned) {\n\t\t\t} else if (isArray(this.owned)) {\n\t\t\t\tfor (let i = this.owned.length - 1; i >= 0; i--) {\n\t\t\t\t\tthis.owned[i].dispose()\n\t\t\t\t}\n\t\t\t\tthis.owned = null\n\t\t\t} else {\n\t\t\t\tthis.owned.dispose()\n\t\t\t\tthis.owned = null\n\t\t\t}\n\t\t}\n\n\t\tdoCleanups() {\n\t\t\tif (!this.cleanups) {\n\t\t\t} else if (isArray(this.cleanups)) {\n\t\t\t\tfor (let i = this.cleanups.length - 1; i >= 0; i--) {\n\t\t\t\t\tthis.cleanups[i]()\n\t\t\t\t}\n\t\t\t\tthis.cleanups = null\n\t\t\t} else {\n\t\t\t\tthis.cleanups()\n\t\t\t\tthis.cleanups = null\n\t\t\t}\n\t\t}\n\t}\n\n\t// COMPUTATION\n\n\tclass Computation extends Root {\n\t\tstate = STALE\n\n\t\tupdatedAt = 0\n\n\t\t/** @type {Function | undefined} */\n\t\tfn\n\n\t\tsources\n\t\tsourceSlots\n\n\t\t/**\n\t\t * @param {Root} [owner]\n\t\t * @param {Function} [fn]\n\t\t * @param {object} [options]\n\t\t */\n\t\tconstructor(owner, fn, options) {\n\t\t\tsuper(owner, options)\n\n\t\t\tthis.fn = fn\n\n\t\t\towner && owner.addOwned(this)\n\t\t}\n\n\t\tupdate() {\n\t\t\tthis.dispose()\n\n\t\t\tconst time = Time\n\n\t\t\tconst prevOwner = Owner\n\t\t\tconst prevListener = Listener\n\n\t\t\tListener = Owner = this\n\t\t\ttry {\n\t\t\t\tthis.fn()\n\t\t\t} catch (err) {\n\t\t\t\tthis.updatedAt = time + 1\n\n\t\t\t\tthrow err\n\t\t\t} finally {\n\t\t\t\tOwner = prevOwner\n\t\t\t\tListener = prevListener\n\t\t\t}\n\n\t\t\tif (this.updatedAt < time) {\n\t\t\t\tthis.updatedAt = time\n\t\t\t}\n\t\t}\n\n\t\tdispose() {\n\t\t\tconst { sources, sourceSlots } = this\n\n\t\t\tif (sources && sources.length) {\n\t\t\t\tlet source\n\t\t\t\tlet observers\n\t\t\t\tlet index\n\n\t\t\t\tlet observer\n\t\t\t\tlet slot\n\t\t\t\twhile (sources.length) {\n\t\t\t\t\tsource = sources.pop()\n\t\t\t\t\tobservers = source.observers\n\n\t\t\t\t\tindex = sourceSlots.pop()\n\n\t\t\t\t\tif (observers && observers.length) {\n\t\t\t\t\t\tobserver = observers.pop()\n\t\t\t\t\t\tslot = source.observerSlots.pop()\n\n\t\t\t\t\t\tif (index < observers.length) {\n\t\t\t\t\t\t\tobserver.sourceSlots[slot] = index\n\t\t\t\t\t\t\tobservers[index] = observer\n\t\t\t\t\t\t\tsource.observerSlots[index] = slot\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tsuper.dispose()\n\n\t\t\tthis.state = CLEAN\n\t\t}\n\t\tqueue() {\n\t\t\tEffects.push(this)\n\t\t}\n\t}\n\n\tclass Effect extends Computation {\n\t\tuser = true\n\n\t\t/**\n\t\t * @param {Root} [owner]\n\t\t * @param {Function} [fn]\n\t\t * @param {object} [options]\n\t\t */\n\t\tconstructor(owner, fn, options) {\n\t\t\tsuper(owner, fn, options)\n\n\t\t\tEffects ? Effects.push(this) : batch(() => this.update())\n\t\t}\n\t}\n\n\tclass SyncEffect extends Computation {\n\t\t/**\n\t\t * @param {Root} [owner]\n\t\t * @param {Function} [fn]\n\t\t * @param {object} [options]\n\t\t */\n\t\tconstructor(owner, fn, options) {\n\t\t\tsuper(owner, fn, options)\n\n\t\t\tbatch(() => this.update())\n\t\t}\n\t}\n\n\t// SIGNALS\n\n\tclass Memo extends Computation {\n\t\tvalue\n\n\t\tobservers\n\t\tobserverSlots\n\n\t\t// options:\n\t\t// equals\n\t\t/**\n\t\t * @param {Root} [owner]\n\t\t * @param {Function} [fn]\n\t\t * @param {object} [options]\n\t\t */\n\t\tconstructor(owner, fn, options) {\n\t\t\tsuper(owner, fn, options)\n\n\t\t\treturn this.read\n\t\t}\n\n\t\tread = () => {\n\t\t\tif (this.state) {\n\t\t\t\tif (this.state === STALE) {\n\t\t\t\t\tthis.update()\n\t\t\t\t} else {\n\t\t\t\t\tconst updates = Updates\n\t\t\t\t\tUpdates = null\n\t\t\t\t\trunUpdates(() => upstream(this))\n\t\t\t\t\tUpdates = updates\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (Listener) {\n\t\t\t\tconst sourceSlot = this.observers ? this.observers.length : 0\n\n\t\t\t\tif (Listener.sources) {\n\t\t\t\t\tListener.sources.push(this)\n\t\t\t\t\tListener.sourceSlots.push(sourceSlot)\n\t\t\t\t} else {\n\t\t\t\t\tListener.sources = [this]\n\t\t\t\t\tListener.sourceSlots = [sourceSlot]\n\t\t\t\t}\n\n\t\t\t\tconst observerSlot = Listener.sources.length - 1\n\n\t\t\t\tif (sourceSlot) {\n\t\t\t\t\tthis.observers.push(Listener)\n\t\t\t\t\tthis.observerSlots.push(observerSlot)\n\t\t\t\t} else {\n\t\t\t\t\tthis.observers = [Listener]\n\t\t\t\t\tthis.observerSlots = [observerSlot]\n\t\t\t\t}\n\t\t\t}\n\n\t\t\treturn this.value\n\t\t}\n\n\t\twrite(value) {\n\t\t\tif (this.equals === false || !this.equals(this.value, value)) {\n\t\t\t\tthis.value = value\n\n\t\t\t\tif (this.observers && this.observers.length) {\n\t\t\t\t\trunUpdates(() => {\n\t\t\t\t\t\tfor (const observer of this.observers) {\n\t\t\t\t\t\t\tif (observer.state === CLEAN) {\n\t\t\t\t\t\t\t\tobserver.queue()\n\t\t\t\t\t\t\t\tobserver.observers && downstream(observer)\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tobserver.state = STALE\n\t\t\t\t\t\t}\n\t\t\t\t\t})\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\t/**\n\t\t * @param {unknown} a\n\t\t * @param {unknown} b\n\t\t */\n\t\tequals(a, b) {\n\t\t\treturn a === b\n\t\t}\n\n\t\tupdate() {\n\t\t\tthis.dispose()\n\n\t\t\tlet nextValue\n\n\t\t\tconst time = Time\n\n\t\t\tconst prevOwner = Owner\n\t\t\tconst prevListener = Listener\n\n\t\t\tListener = Owner = this\n\t\t\ttry {\n\t\t\t\tnextValue = this.fn()\n\t\t\t} catch (err) {\n\t\t\t\tthis.state = STALE\n\t\t\t\tthis.disposeOwned()\n\n\t\t\t\tthis.updatedAt = time + 1\n\n\t\t\t\tthrow err\n\t\t\t} finally {\n\t\t\t\tOwner = prevOwner\n\t\t\t\tListener = prevListener\n\t\t\t}\n\t\t\tif (this.updatedAt <= time) {\n\t\t\t\tthis.write(nextValue)\n\t\t\t\tthis.updatedAt = time\n\t\t\t}\n\t\t}\n\t\tqueue() {\n\t\t\tUpdates.push(this)\n\t\t}\n\t}\n\n\t// SIGNAL\n\n\t/**\n\t * @template in T\n\t * @type SignalObject<T>\n\t */\n\tclass Signal {\n\t\tvalue\n\n\t\t/** @private */\n\t\tobservers\n\t\t/** @private */\n\t\tobserverSlots\n\n\t\t// options:\n\t\t// equals\n\t\t// save\n\n\t\t// `prev` if option save was given\n\t\t/**\n\t\t * @param {T} [value]\n\t\t * @param {SignalOptions} [options]\n\t\t */\n\t\tconstructor(value, options) {\n\t\t\tthis.value = value\n\t\t\tif (options) {\n\t\t\t\tassign(this, options)\n\t\t\t\tif (this.save) {\n\t\t\t\t\t/** @private */\n\t\t\t\t\tthis.prev = value\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\t/** @returns SignalAccessor<T> */\n\t\tread = () => {\n\t\t\t// checkReadForbidden()\n\n\t\t\tif (Listener) {\n\t\t\t\tconst sourceSlot = this.observers ? this.observers.length : 0\n\n\t\t\t\tif (Listener.sources) {\n\t\t\t\t\tListener.sources.push(this)\n\t\t\t\t\tListener.sourceSlots.push(sourceSlot)\n\t\t\t\t} else {\n\t\t\t\t\tListener.sources = [this]\n\t\t\t\t\tListener.sourceSlots = [sourceSlot]\n\t\t\t\t}\n\n\t\t\t\tconst observerSlot = Listener.sources.length - 1\n\n\t\t\t\tif (sourceSlot) {\n\t\t\t\t\tthis.observers.push(Listener)\n\t\t\t\t\tthis.observerSlots.push(observerSlot)\n\t\t\t\t} else {\n\t\t\t\t\tthis.observers = [Listener]\n\t\t\t\t\tthis.observerSlots = [observerSlot]\n\t\t\t\t}\n\t\t\t}\n\n\t\t\treturn this.value\n\t\t}\n\t\t/**\n\t\t * @param {T} [value]\n\t\t * @returns SignalSetter<T>\n\t\t */\n\t\twrite = value => {\n\t\t\tif (this.equals === false || !this.equals(this.value, value)) {\n\t\t\t\tif (this.save) {\n\t\t\t\t\tthis.prev = this.value\n\t\t\t\t}\n\t\t\t\tthis.value = value\n\n\t\t\t\tif (this.observers && this.observers.length) {\n\t\t\t\t\trunUpdates(() => {\n\t\t\t\t\t\tfor (const observer of this.observers) {\n\t\t\t\t\t\t\tif (observer.state === CLEAN) {\n\t\t\t\t\t\t\t\tobserver.queue()\n\t\t\t\t\t\t\t\tobserver.observers && downstream(observer)\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tobserver.state = STALE\n\t\t\t\t\t\t}\n\t\t\t\t\t})\n\t\t\t\t}\n\t\t\t\treturn true\n\t\t\t}\n\t\t\treturn false\n\t\t}\n\t\t/**\n\t\t * @type SignalUpdate<T>\n\t\t * @returns SignalUpdate<T>\n\t\t */\n\t\tupdate = value => {\n\t\t\treturn this.write(value(this.value))\n\t\t}\n\n\t\t/**\n\t\t * @private\n\t\t * @type {((a, B) => boolean) | false}\n\t\t */\n\t\tequals(a, b) {\n\t\t\treturn a === b\n\t\t}\n\n\t\t*[Symbol.iterator]() {\n\t\t\t/** @type SignalAccessor<T> */\n\t\t\tyield this.read\n\t\t\t/** @type SignalSetter<T> */\n\t\t\tyield this.write\n\t\t\t/** @type SignalUpdate<T> */\n\t\t\tyield this.update\n\t\t}\n\t}\n\n\t// API\n\n\t/**\n\t * Creates a new root\n\t *\n\t * @param {(dispose: () => void) => any} fn\n\t * @param {object} [options]\n\t * @returns {any}\n\t */\n\tfunction root(fn, options) {\n\t\tconst root = new Root(Owner, options)\n\t\treturn runWithOwner(root, () => fn(() => root.dispose()))\n\t}\n\n\t/**\n\t * Creates a signal\n\t *\n\t * @template T\n\t * @param {T} [initialValue] - Initial value of the signal\n\t * @param {SignalOptions} [options] - Signal options\n\t */\n\t/* #__NO_SIDE_EFFECTS__ */\n\tfunction signal(initialValue, options) {\n\t\t/** @type {SignalObject<T>} */\n\t\tconst s = new Signal(initialValue, options)\n\t\treturn s\n\t}\n\n\t/**\n\t * Creates an effect\n\t *\n\t * @param {Function} fn\n\t * @param {object} [options]\n\t */\n\tfunction effect(fn, options) {\n\t\tnew Effect(Owner, fn, options)\n\t}\n\n\t/**\n\t * Creates an effect with explicit dependencies\n\t *\n\t * @param {Function} depend - Function that causes tracking\n\t * @param {Function} fn - Function that wont cause tracking\n\t * @param {object} [options]\n\t */\n\tfunction on(depend, fn, options) {\n\t\teffect(() => {\n\t\t\tdepend()\n\t\t\tuntrack(fn)\n\t\t}, options)\n\t}\n\n\t/**\n\t * Creates a syncEffect\n\t *\n\t * @param {Function} fn\n\t * @param {object} [options]\n\t */\n\tfunction syncEffect(fn, options) {\n\t\treturn new SyncEffect(Owner, fn, options)\n\t}\n\n\t/**\n\t * Creates a read-only signal from the return value of a function\n\t * that automatically updates\n\t *\n\t * @template T\n\t * @param {() => T} fn - Function to re-run when dependencies change\n\t * @param {SignalOptions} [options]\n\t */\n\n\t/* #__NO_SIDE_EFFECTS__ */ function memo(fn, options = undefined) {\n\t\t/** @type {SignalAccessor<T>} */\n\t\tconst s = new Memo(Owner, fn, options)\n\t\treturn s\n\t}\n\n\t/**\n\t * Batches changes to signals\n\t *\n\t * @param {Function} fn\n\t */\n\tconst batch = runUpdates\n\n\t/**\n\t * Returns current owner\n\t *\n\t * @returns {Computation}\n\t */\n\tfunction owner() {\n\t\treturn Owner\n\t}\n\n\tfunction runWithOwner(owner, fn) {\n\t\tconst prevOwner = Owner\n\t\tconst prevListener = Listener\n\n\t\tOwner = owner\n\t\tListener = undefined\n\n\t\ttry {\n\t\t\treturn runUpdates(fn, true)\n\t\t} catch (err) {\n\t\t\tthrow err\n\t\t} finally {\n\t\t\tOwner = prevOwner\n\t\t\tListener = prevListener\n\t\t}\n\t}\n\n\t/**\n\t * Disables tracking for a function\n\t *\n\t * @template T\n\t * @param {() => T} fn - Function to run with tracking disabled\n\t * @returns {T}\n\t */\n\tfunction untrack(fn) {\n\t\tif (Listener === undefined) {\n\t\t\treturn fn()\n\t\t}\n\n\t\tconst prevListener = Listener\n\t\tListener = undefined\n\t\ttry {\n\t\t\treturn fn()\n\t\t} finally {\n\t\t\tListener = prevListener\n\t\t}\n\t}\n\n\t/**\n\t * Runs a callback on cleanup, returns callback\n\t *\n\t * @template {Function} T\n\t * @param {T} fn\n\t * @returns {T}\n\t */\n\tfunction cleanup(fn) {\n\t\tOwner?.addCleanups(fn)\n\t\treturn fn\n\t}\n\n\t/**\n\t * Cancels a cleanup\n\t *\n\t * @template {Function} T\n\t * @param {T} fn\n\t * @returns {T}\n\t */\n\tfunction cleanupCancel(fn) {\n\t\tOwner?.removeCleanups(fn)\n\t\treturn fn\n\t}\n\n\t// UPDATES\n\n\tfunction runTop(node) {\n\t\tswitch (node.state) {\n\t\t\tcase CLEAN: {\n\t\t\t\tbreak\n\t\t\t}\n\t\t\tcase CHECK: {\n\t\t\t\tupstream(node)\n\t\t\t\tbreak\n\t\t\t}\n\n\t\t\tdefault: {\n\t\t\t\tconst ancestors = []\n\n\t\t\t\tdo {\n\t\t\t\t\tnode.state && ancestors.push(node)\n\n\t\t\t\t\tnode = node.owner\n\t\t\t\t} while (node && node.updatedAt < Time)\n\n\t\t\t\tfor (let i = ancestors.length - 1, updates; i >= 0; i--) {\n\t\t\t\t\tnode = ancestors[i]\n\n\t\t\t\t\tswitch (node.state) {\n\t\t\t\t\t\tcase STALE: {\n\t\t\t\t\t\t\tnode.update()\n\t\t\t\t\t\t\tbreak\n\t\t\t\t\t\t}\n\t\t\t\t\t\tcase CHECK: {\n\t\t\t\t\t\t\tupdates = Updates\n\t\t\t\t\t\t\tUpdates = null\n\t\t\t\t\t\t\trunUpdates(() => upstream(node, ancestors[0]))\n\t\t\t\t\t\t\tUpdates = updates\n\t\t\t\t\t\t\tbreak\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\t/**\n\t * @template T\n\t * @param {() => T} fn\n\t * @param {boolean} init\n\t * @returns {T}\n\t */\n\tfunction runUpdates(fn, init = false) {\n\t\tif (Updates) {\n\t\t\treturn fn()\n\t\t}\n\n\t\tlet wait = false\n\n\t\tif (!init) {\n\t\t\tUpdates = []\n\t\t}\n\n\t\tif (Effects) {\n\t\t\twait = true\n\t\t} else {\n\t\t\tEffects = []\n\t\t}\n\n\t\tTime++\n\n\t\ttry {\n\t\t\tconst res = fn()\n\n\t\t\tif (Updates) {\n\t\t\t\tfor (const update of Updates) {\n\t\t\t\t\trunTop(update)\n\t\t\t\t}\n\t\t\t}\n\t\t\tUpdates = null\n\n\t\t\tif (!wait) {\n\t\t\t\tconst effects = Effects\n\t\t\t\tEffects = null\n\t\t\t\teffects.length && runUpdates(() => runEffects(effects))\n\t\t\t}\n\n\t\t\treturn res\n\t\t} catch (err) {\n\t\t\tif (!wait) {\n\t\t\t\tEffects = null\n\t\t\t}\n\t\t\tUpdates = null\n\n\t\t\tthrow err\n\t\t}\n\t}\n\n\tfunction runEffects(queue) {\n\t\tlet userLength = 0\n\t\tfor (const effect of queue) {\n\t\t\tif (effect.user) {\n\t\t\t\tqueue[userLength++] = effect\n\t\t\t} else {\n\t\t\t\trunTop(effect)\n\t\t\t}\n\t\t}\n\n\t\tfor (let i = 0; i < userLength; i++) {\n\t\t\trunTop(queue[i])\n\t\t}\n\t}\n\n\tfunction upstream(node, ignore) {\n\t\tnode.state = CLEAN\n\n\t\tfor (const source of node.sources) {\n\t\t\tif (source.sources) {\n\t\t\t\tswitch (source.state) {\n\t\t\t\t\tcase STALE: {\n\t\t\t\t\t\tif (source !== ignore && source.updatedAt < Time) {\n\t\t\t\t\t\t\trunTop(source)\n\t\t\t\t\t\t}\n\t\t\t\t\t\tbreak\n\t\t\t\t\t}\n\t\t\t\t\tcase CHECK: {\n\t\t\t\t\t\tupstream(source, ignore)\n\t\t\t\t\t\tbreak\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tfunction downstream(node) {\n\t\tfor (const observer of node.observers) {\n\t\t\tif (observer.state === CLEAN) {\n\t\t\t\tobserver.state = CHECK\n\t\t\t\tobserver.queue()\n\t\t\t\tobserver.observers && downstream(observer)\n\t\t\t}\n\t\t}\n\t}\n\n\t/**\n\t * Creates a context and returns a function to get or set the value\n\t *\n\t * @template T\n\t * @param {T} [defaultValue] - Default value for the context\n\t */\n\tfunction Context(defaultValue = undefined) {\n\t\tconst id = Symbol()\n\n\t\t/**\n\t\t * @overload Runs `fn` with a new value as context\n\t\t * @param {T} newValue - New value for the context\n\t\t * @param {() => Children} fn - Callback to run with the new\n\t\t *   context value\n\t\t * @returns {Children} Context value\n\t\t */\n\t\t/**\n\t\t * @overload Gets the context value\n\t\t * @returns {T} Context value\n\t\t */\n\n\t\tfunction useContext(newValue, fn) {\n\t\t\tif (newValue === undefined) {\n\t\t\t\treturn Owner?.context && Owner.context[id] !== undefined\n\t\t\t\t\t? Owner.context[id]\n\t\t\t\t\t: defaultValue\n\t\t\t} else {\n\t\t\t\tlet res\n\n\t\t\t\tsyncEffect(() => {\n\t\t\t\t\tOwner.context = {\n\t\t\t\t\t\t...Owner.context,\n\t\t\t\t\t\t[id]: newValue,\n\t\t\t\t\t}\n\t\t\t\t\tres = untrack(fn)\n\t\t\t\t})\n\n\t\t\t\treturn res\n\t\t\t}\n\t\t}\n\n\t\t/**\n\t\t * Sets the `value` for the context\n\t\t *\n\t\t * @param {object} props\n\t\t * @param {T} props.value\n\t\t * @param {Children} props.children\n\t\t * @returns {Children} Children\n\t\t * @url https://pota.quack.uy/Reactivity/Context\n\t\t */\n\t\tuseContext.Provider = props =>\n\t\t\tuseContext(props.value, () => useContext.toHTML(props.children))\n\n\t\t/**\n\t\t * Maps context following `parent` property (if any). When `true`\n\t\t * is returned from the callback it stops walking.\n\t\t *\n\t\t * @param {(context: T) => boolean | void} callback\n\t\t * @param {T} [context]\n\t\t */\n\t\tuseContext.walk = (callback, context) =>\n\t\t\twalkParents(context || useContext(), 'parent', callback)\n\n\t\treturn useContext\n\t}\n\n\t/**\n\t * Returns an owned function\n\t *\n\t * @template T\n\t * @template A\n\t * @param {(...args: A[]) => T} cb\n\t * @returns {() => T | void}\n\t */\n\tconst owned = cb => {\n\t\tconst o = Owner\n\t\treturn cb ? (...args) => runWithOwner(o, () => cb(...args)) : noop\n\t}\n\n\t// export\n\n\treturn {\n\t\tbatch,\n\t\tcleanup,\n\t\tcleanupCancel,\n\t\tContext,\n\t\teffect,\n\t\tmemo,\n\t\ton,\n\t\towned,\n\t\towner,\n\t\troot,\n\t\trunWithOwner,\n\t\tsignal,\n\t\tsyncEffect,\n\t\tuntrack,\n\t}\n}\n","import { $isClass, $isComponent, $isMap } from '../constants.js'\n\nimport {\n\temptyArray,\n\tgetValue,\n\tgroupBy,\n\tisArray,\n\tisFunction,\n\tisObject,\n\tisPromise,\n\tkeys,\n\tnothing,\n\tqueueMicrotask,\n\tremoveFromArray,\n\tresolved,\n\twithResolvers,\n\ttoEntries,\n\tflatToArray,\n} from './std.js'\n\n// solid\n\nimport { createReactiveSystem } from './solid.js'\n\nconst {\n\tbatch,\n\tcleanup,\n\tcleanupCancel,\n\tContext,\n\teffect,\n\tmemo,\n\ton,\n\towned,\n\towner,\n\troot,\n\trunWithOwner,\n\tsignal,\n\tsyncEffect,\n\tuntrack,\n} = createReactiveSystem()\n\nexport {\n\tbatch,\n\tcleanup,\n\tcleanupCancel,\n\tContext,\n\teffect,\n\tmemo,\n\ton,\n\towned,\n\towner,\n\troot,\n\trunWithOwner,\n\tsignal,\n\tsyncEffect,\n\tuntrack,\n\tcreateReactiveSystem,\n}\n\n/**\n * Proxies a signals property access so you dont have to call the\n * function\n *\n * @template {{}} T\n * @param {SignalAccessor<T>} snigal - Signal to proxy\n * @param {object} [target] - Target object for the proxy\n * @returns {object} An object that will read the properties from the\n *   signal\n */\nexport const proxy = (snigal, target = nothing) =>\n\tnew Proxy(target, {\n\t\tget(target, key) {\n\t\t\treturn snigal()[key]\n\t\t},\n\t\thas(target, key) {\n\t\t\treturn key in snigal()\n\t\t},\n\t\townKeys(target) {\n\t\t\treturn keys(snigal())\n\t\t},\n\t})\n\n/**\n * A self contained signal function, when an argument is present it\n * writes to the signal, when theres no argument it reads the signal.\n *\n * @template T\n * @param {T} [value] - Optional initial value\n * @returns {SignalFunction<T>}\n */\nexport function signalFunction(value) {\n\tconst [read, write] = signal(value)\n\t// @ts-ignore\n\treturn (...args) => (args.length ? write(args[0]) : read())\n}\n\n/**\n * To set and read refs. To use in ref attribute.\n *\n * @returns {SignalFunction<Element>}\n */\nexport const ref = () => signalFunction()\n\n/**\n * Runs a function inside an effect if value is a function.\n * Aditionally unwraps promises.\n *\n * @template T\n * @param {Accessor<T> | Promise<T>} value\n * @param {(value: Accessed<T> | T) => void} fn\n */\nexport function withValue(value, fn) {\n\tif (isFunction(value)) {\n\t\teffect(() => withValue(getValue(value), fn))\n\t} else if (isPromise(value)) {\n\t\tvalue.then(owned(value => withValue(value, fn)))\n\t} else {\n\t\tfn(value)\n\t}\n}\n\n/**\n * Runs a function inside an effect if value is a function\n *\n * @param {unknown} value\n * @param {(value: unknown, prev?: unknown) => unknown} fn\n */\nexport function withPrevValue(value, fn) {\n\tif (isFunction(value)) {\n\t\tlet prev\n\t\teffect(() => {\n\t\t\tconst val = getValue(value)\n\t\t\tfn(val, prev)\n\t\t\tprev = val\n\t\t})\n\t} else {\n\t\tfn(value)\n\t}\n}\n\n/**\n * Lazy and writable version of `memo`, its writable and will run the\n * function only when used\n *\n * @author ryansolid\n * @template T\n * @type SignalFunction<T>\n * @param {() => T} fn - Function to re-run when dependencies change\n * @returns {SignalFunction<T>}\n */\nexport function writable(fn) {\n\tconst result = memo(() => signal(fn()))\n\treturn (...args) =>\n\t\targs.length ? result().write(args[0]) : result().read()\n}\n\n/**\n * Creates an asynchronously effect\n *\n * @param {(currentRunningEffect: Promise<any>) => any} fn - A\n *   function that receives a `currentRunningEffect` that should be\n *   awaited for when wanting to run effects synchronously, that's it\n *   one effect after another.\n */\nexport function asyncEffect(fn) {\n\tconst queue = []\n\teffect(() => {\n\t\tconst { promise, resolve } = withResolvers()\n\n\t\tqueue.push(promise)\n\n\t\tfunction onDone() {\n\t\t\tremoveFromArray(queue, promise)\n\t\t\tresolve()\n\t\t}\n\n\t\tresolved(\n\t\t\tfn(queue.length === 1 ? undefined : queue[queue.length - 2]),\n\t\t\tonDone,\n\t\t)\n\t})\n}\n\n/**\n * A Promise loader handler. Allows to display/run something or\n * nothing while a promise is resolving. Allows to run a callback when\n * the promise resolves. Allows to get notified of errors, and\n * display/run something or nothing, if wanted a `retry` function is\n * given for retrying the promise. All functions run with the original\n * owner, so it's `Context` friendly.\n *\n * @param {(() => Promise<any>) | Promise<any>} fn - Function that\n *   returns a promise\n * @param {{\n * \tonLoading?: any\n * \tonLoad?: () => unknown\n * \tonError?: ((e: Error, retry: Function) => any) | any\n * }} [options]\n *\n * @returns {Component}\n * @url https://pota.quack.uy/lazy\n */\nexport const lazy = (fn, options = nothing) =>\n\tmarkComponent(props => {\n\t\tconst { onLoading, onLoad, onError } = options\n\n\t\tconst [value, setValue] = signal(onLoading)\n\n\t\tconst onLoaded = owned(onLoad)\n\n\t\tconst retry = () =>\n\t\t\tPromise.resolve(isFunction(fn) ? fn() : fn)\n\t\t\t\t.then(r => {\n\t\t\t\t\tsetValue(\n\t\t\t\t\t\tmarkComponent(() => {\n\t\t\t\t\t\t\tr = isObject(r) && r.default ? r.default : r\n\t\t\t\t\t\t\treturn isFunction(r) ? r(props) : r\n\t\t\t\t\t\t}),\n\t\t\t\t\t)\n\t\t\t\t\tmicrotask(onLoaded)\n\t\t\t\t})\n\t\t\t\t.catch(e =>\n\t\t\t\t\tonError\n\t\t\t\t\t\t? setValue(\n\t\t\t\t\t\t\t\tmarkComponent(() =>\n\t\t\t\t\t\t\t\t\tisFunction(onError) ? onError(e, retry) : onError,\n\t\t\t\t\t\t\t\t),\n\t\t\t\t\t\t\t)\n\t\t\t\t\t\t: console.error(e),\n\t\t\t\t)\n\t\tretry()\n\n\t\treturn value\n\t})\n\nexport const Lazy = props => lazy(props.children, props)\n\n/** @param {() => unknown} fn */\nexport const microtask = fn => queueMicrotask(owned(fn))\n\n// MAP\n\nclass Row {\n\trunId\n\titem\n\tindex\n\tisDupe\n\tdisposer\n\tnodes\n\n\tconstructor(item, index, fn, isDupe) {\n\t\tthis.item = item\n\t\tthis.index = index\n\t\tthis.isDupe = isDupe\n\n\t\troot(disposer => {\n\t\t\tthis.disposer = disposer\n\t\t\t/** @type Children[] */\n\t\t\tthis.nodes = fn(item, index)\n\t\t})\n\t}\n\tbegin() {\n\t\treturn this.nodes[0]\n\t}\n\tend() {\n\t\treturn this.nodes[this.nodes.length - 1]\n\t}\n\tnodesForRow() {\n\t\tconst begin = this.begin()\n\t\tconst end = this.end()\n\n\t\tconst nodes = [begin]\n\n\t\tlet nextSibling = begin\n\t\twhile (nextSibling !== end) {\n\t\t\tnextSibling = nextSibling.nextSibling\n\t\t\tnodes.push(nextSibling)\n\t\t}\n\n\t\treturn nodes\n\t}\n}\n\n/**\n * Reactive Map\n *\n * @template T\n * @param {Each<T>} list\n * @param {Function} callback\n * @param {boolean} [sort]\n * @param {Children} [fallback]\n */\nexport function map(list, callback, sort, fallback) {\n\tconst cache = new Map()\n\tconst duplicates = new Map() // for when caching by value is not possible [1, 2, 1, 1, 1]\n\n\tlet runId = 0\n\n\tlet rows = []\n\t/** @type any[] */\n\tlet prev = []\n\n\tfunction clear() {\n\t\tfor (const row of prev) {\n\t\t\trow.disposer()\n\t\t}\n\t\tcache.clear()\n\t\tduplicates.clear()\n\n\t\trows.length = 0\n\t\tprev.length = 0\n\t}\n\n\t// to get rid of all nodes when parent disposes\n\tcleanup(clear)\n\n\tfunction dispose(row) {\n\t\t// delete from cache\n\t\tif (!row.isDupe) {\n\t\t\tcache.delete(row.item)\n\t\t} else {\n\t\t\tconst arr = duplicates.get(row.item)\n\t\t\tarr.length === 1\n\t\t\t\t? duplicates.delete(row.item)\n\t\t\t\t: removeFromArray(arr, row)\n\t\t}\n\n\t\trow.disposer()\n\t}\n\n\t/**\n\t * @param {Function} fn\n\t * @returns {Children}\n\t */\n\tfunction mapper(fn) {\n\t\tconst cb = fn\n\t\t\t? (item, index) => fn(callback(item, index), index)\n\t\t\t: callback\n\n\t\tconst value = getValue(list) || []\n\n\t\t/** To allow iterate objects as if were an array with indexes */\n\t\tconst items = toEntries(value)\n\n\t\trunId++\n\t\trows = []\n\t\tconst hasPrev = prev.length\n\n\t\tfor (const [index, item] of items) {\n\t\t\tlet row = hasPrev ? cache.get(item) : undefined\n\n\t\t\t// if the item doesnt exists, create it\n\t\t\tif (row === undefined) {\n\t\t\t\trow = new Row(item, index, cb, false)\n\t\t\t\tcache.set(item, row)\n\t\t\t} else if (row.runId === runId) {\n\t\t\t\t// a map will save only 1 of any primitive duplicates, say: [1, 1, 1, 1]\n\t\t\t\t// if the saved value was already used on this run, create a new one\n\t\t\t\tlet dupes = duplicates.get(item)\n\t\t\t\tif (!dupes) {\n\t\t\t\t\tdupes = []\n\t\t\t\t\tduplicates.set(item, dupes)\n\t\t\t\t}\n\t\t\t\tfor (const dupe of dupes) {\n\t\t\t\t\tif (dupe.runId !== runId) {\n\t\t\t\t\t\trow = dupe\n\t\t\t\t\t\tbreak\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif (row.runId === runId) {\n\t\t\t\t\trow = new Row(item, index, cb, true)\n\t\t\t\t\tdupes.push(row)\n\t\t\t\t}\n\t\t\t}\n\n\t\t\trow.runId = runId // mark used on this run\n\t\t\trow.index = index // save sort order\n\t\t\trows.push(row)\n\t\t}\n\n\t\t// fast clear\n\t\tif (rows.length === 0) {\n\t\t\tclear()\n\t\t\tprev = rows\n\t\t\treturn fallback ? fn(fallback) : emptyArray\n\t\t}\n\n\t\t// remove rows that arent present on the current run\n\t\tfor (let i = 0; i < prev.length; i++) {\n\t\t\tif (prev[i].runId !== runId) {\n\t\t\t\tdispose(prev[i])\n\t\t\t\tremoveFromArray(prev, prev[i--])\n\t\t\t}\n\t\t}\n\n\t\t// reorder elements\n\t\t// `rows.length > 1` because no need for sorting when there are no items\n\t\t// `prev.length > 0` to skip sorting on creation as its already sorted\n\t\tif (sort && rows.length > 1 && prev.length) {\n\t\t\t// when appending to already created it shouldnt sort\n\t\t\t// as its already sorted\n\t\t\tlet sort = false\n\t\t\tfor (let i = 0; i < prev.length && i < rows.length; i++) {\n\t\t\t\tif (prev[i] !== rows[i]) {\n\t\t\t\t\tsort = true\n\t\t\t\t\tbreak\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (sort) {\n\t\t\t\t// if the planets align it handles swapping\n\t\t\t\t// a = sorted\n\t\t\t\t// b = unsorted\n\t\t\t\tconst { a, b } = groupBy(rows, (value, index) =>\n\t\t\t\t\trows[index] === prev[index] ? 'a' : 'b',\n\t\t\t\t)\n\n\t\t\t\tlet unsorted = b?.length\n\t\t\t\tif (\n\t\t\t\t\ta &&\n\t\t\t\t\tb &&\n\t\t\t\t\ta.length &&\n\t\t\t\t\tb.length &&\n\t\t\t\t\tb.length < a.length &&\n\t\t\t\t\tb.every(item => prev.includes(item))\n\t\t\t\t) {\n\t\t\t\t\tfor (const usort of b) {\n\t\t\t\t\t\tfor (const sort of a) {\n\t\t\t\t\t\t\tif (usort.index === sort.index - 1) {\n\t\t\t\t\t\t\t\tsort.begin().before(...usort.nodesForRow())\n\t\t\t\t\t\t\t\tunsorted--\n\t\t\t\t\t\t\t\tbreak\n\t\t\t\t\t\t\t} else if (usort.index === sort.index + 1) {\n\t\t\t\t\t\t\t\tsort.end().after(...usort.nodesForRow())\n\t\t\t\t\t\t\t\tunsorted--\n\t\t\t\t\t\t\t\tbreak\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tif (unsorted) {\n\t\t\t\t\t// handles all other cases\n\t\t\t\t\t// best for any combination of: push/pop/shift/unshift/insertion/deletion\n\t\t\t\t\t// must check in reverse as on creation stuff is added to the end\n\n\t\t\t\t\tlet current = rows[rows.length - 1]\n\t\t\t\t\tfor (let i = rows.length - 1; i > 0; i--) {\n\t\t\t\t\t\tconst previous = rows[i - 1]\n\t\t\t\t\t\tif (current.begin().previousSibling !== previous.end()) {\n\t\t\t\t\t\t\tcurrent.begin().before(...previous.nodesForRow())\n\t\t\t\t\t\t}\n\t\t\t\t\t\tcurrent = previous\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\t// save sorted list\n\t\tprev = rows\n\n\t\t// return external representation\n\t\treturn rows.flatMap(item => item.nodes)\n\t}\n\tmapper[$isMap] = undefined\n\treturn mapper\n}\n\n/**\n * Resolves and returns `children` in a memo. A memo in a memo, so\n * reactivity on the inner memo doesnt trigger reactivity outside.\n *\n * @template {Children} T\n * @param {Accessor<T>} fn\n * @returns {SignalAccessor<T>}\n * @url https://pota.quack.uy/resolve\n */\nexport function resolve(fn) {\n\tconst children = isFunction(fn) ? memo(fn) : () => fn\n\treturn memo(() => unwrap(children()))\n}\n\n/**\n * Recursively unwrap children functions\n *\n * @param {Children} children\n */\nfunction unwrap(children) {\n\tif (isFunction(children)) {\n\t\treturn unwrap(children())\n\t}\n\n\tif (isArray(children)) {\n\t\tconst childrens = []\n\t\tfor (let child of children) {\n\t\t\tchild = unwrap(child)\n\t\t\tisArray(child)\n\t\t\t\t? childrens.push(...child)\n\t\t\t\t: childrens.push(child)\n\t\t}\n\t\treturn childrens\n\t}\n\n\treturn children\n}\n\n/**\n * Extend `Pota` and define a `render(){}` method to create a class\n * component. `ready(cb)` and `cleanup(cb)` methods will be registered\n * automatically\n *\n * @url https://pota.quack.uy/Classes\n */\nexport class Pota {}\n\nPota[$isClass] = undefined\n\n/**\n * Returns true if the `value` is a `Component`\n *\n * @param {any} value\n * @returns {boolean}\n */\nexport const isComponent = value =>\n\tisFunction(value) && $isComponent in value\n\n/**\n * Makes of `children` a function. Reactive children will run as is,\n * non-reactive children will run untracked, regular children will\n * just return.\n *\n * @template {Children} T\n * @param {T} children\n * @returns {((...args: unknown[]) => T) | T}\n */\nexport function makeCallback(children) {\n\t/**\n\t * 1. Shortcut the most used case\n\t * 2. When children is an array, as in >${[0, 1, 2]}< then children\n\t *    will end as `[[0, 1, 2]]`, so flat it\n\t */\n\treturn isFunction(children)\n\t\t? markComponent(children)\n\t\t: // @ts-ignore\n\t\t\tmarkComponent((...args) =>\n\t\t\t\t// @ts-ignore\n\t\t\t\tflatToArray(children).map(child =>\n\t\t\t\t\tisFunction(child) ? child(...args) : child,\n\t\t\t\t),\n\t\t\t)\n}\n\n/**\n * Marks a function as a `Component`.\n *\n * Allows to tell a `signal function` from a `component function`.\n * Signals and user functions go in effects, for reactivity.\n * Components and callbacks are untracked and wont go in effects to\n * avoid re-rendering if signals are used in the components body\n *\n * @template T\n * @param {T} fn - Function to mark as a `Component`\n */\nexport function markComponent(fn) {\n\tfn[$isComponent] = undefined\n\treturn fn\n}\n\n/**\n * Adds an event listener to a node\n *\n * @template {Element | Document | typeof window} TargetElement\n * @param {TargetElement} node - Element to add the event listener\n * @param {EventType} type - The name of the event listener\n * @param {EventHandler<Event, TargetElement>} handler - Function to\n *   handle the event\n * @returns {Function} - An `off` function for removing the event\n *   listener\n * @url https://pota.quack.uy/props/EventListener\n */\nexport function addEvent(node, type, handler) {\n\tnode.addEventListener(\n\t\ttype,\n\t\thandler,\n\t\t!isFunction(handler)\n\t\t\t? /** @type {EventHandlerOptions} */ (handler)\n\t\t\t: undefined,\n\t)\n\n\t/**\n\t * Removes event on tracking scope disposal.\n\t *\n\t * Situation: the event was added to the `document` or `window`\n\t * manually using `addEvent`, say to listen for clicks as a \"click\n\t * outside\". The event needs to be removed when the component that\n\t * added it is disposed.\n\t */\n\n\treturn cleanup(() => removeEvent(node, type, handler))\n}\n\n/**\n * Removes an event listener from a node\n *\n * @template {Element | Document | typeof window} TargetElement\n * @param {TargetElement} node - Element to add the event listener\n * @param {EventType} type - The name of the event listener\n * @param {EventHandler<Event, TargetElement>} handler - Function to\n *   handle the event\n * @returns {Function} - An `on` function for adding back the event\n *   listener\n * @url https://pota.quack.uy/props/EventListener\n */\nexport function removeEvent(node, type, handler) {\n\tnode.removeEventListener(\n\t\ttype,\n\t\thandler,\n\t\t!isFunction(handler)\n\t\t\t? /** @type {EventHandlerOptions} */ (handler)\n\t\t\t: undefined,\n\t)\n\n\treturn () => addEvent(node, type, handler)\n}\n\n/**\n * It gives a handler an owner, so stuff runs batched on it, and\n * things like context and cleanup work\n *\n * @template {EventHandler<Event, Element>} T\n * @param {T} handler\n */\nexport const ownedEvent = handler =>\n\t'handleEvent' in handler\n\t\t? {\n\t\t\t\t...handler,\n\t\t\t\thandleEvent: owned(e => handler.handleEvent(e)),\n\t\t\t}\n\t\t: owned(handler)\n","import { getValueWithArguments, window } from '../lib/std.js'\n\nexport const document = window.document\n\nexport const head = document?.head\n\nexport const isConnected = node => node.isConnected\n\nexport const activeElement = () => document.activeElement\n\nexport const documentElement = document?.documentElement\n\nexport const DocumentFragment = window.DocumentFragment\n\nconst bind = /* #__NO_SIDE_EFFECTS__ */ fn =>\n\tdocument && document[fn].bind(document)\n\nexport const createElement = bind('createElement')\nexport const createElementNS = bind('createElementNS')\nexport const createTextNode = bind('createTextNode')\nexport const createComment = bind('createComment')\n\nexport const importNode = bind('importNode')\n\nexport const createTreeWalker = bind('createTreeWalker')\n\nexport const addPart = (node, className) => node.part.add(className)\n\nexport const removePart = (node, className) =>\n\tnode.part.remove(className)\n\nexport const addClass = (node, className) =>\n\tnode.classList.add(className)\n\nexport const removeClass = (node, className) =>\n\tnode.classList.remove(className)\n\nexport const setAttribute = (node, name, value) =>\n\tnode.setAttribute(name, value)\n\nexport const hasAttribute = (node, name) => node.hasAttribute(name)\n\nexport const removeAttribute = (node, name) =>\n\tnode.removeAttribute(name)\n\nexport const setAttributeNS = (node, name, value) =>\n\tnode.setAttributeNS(name, value)\n\nexport const hasAttributeNS = (node, name) =>\n\tnode.hasAttributeNS(name)\n\nexport const removeAttributeNS = (node, name) =>\n\tnode.removeAttributeNS(name)\n\nexport const querySelector = (node, query) =>\n\tnode.querySelector(query)\n\nexport const querySelectorAll = (node, query) =>\n\tnode.querySelectorAll(query)\n\n/**\n * Returns `document` for element. That could be a `shadowRoot`\n *\n * @param {Element} node\n * @returns {Document | ShadowRoot}\n */\nexport const getDocumentForElement = node => {\n\tconst document = /** @type {Document | ShadowRoot} */ (\n\t\tnode.getRootNode()\n\t)\n\tconst { nodeType } = document\n\t// getRootNode returns:\n\t// 1. Node for isConnected = false\n\t// 2. Document for isConnected = true\n\t// 3. ShadowRoot for custom elements\n\n\t// always return a Document-like\n\treturn nodeType === 11 /* DOCUMENT_FRAGMENT_NODE (11) */ ||\n\t\tnodeType === 9 /* DOCUMENT_NODE (9)*/\n\t\t? document\n\t\t: node.ownerDocument\n}\n\nexport const walkElements = function (\n\twalk,\n\tnode,\n\tmax = Infinity,\n\tnodes = [],\n) {\n\t/**\n\t * The first node is not walked by the walker.\n\t *\n\t * Also the first node could be a DocumentFragment\n\t */\n\tnode.nodeType === 1 && nodes.push(node)\n\n\twalk.currentNode = node\n\n\twhile (nodes.length !== max && (node = walk.nextNode())) {\n\t\tnodes.push(node)\n\t}\n\treturn nodes\n}.bind(\n\tnull,\n\tcreateTreeWalker &&\n\t\tcreateTreeWalker(document, 1 /*NodeFilter.SHOW_ELEMENT*/),\n)\n\n/**\n * Unwraps `value` and returns `element` if result is a `Node`, else\n * `undefined` in the case isn't a `Node`\n *\n * @template T\n * @param {T} value - Maybe function\n * @param {...unknown} args? - Arguments\n * @returns {Node | Element | T | undefined}\n */\nexport function getValueElement(value, ...args) {\n\tconst element = getValueWithArguments(value, ...args)\n\treturn element instanceof Node ? element : undefined\n}\n","import {\n\tpromise,\n\tremoveFromArray,\n\twindow,\n\twithCache,\n\twithState,\n} from '../lib/std.js'\n\nimport { document } from './dom.js'\n\nexport const CSSStyleSheet = window.CSSStyleSheet\n\n/**\n * Creates tagged css and returns a CSSStyleSheet. Mostly for css\n * highlighting in js\n *\n * @param {TemplateStringsArray} template\n * @param {...any} values\n * @returns {CSSStyleSheet}\n */\nexport const css = (template, ...values) =>\n\tsheet(String.raw({ raw: template }, ...values))\n\n/**\n * Creates a stylesheet from a css string\n *\n * @param {string} css\n * @returns {CSSStyleSheet}\n */\nexport const sheet = withCache(css => {\n\tconst sheet = new CSSStyleSheet()\n\t/**\n\t * Replace is asynchronous and can accept `@import` statements\n\t * referencing external resources.\n\t */\n\tsheet.replace(css)\n\n\treturn sheet\n})\n\n/**\n * Returns `adoptedStyleSheets` for a document\n *\n * @param {Document | ShadowRoot} document\n */\nexport const getAdoptedStyleSheets = document =>\n\tdocument?.adoptedStyleSheets\n\nexport const adoptedStyleSheets =\n\t/* #__PURE__*/ getAdoptedStyleSheets(document)\n\n/**\n * Adds a style sheet to the document\n *\n * @param {Document | ShadowRoot} document\n * @param {CSSStyleSheet} styleSheet\n */\nexport const addAdoptedStyleSheet = (document, styleSheet) =>\n\tgetAdoptedStyleSheets(document).push(styleSheet)\n\n/**\n * Removes a style sheet from the document\n *\n * @param {Document | ShadowRoot} document\n * @param {CSSStyleSheet} styleSheet\n */\nexport const removeAdoptedStyleSheet = (document, styleSheet) =>\n\tremoveFromArray(getAdoptedStyleSheets(document), styleSheet)\n\n/**\n * Adds a style sheet to the custom element\n *\n * @param {Document | ShadowRoot} document\n * @param {(CSSStyleSheet | string)[]} styleSheets\n */\nexport function addStyleSheets(document, styleSheets = []) {\n\tfor (const sheet of styleSheets) {\n\t\tif (sheet) {\n\t\t\tsheet instanceof CSSStyleSheet\n\t\t\t\t? addAdoptedStyleSheet(document, sheet)\n\t\t\t\t: addStyleSheetExternal(document, sheet)\n\t\t}\n\t}\n}\n\n/**\n * Adds the stylesheet from urls. It uses a cache, to avoid having to\n * fire a request for each external sheet when used in more than one\n * custom element. Also, all reference the same object.\n *\n * @param {Document | ShadowRoot} document\n * @param {string} text\n */\nexport const addStyleSheetExternal = withState(\n\t(state, document, text) => {\n\t\tstate\n\t\t\t.get(text, text =>\n\t\t\t\ttext.startsWith('http')\n\t\t\t\t\t? fetch(text)\n\t\t\t\t\t\t\t.then(r => r.text())\n\t\t\t\t\t\t\t.then(css => sheet(css))\n\t\t\t\t\t: promise(resolve => resolve(sheet(text))),\n\t\t\t)\n\t\t\t.then(styleSheet => addAdoptedStyleSheet(document, styleSheet))\n\t},\n)\n","import { owned } from '../lib/reactive.js'\nimport { call, queueMicrotask } from '../lib/std.js'\n\n/**\n * The purpose of this file is to guarantee the timing of some\n * callbacks. It queues a microtask, then the callbacks are added to a\n * position in the array. These are run with a priority.\n */\n\n/** @type boolean */\nlet added\n\n/** @type [][] */\nlet queue\n\nfunction reset() {\n\tqueue = [[], [], [], [], [], []]\n\tadded = false\n}\n\n// initialization\nreset()\n\n/**\n * Queues a callback at a priority\n *\n * @param {PropertyKey} priority - Priority\n * @param {Function} fn - Function to run once the callbacks at this\n *   priority run\n */\nfunction add(priority, fn) {\n\tif (!added) {\n\t\tadded = true\n\t\tqueueMicrotask(run)\n\t}\n\tqueue[priority].push(owned(fn))\n}\n\n/** Runs all queued callbacks */\nfunction run() {\n\tconst q = queue\n\treset()\n\n\tfor (const fns of q) {\n\t\tfns.length && call(fns)\n\t}\n}\n\n/**\n * Queue a function to run before everything else (onProps, onRef,\n * onMount, ready) ex focus restoration\n *\n * @param {Function} fn\n */\nexport const onFixes = fn => add(0, fn)\n\n/**\n * Queue a function to run before (onRef, onMount, ready) ex running\n * user functions on elements via plugins\n *\n * @param {Function} fn\n */\nexport const onProps = fn => add(1, fn)\n\n/**\n * Queue a function to run onRef (before onMount, after onProps)\n *\n * @param {Function} fn\n */\nexport const onRef = fn => add(2, fn)\n\n/**\n * Queue a function to run onMount (before ready, after onRef)\n *\n * @param {Function} fn\n */\nexport const onMount = fn => add(3, fn)\n\n/**\n * Queue a function to run on ready (after onMount)\n *\n * @param {Function} fn\n * @url https://pota.quack.uy/ready\n */\nexport const ready = fn => add(4, fn)\n\n/**\n * Queue a function to run after all user defined processes\n *\n * @param {Function} fn\n */\nexport const onDone = fn => add(5, fn)\n","import { cacheStore, toArray } from '../../lib/std.js'\nimport { onProps } from '../scheduler.js'\n\nexport const plugins = cacheStore()\nexport const pluginsNS = cacheStore()\n\n/** @type {Set<string> & { xmlns?: string }} */\nexport const namespaces = new Set([\n\t'on',\n\t'prop',\n\t'class',\n\t'style',\n\t'use',\n])\n\nfunction updateNamespaces() {\n\tnamespaces.xmlns = toArray(namespaces)\n\t\t.map(ns => `xmlns:${ns}=\"/\"`)\n\t\t.join(' ')\n}\nupdateNamespaces()\n\n/**\n * Defines a prop that can be used on any Element\n *\n * @param {string} propName - Name of the prop\n * @param {(\n * \tnode: Element,\n * \tpropName: string,\n * \tpropValue: Function | any,\n * \tprops: object,\n * ) => void} fn\n *   - Function to run when this prop is found on any Element\n *\n * @param {boolean} [onMicrotask=true] - To avoid the problem of\n *   needed props not being set, or children elements not created yet.\n *   Default is `true`\n * @url https://pota.quack.uy/props/propsPlugin\n */\nexport const propsPlugin = (propName, fn, onMicrotask) => {\n\tplugin(plugins, propName, fn, onMicrotask)\n}\n\n/**\n * Defines a namespaced prop that can be used on any Element\n *\n * @param {string} NSName - Name of the namespace\n * @param {(\n * \tnode: Element,\n * \tpropName: string,\n * \tpropValue: Function | any,\n * \tprops: object,\n * \tlocalName: string,\n * \tns: string,\n * ) => void} fn\n *   - Function to run when this prop is found on any Element\n *\n * @param {boolean} [onMicrotask=true] - Set to run on a microtask to\n *   avoid the problem of needed props not being set, or children\n *   elements not being created yet. Default is `true`\n */\nexport const propsPluginNS = (NSName, fn, onMicrotask) => {\n\t// update namespace for the `xml` function\n\tnamespaces.add(NSName)\n\tupdateNamespaces()\n\tplugin(pluginsNS, NSName, fn, onMicrotask)\n}\n\n/**\n * @param {typeof plugins} plugins\n * @param {string} name\n * @param {Function} fn\n * @param {boolean} [onMicrotask=true] Default is `true`\n */\nconst plugin = (plugins, name, fn, onMicrotask = true) => {\n\tplugins.set(\n\t\tname,\n\t\t!onMicrotask ? fn : (...args) => onProps(() => fn(...args)),\n\t)\n}\n","import { withValue } from '../../lib/reactive.js'\nimport { isNullUndefined } from '../../lib/std.js'\n\n/**\n * @param {Element} node\n * @param {string} name\n * @param {unknown} value\n * @param {object} props\n * @param {string} localName\n * @param {string} ns\n */\nexport const setPropertyNS = (\n\tnode,\n\tname,\n\tvalue,\n\tprops,\n\tlocalName,\n\tns,\n) => {\n\tsetProperty(node, localName, value)\n}\n\n/**\n * @param {Element} node\n * @param {string} name\n * @param {unknown} value\n * @url https://pota.quack.uy/props/setProperty\n */\nexport const setProperty = (node, name, value) => {\n\twithValue(value, value => _setProperty(node, name, value))\n}\n/**\n * @param {Element} node\n * @param {string} name\n * @param {unknown} value\n */\nexport function _setProperty(node, name, value) {\n\t// if the value is null or undefined it will be set to null\n\tif (isNullUndefined(value)) {\n\t\t// defaulting to `undefined` breaks `progress` tag and the whole page\n\t\tnode[name] = null\n\t} else {\n\t\tnode[name] = value\n\t}\n}\n","import { addEvent, ownedEvent } from '../../lib/reactive.js'\n\n/**\n * @template {Element} T\n * @param {T} node\n * @param {string} name\n * @param {EventHandler<Event, T>} value\n * @param {object} props\n * @param {string} localName\n * @param {string} ns\n */\nexport const setEventNS = (\n\tnode,\n\tname,\n\tvalue,\n\tprops,\n\tlocalName,\n\tns,\n) => {\n\t// `value &&` because avoids crash when `on:click={prop.onClick}` and `prop.onClick === null`\n\tvalue && addEvent(node, localName, ownedEvent(value))\n}\n","/** Returns true or false with a `chance` of getting `true` */\nexport const chance = (chance = 50, generator = random) => {\n\treturn generator() < chance / 100\n}\n\n/** Returns random number between 0 and 1 */\nexport const random = () =>\n\tcrypto.getRandomValues(new Uint32Array(1))[0] / (0xffffffff + 1)\n\nexport const randomBetween = (\n\tmin = 0,\n\tmax = 100,\n\tgenerator = random,\n) => Math.floor(generator() * (max - min + 1)) + min\n\nexport const randomColor = (min = 0, max = 255) =>\n\t'rgb(' +\n\trandomBetween(min, max) +\n\t',' +\n\trandomBetween(min, max) +\n\t',' +\n\trandomBetween(min, max) +\n\t')'\n\nexport const randomId = () =>\n\tcrypto.getRandomValues(new BigUint64Array(1))[0].toString(36)\n\n/**\n * Returns a random number generator based on a seed that generates\n * numbers between 0 and 1\n *\n * @param {number} seed\n */\nexport function randomSeeded(seed) {\n\tconst m = 2 ** 35 - 31\n\tlet s = seed % m\n\treturn () => (s = (s * 185852) % m) / m\n}\n","import { queueMicrotask, withState } from '../../lib/std.js'\nimport { addAdoptedStyleSheet, sheet } from '../../use/css.js'\nimport { addClass, getDocumentForElement } from '../../use/dom.js'\n\nimport { randomId } from '../../use/random.js'\n\n/**\n * @param {Element} node\n * @param {string} name\n * @param {string} value\n * @param {object} props\n */\nexport const setCSS = (node, name, value, props) => {\n\tsetNodeCSS(node, value)\n}\n\n/** @type {(node: Element, value: string) => void} */\nconst setNodeCSS = withState(\n\t(state, node, value, retrying = false) => {\n\t\tif (!node.isConnected && !retrying) {\n\t\t\treturn queueMicrotask(() => setNodeCSS(node, value, true))\n\t\t}\n\n\t\taddClass(\n\t\t\tnode,\n\t\t\tstate.get(value, value => {\n\t\t\t\tconst id = 'c' + randomId()\n\t\t\t\taddAdoptedStyleSheet(\n\t\t\t\t\tgetDocumentForElement(node),\n\t\t\t\t\tsheet(value.replace(/class/g, '.' + id)),\n\t\t\t\t)\n\t\t\t\treturn id\n\t\t\t}),\n\t\t)\n\t},\n)\n","import { cleanup } from '../../lib/reactive.js'\n\nimport { onMount, onRef } from '../scheduler.js'\n\n/**\n * @param {Element} node\n * @param {string} name\n * @param {Function} value\n * @param {object} props\n */\nexport const setRef = (node, name, value, props) => {\n\tonRef(() => value(node))\n}\n\n/**\n * @param {Element} node\n * @param {string} name\n * @param {Function} value\n * @param {object} props\n */\nexport const setConnected = (node, name, value, props) => {\n\tonMount(() => value(node))\n}\n\n/**\n * @param {Element} node\n * @param {string} name\n * @param {Function} value\n * @param {object} props\n */\nexport const setDisconnected = (node, name, value, props) => {\n\tcleanup(() => value(node))\n}\n","// node style\n\nimport { withValue } from '../../lib/reactive.js'\nimport {\n\tgetValue,\n\tisFunction,\n\tisNullUndefined,\n\tisObject,\n\tisString,\n} from '../../lib/std.js'\n\n/**\n * @param {DOMElement} node\n * @param {string} name\n * @param {StyleAttribute} value\n * @param {object} props\n * @url https://pota.quack.uy/props/setStyle\n */\nexport const setStyle = (node, name, value, props) => {\n\tsetNodeStyle(node.style, value)\n}\n\n/**\n * @param {DOMElement} node\n * @param {string} name\n * @param {StyleAttribute} value\n * @param {object} props\n * @param {string} localName\n * @param {string} ns\n */\nexport const setStyleNS = (\n\tnode,\n\tname,\n\tvalue,\n\tprops,\n\tlocalName,\n\tns,\n) => {\n\tsetNodeStyle(\n\t\tnode.style,\n\t\tisObject(value) ? value : { [localName]: value },\n\t)\n}\n\n/**\n * @param {CSSStyleDeclaration} style\n * @param {StyleAttribute} value\n */\nfunction setNodeStyle(style, value) {\n\tif (isString(value)) {\n\t\tstyle.cssText = value\n\t} else if (isFunction(value)) {\n\t\twithValue(value, value => setNodeStyle(style, getValue(value)))\n\t} else if (isObject(value)) {\n\t\tfor (const name in value) {\n\t\t\tsetStyleValue(style, name, value[name])\n\t\t}\n\t}\n}\n\n/**\n * @param {DOMElement} node\n * @param {string} name\n * @param {unknown} value\n */\nexport const setElementStyle = (node, name, value) => {\n\tsetStyleValue(node.style, name, value)\n}\n\n/**\n * @param {CSSStyleDeclaration} style\n * @param {string} name\n * @param {unknown} value\n */\nconst setStyleValue = (style, name, value) => {\n\twithValue(value, value => _setStyleValue(style, name, value))\n}\n\n/**\n * @param {CSSStyleDeclaration} style\n * @param {string} name\n * @param {string | null} value\n */\nconst _setStyleValue = (style, name, value) => {\n\t// if the value is null or undefined it will be removed\n\tisNullUndefined(value)\n\t\t? style.removeProperty(name)\n\t\t: style.setProperty(name, value)\n}\n","// node class / classList\n\nimport { isFunction, isObject, isString } from '../../lib/std.js'\nimport { withPrevValue, withValue } from '../../lib/reactive.js'\n\nimport { addClass, removeClass } from '../../use/dom.js'\n\n/**\n * @param {Element} node\n * @param {string} name\n * @param {object | string | ArrayLike<any>} value\n * @param {object} props\n */\nexport const setClass = (node, name, value, props) => {\n\tisString(value)\n\t\t? node.setAttribute(name, value)\n\t\t: setClassList(node, value)\n}\n\n/**\n * @param {Element} node\n * @param {string} name\n * @param {object | string | ArrayLike<any>} value\n * @param {object} props\n * @param {string} localName\n * @param {string} ns\n */\nexport const setClassNS = (\n\tnode,\n\tname,\n\tvalue,\n\tprops,\n\tlocalName,\n\tns,\n) => {\n\tisFunction(value) || !isObject(value)\n\t\t? setElementClass(node, localName, value)\n\t\t: setClassList(node, value)\n}\n\n/**\n * @param {Element} node\n * @param {object | string | ArrayLike<any>} value\n */\nfunction setClassList(node, value) {\n\tswitch (typeof value) {\n\t\tcase 'string': {\n\t\t\t_setClassListValue(node, value, true)\n\t\t\tbreak\n\t\t}\n\n\t\tcase 'object': {\n\t\t\tlet name\n\t\t\tfor (name in value) {\n\t\t\t\tsetElementClass(node, name, value[name])\n\t\t\t}\n\t\t\tbreak\n\t\t}\n\n\t\tcase 'function': {\n\t\t\twithValue(value, value => setClassList(node, value))\n\t\t\tbreak\n\t\t}\n\t}\n}\n/**\n * @param {Element} node\n * @param {string} name\n * @param {unknown} value\n */\nexport const setElementClass = (node, name, value) => {\n\twithPrevValue(value, (value, prev) => {\n\t\tif (!value && !prev) {\n\t\t\t// on initialization do not remove whats not there\n\t\t} else {\n\t\t\t_setClassListValue(node, name, value)\n\t\t}\n\t})\n}\n\n/**\n * @param {Element} node\n * @param {string} name\n * @param {unknown} value\n */\n\nconst _setClassListValue = (node, name, value) => {\n\t// null, undefined or false, the class is removed\n\t!value\n\t\t? removeClass(node, name)\n\t\t: addClass(node, ...name.trim().split(/\\s+/))\n}\n","import { withValue } from '../../lib/reactive.js'\nimport { isNullUndefined } from '../../lib/std.js'\n\nimport { NS } from '../../constants.js'\n\n// NODE ATTRIBUTES\n\n/**\n * @param {Element} node\n * @param {string} name\n * @param {Accessor<string | boolean>} value\n * @param {object} props\n * @param {string} localName\n * @param {string} ns\n */\nexport const setAttributeNS = (\n\tnode,\n\tname,\n\tvalue,\n\tprops,\n\tlocalName,\n\tns,\n) => {\n\tsetAttribute(node, localName, value)\n}\n\n/**\n * @param {Element} node\n * @param {string} name\n * @param {Accessor<string | boolean>} value\n * @param {string} [ns]\n * @url https://pota.quack.uy/props/setAttribute\n */\nexport const setAttribute = (node, name, value, ns) => {\n\twithValue(value, value => _setAttribute(node, name, value, ns))\n}\n/**\n * @param {Element} node\n * @param {string} name\n * @param {string | boolean} value\n * @param {string} [ns]\n */\nfunction _setAttribute(node, name, value, ns) {\n\t// @ts-ignore\n\n\t// if the value is false/null/undefined it will be removed\n\tif (value === false || isNullUndefined(value)) {\n\t\tns && NS[ns]\n\t\t\t? node.removeAttributeNS(NS[ns], name)\n\t\t\t: node.removeAttribute(name)\n\t} else {\n\t\tns && NS[ns]\n\t\t\t? node.setAttributeNS(NS[ns], name, value === true ? '' : value)\n\t\t\t: node.setAttribute(name, value === true ? '' : value)\n\t}\n}\n","import { empty } from '../../lib/std.js'\n\nimport {\n\tplugins,\n\tpluginsNS,\n\tpropsPlugin,\n\tpropsPluginNS,\n} from './plugin.js'\n\n// PLUGINS NS\n\n// properties\n\nimport { setPropertyNS } from './property.js'\npropsPluginNS('prop', setPropertyNS, false)\n\n// events\n\nimport { setEventNS } from './event.js'\npropsPluginNS('on', setEventNS, false)\n\n// PLUGIN BOTH\n\n// css\n\nimport { setCSS } from './css.js'\npropsPlugin('use:css', setCSS, false)\n\n// mount\n\nimport { setConnected } from './lifecycle.js'\npropsPlugin('use:connected', setConnected, false)\n\n// unmount\n\nimport { setDisconnected } from './lifecycle.js'\npropsPlugin('use:disconnected', setDisconnected, false)\n\n// ref\n\nimport { setRef } from './lifecycle.js'\npropsPlugin('use:ref', setRef, false)\n\n// PLUGIN BOTH DIFFERENT\n\n// styles\n\nimport { setStyle, setStyleNS } from './style.js'\npropsPlugin('style', setStyle, false)\npropsPluginNS('style', setStyleNS, false)\n\n// class\n\nimport { setClass, setClassNS } from './class.js'\npropsPlugin('class', setClass, false)\npropsPluginNS('class', setClassNS, false)\n\n// catch all\n\nconst propNS = empty()\n\nimport { setAttribute } from './attribute.js'\n\n/**\n * Assigns a prop to an Element\n *\n * @template T\n * @param {Element} node\n * @param {string} name\n * @param {any} value\n * @param {T} props\n */\nexport function assignProp(node, name, value, props) {\n\t// run plugins\n\tlet plugin = plugins.get(name)\n\tif (plugin) {\n\t\tplugin(node, name, value, props)\n\t} else if (propNS[name] || name.includes(':')) {\n\t\t// with ns\n\t\tpropNS[name] = propNS[name] || name.split(':')\n\n\t\t// run plugins NS\n\t\tplugin = pluginsNS.get(propNS[name][0])\n\t\tplugin\n\t\t\t? plugin(\n\t\t\t\t\tnode,\n\t\t\t\t\tname,\n\t\t\t\t\tvalue,\n\t\t\t\t\tprops,\n\t\t\t\t\tpropNS[name][1],\n\t\t\t\t\tpropNS[name][0],\n\t\t\t\t)\n\t\t\t: setAttribute(node, name, value, propNS[name][0])\n\t} else {\n\t\t// catch all\n\t\tsetAttribute(node, name, value)\n\t}\n}\n\n/**\n * Assigns props to an Element\n *\n * @template T\n * @param {Element} node - Element to which assign props\n * @param {T} props - Props to assign\n */\nexport function assignProps(node, props) {\n\tfor (const name in props) {\n\t\tassignProp(node, name, props[name], props)\n\t}\n}\n","// CONSTANTS\n\nimport { $isClass, $isComponent, $isMap, NS } from '../constants.js'\n\n// LIB\n\nimport {\n\tunwrapArray,\n\tfreeze,\n\tisArray,\n\titerator,\n\tnothing,\n\tresolved,\n\tstringify,\n\ttoArray,\n\tflatToArray,\n\ttoValues,\n\tisFunction,\n} from '../lib/std.js'\n\nimport {\n\tcreateElement,\n\tcreateElementNS,\n\tcreateTextNode,\n\tdocument,\n\tDocumentFragment,\n\tgetDocumentForElement,\n\thead,\n\timportNode,\n\tisConnected,\n\tquerySelector,\n\twalkElements,\n} from '../use/dom.js'\n\nimport {\n\taddAdoptedStyleSheet,\n\tremoveAdoptedStyleSheet,\n} from '../use/css.js'\n\n// REACTIVE\n\nimport {\n\tcleanup,\n\tContext,\n\teffect,\n\troot,\n\tsignal,\n\tuntrack,\n\tmarkComponent,\n} from '../lib/reactive.js'\n\nimport { onFixes, ready } from './scheduler.js'\n\n// PROPERTIES / ATTRIBUTES\n\nimport { assignProps } from './props/@main.js'\nimport { propsPlugin } from './props/plugin.js'\n\n// STATE\n\nconst useXMLNS = context()\n\n// COMPONENTS\n\n/**\n * Used by the regular JSX transform, as `<>...</>` or\n * `<Fragment>...</Fragment>`.\n */\nexport const Fragment = props => props.children\n\n/**\n * Creates components for things. When props argument is given, the\n * props become fixed. When props argument is ommited, it allows you\n * to keep calling the returned function with new props. Returns a\n * function because we need to render from parent to children instead\n * of from children to parent. This allows to properly set the\n * reactivity tree (think of nested effects that clear inner effects,\n * context, etc).\n *\n * @template T\n * @param {string | Function | Element | object | symbol} value -\n *   Component\n * @param {Props<T>} [props] - Props object\n * @returns {(props: Partial<Props<T>>) => Children}\n * @url https://pota.quack.uy/Component\n */\nexport function Component(value, props) {\n\tif (value === Fragment) {\n\t\treturn props.children\n\t}\n\n\t/** Freeze props so isnt directly writable */\n\tfreeze(props)\n\n\t/** Create a callable function to pass `props` */\n\tconst component = Factory(value)\n\n\treturn props === undefined\n\t\t? component\n\t\t: markComponent(propsOverride =>\n\t\t\t\tcomponent(\n\t\t\t\t\tpropsOverride\n\t\t\t\t\t\t? freeze({ ...props, ...propsOverride })\n\t\t\t\t\t\t: props,\n\t\t\t\t),\n\t\t\t)\n}\n\n/**\n * Creates a component that could be called with a props object\n *\n * @template T\n * @param {string | Function | Element | object | symbol} value -\n *   Component value\n * @returns {(props?: Props<T>) => Children}\n */\nfunction Factory(value) {\n\tswitch (typeof value) {\n\t\tcase 'string': {\n\t\t\t// string component, 'div' becomes <div>\n\t\t\treturn markComponent(props => createTag(value, props))\n\t\t}\n\t\tcase 'function': {\n\t\t\tif ($isComponent in value) {\n\t\t\t\treturn value\n\t\t\t}\n\n\t\t\tif ($isClass in value) {\n\t\t\t\t// class component <MyComponent../>\n\t\t\t\treturn markComponent(props => createClass(value, props))\n\t\t\t}\n\n\t\t\t// function component <MyComponent../>\n\t\t\t// value = value\n\t\t\treturn markComponent(value)\n\t\t}\n\t\tdefault: {\n\t\t\tif (value instanceof Element) {\n\t\t\t\t// node component <div>\n\t\t\t\treturn markComponent(props => createNode(value, props))\n\t\t\t}\n\n\t\t\treturn markComponent(() => createAnything(value))\n\t\t}\n\t}\n}\n\nfunction createClass(value, props) {\n\tconst i = new value(props)\n\ti.ready && ready(() => i.ready())\n\ti.cleanup && cleanup(() => i.cleanup())\n\n\treturn i.render(props)\n}\n\nfunction createAnything(value) {\n\treturn value\n}\n\n/**\n * Creates a x/html element from a tagName\n *\n * @template {Props<{ xmlns?: string }>} P\n * @param {string} tagName\n * @param {P} props\n * @returns {Element} Element\n */\nfunction createTag(tagName, props) {\n\t/**\n\t * Namespace, use props xmlns or special case svg, math, etc in case\n\t * of missing xmlns attribute\n\t */\n\tconst xmlns = props?.xmlns || NS[tagName]\n\n\treturn withXMLNS(\n\t\txmlns,\n\t\txmlns =>\n\t\t\tcreateNode(\n\t\t\t\txmlns\n\t\t\t\t\t? createElementNS(xmlns, tagName)\n\t\t\t\t\t: createElement(tagName),\n\t\t\t\tprops,\n\t\t\t),\n\t\ttagName,\n\t)\n}\n\n/**\n * @param {string} xmlns\n * @param {(xmlns: string) => Element} fn\n * @param {string} tagName\n * @returns {Element}\n */\nfunction withXMLNS(xmlns, fn, tagName) {\n\tconst nsContext = useXMLNS()\n\n\tif (xmlns && xmlns !== nsContext) {\n\t\t// the xmlns changed, use the new xmlns\n\t\treturn useXMLNS(xmlns, () => fn(xmlns))\n\t}\n\n\t/**\n\t * `foreignObject` children are created with html xmlns (default\n\t * browser behaviour)\n\t */\n\tif (nsContext && tagName === 'foreignObject') {\n\t\treturn useXMLNS(NS.html, () => fn(nsContext))\n\t}\n\n\treturn fn(nsContext)\n}\n\n// PARTIALS\n\nfunction parseXML(content, xmlns) {\n\tconst template = xmlns\n\t\t? createElementNS(xmlns, 'template')\n\t\t: createElement('template')\n\n\ttemplate.innerHTML = content\n\n\t// xml\n\tlet tlpContent = template.content\n\tif (!tlpContent) {\n\t\tconst childNodes = template.childNodes\n\t\tif (childNodes.length === 1) {\n\t\t\treturn template.firstChild\n\t\t}\n\n\t\ttlpContent = new DocumentFragment()\n\t\ttlpContent.append(...childNodes)\n\t}\n\n\treturn tlpContent.childNodes.length === 1\n\t\t? tlpContent.firstChild\n\t\t: tlpContent\n}\n\n/** Used in transform in place of jsxs */\nexport function createComponent(value) {\n\tconst component = Factory(value)\n\n\treturn props => {\n\t\t/** Freeze props so isnt directly writable */\n\t\tfreeze(props)\n\t\treturn markComponent(() => component(props))\n\t}\n}\n\n/**\n * @template T\n * @param {string} content\n * @param {{\n * \tx?: string\n * \ti?: number\n * \tm?: number\n * } & Record<string, unknown>} [propsData]\n * @returns {(props: T extends any[]) => Children}\n */\nexport function createPartial(content, propsData = nothing) {\n\tlet clone = () => {\n\t\tconst node = withXMLNS(propsData.x, xmlns =>\n\t\t\tparseXML(content, xmlns),\n\t\t)\n\n\t\tclone = propsData.i\n\t\t\t? importNode.bind(null, node, true)\n\t\t\t: node.cloneNode.bind(node, true)\n\t\treturn clone()\n\t}\n\n\treturn props =>\n\t\tmarkComponent(() => assignPartialProps(clone(), props, propsData))\n}\n\n/**\n * @template T\n * @param {Element} node\n * @param {T[]} props\n * @param {{\n * \tx?: string\n * \ti?: number\n * \tm?: number\n * } & Record<string, unknown>} propsData\n * @returns {Children}\n */\nfunction assignPartialProps(node, props, propsData) {\n\tif (props) {\n\t\tconst nodes = walkElements(node, propsData.m)\n\n\t\twithXMLNS(propsData.x, xmlns => {\n\t\t\tfor (let i = 0; i < props.length; i++) {\n\t\t\t\tassignProps(nodes[propsData[i] || i], props[i])\n\t\t\t}\n\t\t})\n\t}\n\n\treturn node instanceof DocumentFragment\n\t\t? toArray(node.childNodes)\n\t\t: node\n}\n\n/**\n * Assigns props to an element and creates its children\n *\n * @template T\n * @param {Element} node - Element to assign props to\n * @param {Props<T>} props - Props to assign\n * @returns {Element} The element with props assigned\n */\nfunction createNode(node, props) {\n\tprops && assignProps(node, props)\n\n\treturn node\n}\n\n/**\n * Creates the children for a parent\n *\n * @param {Element | DocumentFragment} parent\n * @param {Children} child\n * @param {boolean} [relative]\n * @param {Text | undefined} [prev]\n * @returns {Children}\n */\nfunction createChildren(\n\tparent,\n\tchild,\n\trelative = false,\n\tprev = undefined,\n) {\n\tswitch (typeof child) {\n\t\t// string/number\n\t\tcase 'string':\n\t\tcase 'number': {\n\t\t\tif (prev instanceof Text) {\n\t\t\t\tprev.nodeValue = child\n\t\t\t\treturn prev\n\t\t\t}\n\n\t\t\t/**\n\t\t\t * The text node could be created by just doing\n\t\t\t * `parent.textContent = value` when the parent node has no\n\t\t\t * children.\n\t\t\t */\n\t\t\tif (!relative && parent.childNodes.length === 0) {\n\t\t\t\tparent.textContent = child\n\t\t\t\treturn parent.firstChild\n\t\t\t}\n\n\t\t\treturn insertNode(parent, createTextNode(child), relative)\n\t\t}\n\n\t\tcase 'function': {\n\t\t\t// component\n\t\t\tif ($isComponent in child) {\n\t\t\t\treturn createChildren(\n\t\t\t\t\tparent,\n\t\t\t\t\tuntrack(/** @type {() => Children} */ (child)),\n\t\t\t\t\trelative,\n\t\t\t\t)\n\t\t\t}\n\n\t\t\tlet node = []\n\n\t\t\t// signal/memo/external/user provided function\n\t\t\t// needs placeholder to stay in position\n\t\t\tparent = createPlaceholder(parent, relative)\n\n\t\t\t// For - TODO move this to the `For` component\n\t\t\t$isMap in child\n\t\t\t\t? effect(() => {\n\t\t\t\t\t\tnode = toDiff(\n\t\t\t\t\t\t\tnode,\n\t\t\t\t\t\t\tchild(child => {\n\t\t\t\t\t\t\t\t/**\n\t\t\t\t\t\t\t\t * Wrap the item with placeholders, for when stuff in\n\t\t\t\t\t\t\t\t * between moves. If a `Show` adds and removes nodes,\n\t\t\t\t\t\t\t\t * we dont have a reference to these nodes. By\n\t\t\t\t\t\t\t\t * delimiting with a shore, we can just handle\n\t\t\t\t\t\t\t\t * anything in between as a group.\n\t\t\t\t\t\t\t\t */\n\t\t\t\t\t\t\t\tconst begin = createPlaceholder(parent, true)\n\t\t\t\t\t\t\t\tconst end = createPlaceholder(parent, true)\n\t\t\t\t\t\t\t\treturn [begin, createChildren(end, child, true), end]\n\t\t\t\t\t\t\t}),\n\t\t\t\t\t\t\ttrue,\n\t\t\t\t\t\t)\n\t\t\t\t\t})\n\t\t\t\t: effect(() => {\n\t\t\t\t\t\t// maybe a signal (at least a function) so needs an effect\n\t\t\t\t\t\tnode = toDiff(\n\t\t\t\t\t\t\tnode,\n\t\t\t\t\t\t\tflatToArray(\n\t\t\t\t\t\t\t\tcreateChildren(parent, child(), true, node[0]),\n\t\t\t\t\t\t\t),\n\t\t\t\t\t\t\ttrue,\n\t\t\t\t\t\t)\n\t\t\t\t\t})\n\n\t\t\tcleanup(() => {\n\t\t\t\ttoDiff(node)\n\t\t\t\tparent.remove()\n\t\t\t})\n\n\t\t\t/**\n\t\t\t * A placeholder is created and added to the document but doesnt\n\t\t\t * form part of the children. The placeholder needs to be\n\t\t\t * returned so it forms part of the group of children. If\n\t\t\t * children are moved and the placeholder is not moved with\n\t\t\t * them, then, whenever children update these will be at the\n\t\t\t * wrong place. wrong place: where the placeholder is and not\n\t\t\t * where the children were moved to\n\t\t\t */\n\t\t\treturn parent\n\t\t}\n\n\t\tcase 'object': {\n\t\t\t// Node/DocumentFragment\n\t\t\tif (child instanceof Node) {\n\t\t\t\t/**\n\t\t\t\t * DocumentFragment are special as only the children get added\n\t\t\t\t * to the document and the document becomes empty. If we dont\n\t\t\t\t * insert them 1 by 1 then we wont have a reference to them\n\t\t\t\t * for deletion on cleanup with node.remove()\n\t\t\t\t */\n\t\t\t\tif (child instanceof DocumentFragment) {\n\t\t\t\t\treturn createChildren(\n\t\t\t\t\t\tparent,\n\t\t\t\t\t\ttoArray(child.childNodes),\n\t\t\t\t\t\trelative,\n\t\t\t\t\t)\n\t\t\t\t}\n\t\t\t\treturn insertNode(parent, child, relative)\n\t\t\t}\n\n\t\t\t// children/fragments\n\t\t\tif (isArray(child)) {\n\t\t\t\treturn child.length === 1\n\t\t\t\t\t? createChildren(parent, child[0], relative)\n\t\t\t\t\t: child.map(child =>\n\t\t\t\t\t\t\tcreateChildren(parent, child, relative),\n\t\t\t\t\t\t)\n\t\t\t}\n\n\t\t\t/**\n\t\t\t * The value is `null`, as in {null} or like a show returning\n\t\t\t * `null` on the falsy case\n\t\t\t */\n\t\t\tif (child === null) {\n\t\t\t\treturn undefined\n\t\t\t}\n\n\t\t\t// async components\n\t\t\tif ('then' in child) {\n\t\t\t\tconst [value, setValue] = signal(undefined)\n\n\t\t\t\tconst onResult = result =>\n\t\t\t\t\tisConnected(parent) && setValue(result)\n\n\t\t\t\tresolved(child, onResult)\n\n\t\t\t\treturn createChildren(parent, value, relative)\n\t\t\t}\n\n\t\t\t// iterable/Map/Set/NodeList\n\t\t\tif (iterator in child) {\n\t\t\t\t/**\n\t\t\t\t * For some reason this breaks with a node list in the\n\t\t\t\t * `Context` example of the `html` docs section.\n\t\t\t\t *\n\t\t\t\t *     return toArray(child.values(), child =>\n\t\t\t\t *     \tcreateChildren(parent, child, relative),\n\t\t\t\t *     )\n\t\t\t\t */\n\t\t\t\treturn createChildren(parent, toValues(child), relative)\n\t\t\t}\n\n\t\t\t// CSSStyleSheet\n\t\t\tif (child instanceof CSSStyleSheet) {\n\t\t\t\t/**\n\t\t\t\t * Custom elements wont report a document unless is already\n\t\t\t\t * connected. So our stylesheet would end on the main document\n\t\t\t\t * instead of the shadowRoot\n\t\t\t\t */\n\t\t\t\tonFixes(() => {\n\t\t\t\t\tif (isConnected(parent)) {\n\t\t\t\t\t\tconst doc = getDocumentForElement(parent)\n\t\t\t\t\t\taddAdoptedStyleSheet(doc, child)\n\n\t\t\t\t\t\tcleanup(() => removeAdoptedStyleSheet(doc, child))\n\t\t\t\t\t}\n\t\t\t\t})\n\n\t\t\t\treturn undefined\n\t\t\t}\n\n\t\t\t// object.toString fancy objects\n\t\t\treturn createChildren(\n\t\t\t\tparent,\n\t\t\t\t// Object.create(null) would fail to convert to string\n\t\t\t\t'toString' in child ? child.toString() : stringify(child),\n\t\t\t\trelative,\n\t\t\t)\n\t\t}\n\t\tcase 'undefined': {\n\t\t\treturn undefined\n\t\t}\n\t\tdefault: {\n\t\t\t// boolean/bigint/symbol/catch all\n\t\t\t// toString() is needed for `Symbol`\n\t\t\treturn insertNode(\n\t\t\t\tparent,\n\t\t\t\tcreateTextNode(/** @type object */ child.toString()),\n\t\t\t\trelative,\n\t\t\t)\n\t\t}\n\t}\n}\n\npropsPlugin(\n\t'children',\n\t(node, propName, propValue) => {\n\t\tcreateChildren(node, propValue)\n\t},\n\tfalse,\n)\n\n/**\n * Creates placeholder to keep nodes in position\n *\n * @param {Element | DocumentFragment} parent\n * @param {boolean} [relative]\n * @returns {Element} The placeholder element\n */\nconst createPlaceholder = (parent, relative) =>\n\tinsertNode(parent, createTextNode(''), relative)\n\n/**\n * Adds the element to the document\n *\n * @param {Element | DocumentFragment} parent\n * @param {Element} node\n * @param {boolean} [relative]\n * @returns {Element} The inserted node\n */\nfunction insertNode(parent, node, relative) {\n\t// special case `head`\n\tif (parent === head) {\n\t\tconst name = node.tagName\n\n\t\t// search for tags that should be unique\n\t\tlet prev\n\t\tif (name === 'TITLE') {\n\t\t\tprev = querySelector(head, 'title')\n\t\t} else if (name === 'META') {\n\t\t\tprev =\n\t\t\t\tquerySelector(\n\t\t\t\t\thead,\n\t\t\t\t\t'meta[name=\"' + node.getAttribute('name') + '\"]',\n\t\t\t\t) ||\n\t\t\t\tquerySelector(\n\t\t\t\t\thead,\n\t\t\t\t\t'meta[property=\"' + node.getAttribute('property') + '\"]',\n\t\t\t\t)\n\t\t} else if (name === 'LINK' && node.rel === 'canonical') {\n\t\t\tprev = querySelector(head, 'link[rel=\"canonical\"]')\n\t\t}\n\n\t\t// replace old node if there's any\n\t\tprev ? prev.replaceWith(node) : parent.appendChild(node)\n\t} else {\n\t\trelative ? parent.before(node) : parent.appendChild(node)\n\t}\n\n\treturn node\n}\n\n// RENDERING\n\n/**\n * WARNINGS Removal of the element on where you render/insert into,\n * wont cause disposal of what you render/insert.\n */\n\n/**\n * Inserts children into a parent\n *\n * @param {any} children - Thing to render\n * @param {Element | null} [parent] - Mount point, defaults to\n *   document.body\n * @param {{ clear?: boolean; relative?: boolean }} [options] -\n *   Mounting options\n * @returns {() => void} Disposer\n * @url https://pota.quack.uy/render\n */\nexport function render(children, parent, options = nothing) {\n\tconst dispose = root(dispose => {\n\t\tinsert(children, parent, options)\n\t\treturn dispose\n\t})\n\n\t// run dispose when the parent scope disposes\n\tcleanup(dispose)\n\n\treturn dispose\n}\n\n/**\n * @param {any} children - Thing to render\n * @param {Element | null} [parent] - Mount point, defaults to\n *   `document.body`\n * @param {{ clear?: boolean; relative?: boolean }} [options] -\n *   Mounting options\n */\nexport function insert(\n\tchildren,\n\tparent = document.body,\n\toptions = nothing,\n) {\n\tif (options.clear && parent) parent.textContent = ''\n\n\tconst node = createChildren(\n\t\tparent,\n\t\tFactory(isFunction(children) ? children : () => children),\n\t\toptions.relative,\n\t)\n\n\t// @ts-ignore\n\tcleanup(() => toDiff(flatToArray(node)))\n\n\treturn node\n}\n\n/**\n * Creates and returns HTML Elements for `children`\n *\n * @param {Children} children\n * @returns {Children}\n * @url https://pota.quack.uy/toHTML\n */\nexport function toHTML(children) {\n\t/**\n\t * DocumentFragment is transformed to an `Array` of `Node/Element`,\n\t * that way we can keep a reference to the nodes. Because when the\n\t * DocumentFragment is used, it removes the nodes from the\n\t * DocumentFragment and then we will lose the reference.\n\t */\n\n\treturn unwrapArray(toHTMLFragment(children).childNodes)\n}\n\n/**\n * Creates and returns a DocumentFragment for `children`\n *\n * @param {Children} children\n * @returns {DocumentFragment}\n * @url https://pota.quack.uy/toHTML\n */\nexport function toHTMLFragment(children) {\n\tconst fragment = new DocumentFragment()\n\tcreateChildren(fragment, children)\n\n\treturn fragment\n}\n\n/**\n * Creates a context and returns a function to get or set the value\n *\n * @template T\n * @param {T} [defaultValue] - Default value for the context\n * @url https://pota.quack.uy/Reactivity/Context\n */\n/* #__NO_SIDE_EFFECTS__ */ export function context(\n\tdefaultValue = undefined,\n) {\n\tconst ctx = Context(defaultValue)\n\t// @ts-ignore\n\tctx.toHTML = toHTML\n\n\treturn ctx\n}\n\n/**\n * Removes from the DOM `prev` elements not found in `next`\n *\n * @param {Element[]} [prev=[]] - Array with previous elements.\n *   Default is `[]`\n * @param {Element[]} [next=[]] - Array with next elements. Default is\n *   `[]`\n * @param {boolean} [short=false] - Whether to use fast clear. Default\n *   is `false`\n * @returns {Element[]} The next array of elements\n */\nfunction toDiff(prev = [], next = [], short = false) {\n\t// if theres something to remove\n\tif (prev.length) {\n\t\t// fast clear\n\t\tif (\n\t\t\tshort &&\n\t\t\tnext.length === 0 &&\n\t\t\t// + 1 because of the original placeholder\n\t\t\tprev.length + 1 === prev[0].parentNode.childNodes.length\n\t\t) {\n\t\t\tconst parent = prev[0].parentNode\n\t\t\t// save the placeholder\n\t\t\tconst lastChild = parent.lastChild\n\t\t\tparent.textContent = ''\n\t\t\tparent.appendChild(lastChild)\n\t\t} else if (next.length === 0) {\n\t\t\tfor (const item of prev) {\n\t\t\t\titem && item.remove()\n\t\t\t}\n\t\t} else {\n\t\t\tfor (const item of prev) {\n\t\t\t\tif (item && !next.includes(item)) {\n\t\t\t\t\titem.remove()\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\treturn next\n}\n","import { render } from 'pota'\n\nrender(\n\t<div\n\t\tbla={undefined}\n\t\tbla=\"\"\n\t\tbla=\"true\"\n\t\tbla=\"false\"\n\t\tbla={false}\n\t\tbla={true}\n\t\tbla\n\t\tbla={void 0}\n\t\tbla={0}\n\t/>,\n)\n"],"names":["window","globalThis","queueMicrotask","Object","Array","Symbol","assign","freeze","toArray","from","toValues","value","isArray","isObject","values","iterator","stringify","JSON","resolved","promise","onDone","then","catch","call","fns","fn","empty","create","bind","nothing","unwrapArray","arr","length","flatToArray","flat","Infinity","withState","state","cacheStore","withCache","cache","thing","get","getValue","isFunction","isNullUndefined","undefined","isString","isPromise","noop","removeFromArray","array","index","indexOf","splice","walkParents","context","propertyName","cb","DataStore","constructor","kind","store","set","has","del","delete","target","defaults","o","Map","$isComponent","$isClass","$isMap","prefix","NS","__proto__","svg","math","html","xlink","createReactiveSystem","CLEAN","STALE","CHECK","Owner","Listener","Updates","Effects","Time","Root","owner","owned","cleanups","options","addCleanups","push","removeCleanups","addOwned","dispose","disposeOwned","doCleanups","i","Computation","updatedAt","sources","sourceSlots","update","time","prevOwner","prevListener","err","source","observers","observer","slot","pop","observerSlots","queue","Effect","user","batch","SyncEffect","Memo","read","updates","runUpdates","upstream","sourceSlot","observerSlot","write","equals","downstream","a","b","nextValue","Signal","save","prev","root","runWithOwner","signal","initialValue","s","effect","on","depend","untrack","syncEffect","memo","cleanup","cleanupCancel","runTop","node","ancestors","init","wait","res","effects","runEffects","userLength","ignore","Context","defaultValue","id","useContext","newValue","Provider","props","toHTML","children","walk","callback","args","withValue","withPrevValue","val","markComponent","addEvent","type","handler","addEventListener","removeEvent","removeEventListener","ownedEvent","handleEvent","e","document","head","isConnected","DocumentFragment","createElement","createElementNS","createTextNode","importNode","createTreeWalker","addClass","className","classList","add","removeClass","remove","querySelector","query","getDocumentForElement","getRootNode","nodeType","ownerDocument","walkElements","max","nodes","currentNode","nextNode","CSSStyleSheet","sheet","css","replace","getAdoptedStyleSheets","adoptedStyleSheets","addAdoptedStyleSheet","styleSheet","removeAdoptedStyleSheet","added","reset","priority","run","q","onFixes","onProps","onRef","onMount","ready","plugins","pluginsNS","namespaces","Set","updateNamespaces","xmlns","map","ns","join","propsPlugin","propName","onMicrotask","plugin","propsPluginNS","NSName","name","setPropertyNS","localName","setProperty","_setProperty","setEventNS","randomId","crypto","getRandomValues","BigUint64Array","toString","setCSS","setNodeCSS","retrying","setRef","setConnected","setDisconnected","setStyle","setNodeStyle","style","setStyleNS","cssText","setStyleValue","_setStyleValue","removeProperty","setClass","setAttribute","setClassList","setClassNS","setElementClass","_setClassListValue","trim","split","_setAttribute","removeAttributeNS","removeAttribute","setAttributeNS","propNS","assignProp","includes","assignProps","useXMLNS","Factory","createTag","createClass","Element","createNode","createAnything","render","tagName","withXMLNS","nsContext","parseXML","content","template","innerHTML","tlpContent","childNodes","firstChild","append","createPartial","propsData","clone","x","cloneNode","assignPartialProps","m","createChildren","parent","child","relative","Text","nodeValue","textContent","insertNode","createPlaceholder","toDiff","begin","end","Node","setValue","onResult","result","doc","propValue","getAttribute","rel","replaceWith","appendChild","before","insert","body","clear","toHTMLFragment","fragment","ctx","next","short","parentNode","lastChild","item","_div","bla"],"mappings":"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"}