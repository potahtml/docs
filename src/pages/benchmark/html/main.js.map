{"version":3,"file":"main.js","sources":["../../../../../pota/src/patches.js","../../../../../pota/src/lib/std.js","../../../../../pota/src/constants.js","../../../../../pota/src/lib/reactive.js","../../../../../pota/src/scheduler.js","../../../../../pota/src/props/plugin.js","../../../../../pota/src/props/attribute.js","../../../../../pota/src/props/property.js","../../../../../pota/src/props/unknown.js","../../../../../pota/src/props/bool.js","../../../../../pota/src/props/style.js","../../../../../pota/src/props/class.js","../../../../../pota/src/props/event.js","../../../../../pota/src/props/value.js","../../../../../pota/src/plugin/useRandom.js","../../../../../pota/src/props/css.js","../../../../../pota/src/props/lifecycle.js","../../../../../pota/src/props/@main.js","../../../../../pota/src/renderer.js","../../../../../pota/src/web/CustomElement.js","../../../../../pota/src/web/Collapse.js","../../../../../pota/src/web/Dynamic.js","../../../../../pota/src/web/For.js","../../../../../pota/src/web/Portal.js","../../../../../pota/src/web/Head.js","../../../../../pota/src/web/Range.js","../../../../../pota/src/plugin/useScroll.js","../../../../../pota/src/plugin/useURL.js","../../../../../pota/src/web/router/context.js","../../../../../pota/src/plugin/useLocation.js","../../../../../pota/src/web/Show.js","../../../../../pota/src/web/router/scroll.js","../../../../../pota/src/web/router/router.js","../../../../../pota/src/web/router/link.js","../../../../../pota/src/web/Switch.js","../../../../../pota/src/html.js","../../../../../pota/src/plugin/useSelector.js","../../../../../pota/src/plugin/useTime.js","index.jsx"],"sourcesContent":["// isCustomElement\n\nconst ce = customElements\nconst define = ce.define.bind(ce)\nce.define = (name, constructor, options) => {\n\tconstructor.prototype.isCustomElement = true\n\tdefine(name, constructor, options)\n}\n","export const global = globalThis\nexport const window = global\n\nexport const CSSStyleSheet = global.CSSStyleSheet\nexport const document = global.document\nexport const DocumentFragment = global.DocumentFragment\nexport const Object = global.Object\nexport const Promise = global.Promise\nexport const requestAnimationFrame = global.requestAnimationFrame\nexport const Symbol = global.Symbol\nexport const queueMicrotask = global.queueMicrotask\n\nexport const assign = Object.assign\nexport const create = Object.create\nexport const defineProperties = Object.defineProperties\nexport const defineProperty = Object.defineProperty\nexport const entries = Object.entries\nexport const freeze = Object.freeze\nexport const fromEntries = Object.fromEntries\nexport const getOwnPropertyDescriptor =\n\tObject.getOwnPropertyDescriptor\nexport const getOwnPropertyDescriptors =\n\tObject.getOwnPropertyDescriptors\nexport const getOwnPropertyNames = Object.getOwnPropertyNames\nexport const getOwnPropertySymbols = Object.getOwnPropertySymbols\nexport const getPrototypeOf = Object.getPrototypeOf\nexport const groupBy = Object.groupBy\nexport const hasOwnProperty = Object.hasOwn\nexport const is = Object.is\nexport const isExtensible = Object.isExtensible\nexport const keys = Object.keys\nexport const values = Object.values\nexport const setPrototypeOf = Object.setPrototypeOf\n\nexport const isArray = Array.isArray\nexport const toArray = Array.from\n\nexport const isNaN = Number.isNaN\n\nexport const iterator = Symbol.iterator\n\nexport const stringify = JSON.stringify\nexport const stringifyReadable = o => stringify(o, null, 2)\n\nexport const stringifySorted = o => {\n\tfunction sort(o) {\n\t\tif (!isObject(o)) {\n\t\t\treturn o\n\t\t}\n\t\tconst tmp = isArray(o) ? [] : {}\n\t\tkeys(o)\n\t\t\t.sort()\n\t\t\t.map(k => (tmp[k] = sort(o[k])))\n\n\t\tif (isArray(tmp)) {\n\t\t\ttmp.sort((a, b) => stringify(a).localeCompare(stringify(b)))\n\t\t}\n\t\treturn tmp\n\t}\n\treturn stringifyReadable(sort(o))\n}\n\nexport const PrototypeArray = Array.prototype\nexport const PrototypeMap = Map.prototype\n\nexport const history = global.history\nexport const location = global.location\nexport const navigator = global.navigator\n\nexport const origin = location?.origin\n\nexport const promise = fn => new Promise(fn)\n\nexport const withResolvers = () => Promise.withResolvers()\n\n/**\n * Given a promise it adds `onDone` to `then` and `catch`\n *\n * ```js\n * resolved(promise, onDone)\n * // is same as\n * promise.then(onDone).catch(onDone)\n * ```\n */\nexport const resolved = (promise, onDone) =>\n\tpromise.then(onDone).catch(onDone)\n\nexport const setAttribute = (node, name, value) =>\n\tnode.setAttribute(name, value)\n\nexport const hasAttribute = (node, name) => node.hasAttribute(name)\n\nexport const removeAttribute = (node, name) =>\n\tnode.removeAttribute(name)\n\nexport const setAttributeNS = (node, name, value) =>\n\tnode.setAttributeNS(name, value)\n\nexport const hasAttributeNS = (node, name) =>\n\tnode.hasAttributeNS(name)\n\nexport const removeAttributeNS = (node, name) =>\n\tnode.removeAttributeNS(name)\n\nexport const isConnected = node => node.isConnected\n\nexport const activeElement = () => document.activeElement\n\nexport const documentElement = document?.documentElement\n\n/**\n * Runs an array of functions\n *\n * @param {Iterable<Function>} fns\n */\nexport const call = fns => {\n\tfor (const fn of fns) fn()\n}\n\nexport function copy(o) {\n\tconst seen = new Map()\n\tfunction copy(o) {\n\t\tif (!isObject(o)) {\n\t\t\treturn o\n\t\t}\n\n\t\tif (\n\t\t\to instanceof Node ||\n\t\t\to instanceof Date ||\n\t\t\to instanceof Set ||\n\t\t\to instanceof Map ||\n\t\t\to instanceof WeakSet ||\n\t\t\to instanceof WeakMap ||\n\t\t\to instanceof Promise ||\n\t\t\to instanceof RegExp\n\t\t) {\n\t\t\treturn o\n\t\t}\n\n\t\tif (seen.has(o)) {\n\t\t\treturn seen.get(o)\n\t\t}\n\n\t\tconst c = isArray(o) ? [] : {}\n\n\t\tseen.set(o, c)\n\n\t\tfor (const k in o) {\n\t\t\tc[k] = copy(o[k])\n\t\t}\n\t\treturn c\n\t}\n\treturn copy(o)\n}\n\n/**\n * Object.defineProperty with `enumerable` and `configurable` set to\n * `true` unless overwriten by `descriptor` argument\n *\n * @template T\n * @param {T} target\n * @param {PropertyKey} key\n * @param {PropertyDescriptor} descriptor\n */\nexport const redefineProperty = (target, key, descriptor) =>\n\tdefineProperty(\n\t\ttarget,\n\t\tkey,\n\t\tassign(create(redefinePropertyDefailts), descriptor),\n\t)\n\nconst redefinePropertyDefailts = {\n\t__proto__: null,\n\tconfigurable: true,\n\tenumerable: true,\n}\n\n/**\n * Object.defineProperty with `configurable`, `writable` and\n * `enumerable` as `false`\n *\n * @template T\n * @param {T} target\n * @param {PropertyKey} key\n * @param {any} value\n */\nexport const definePropertyReadOnly = (target, key, value) => {\n\tconst descriptor = create(definePropertyReadOnlyDefaults)\n\tdescriptor.value = value\n\tdefineProperty(target, key, descriptor)\n}\n\nconst definePropertyReadOnlyDefaults = {\n\t__proto__: null,\n\tconfigurable: false,\n\tenumerable: false,\n\twritable: false,\n\tvalue: undefined,\n}\n\nconst bind = /* #__NO_SIDE_EFFECTS__ */ fn =>\n\tdocument && document[fn].bind(document)\n\nexport const createElement = bind('createElement')\nexport const createElementNS = bind('createElementNS')\nexport const createTextNode = bind('createTextNode')\nexport const createComment = bind('createComment')\n\nexport const importNode = bind('importNode')\n\nexport const createTreeWalker = bind('createTreeWalker')\n\n/**\n * Returns an object without a prototype\n *\n * @type {Function}\n * @returns {Props} Empty object\n */\nexport const empty = Object.create.bind(null, null)\n\n/**\n * An empty frozen array\n *\n * @type {readonly []}\n */\nexport const emptyArray = freeze([])\n\n/**\n * An empty frozen object\n *\n * @type object\n */\nexport const nothing = freeze(empty())\n\nexport function* entriesIncludingSymbols(target) {\n\tfor (const item of entries(target)) {\n\t\tyield item\n\t}\n\n\tfor (const item of getOwnPropertySymbols(target)) {\n\t\t// todo: causes access!\n\t\tyield [item, target[item]]\n\t}\n}\n\n// modified version of https://github.com/epoberezkin/fast-deep-equal\n\nexport function equals(a, b) {\n\tif (a === b) {\n\t\treturn true\n\t}\n\n\tif (a && b && typeof a == 'object' && typeof b == 'object') {\n\t\tif (a.constructor !== b.constructor) {\n\t\t\treturn false\n\t\t}\n\n\t\tlet length, i, k\n\t\tif (isArray(a)) {\n\t\t\tlength = a.length\n\t\t\tif (length != b.length) {\n\t\t\t\treturn false\n\t\t\t}\n\t\t\tfor (i = length; i-- !== 0; ) {\n\t\t\t\tif (!equals(a[i], b[i])) {\n\t\t\t\t\treturn false\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn true\n\t\t}\n\n\t\tif (a.constructor === RegExp)\n\t\t\treturn a.source === b.source && a.flags === b.flags\n\t\tif (a.valueOf !== Object.prototype.valueOf)\n\t\t\treturn a.valueOf() === b.valueOf()\n\t\tif (a.toString !== Object.prototype.toString)\n\t\t\treturn a.toString() === b.toString()\n\n\t\tk = keys(a)\n\t\tlength = k.length\n\t\tif (length !== keys(b).length) {\n\t\t\treturn false\n\t\t}\n\n\t\tfor (i = length; i-- !== 0; ) {\n\t\t\tif (!Object.prototype.hasOwnProperty.call(b, k[i])) {\n\t\t\t\treturn false\n\t\t\t}\n\t\t}\n\n\t\tfor (i = length; i-- !== 0; ) {\n\t\t\tvar key = k[i]\n\n\t\t\tif (!equals(a[key], b[key])) {\n\t\t\t\treturn false\n\t\t\t}\n\t\t}\n\n\t\treturn true\n\t}\n\n\t// true if both NaN, false otherwise\n\treturn a !== a && b !== b\n}\n\n/**\n * Flats an array/childNodes to the first children if the length is 1\n *\n * @param {any[] | NodeListOf<ChildNode>} arr\n * @returns {any}\n */\nexport const flat = arr => (arr.length === 1 ? arr[0] : arr)\n\n/**\n * Keeps state in the function as the first param\n *\n * @template T\n * @param {T} fn - Function to which add state to it\n * @param {DataStore<Map> | DataStore<WeakMap>} [state] - Passed to\n *   `fn` as first param\n * @returns {T} A copy of the function with the state\n */\nexport const withState = /* #__NO_SIDE_EFFECTS__ */ (\n\tfn,\n\tstate = cacheStore,\n) => fn.bind(null, state())\n\n/** Memoize functions with a map cache */\nexport const withCache = fn =>\n\twithState(\n\t\t(cache, thing) => cache.get(thing, thing => fn(thing)),\n\t\tcacheStore,\n\t)\n/** Memoize functions with a weak cache */\nexport const withWeakCache = fn =>\n\twithState(\n\t\t(cache, thing) => cache.get(thing, thing => fn(thing)),\n\t\tweakStore,\n\t)\n\nexport const walkElements = function (\n\twalk,\n\tnode,\n\tmax = Infinity,\n\tnodes = [],\n) {\n\t/**\n\t * The first node is not walked by the walker.\n\t *\n\t * Also the first node could be a DocumentFragment\n\t */\n\tnode.nodeType === 1 && nodes.push(node)\n\n\twalk.currentNode = node\n\n\twhile (nodes.length !== max && (node = walk.nextNode())) {\n\t\tnodes.push(node)\n\t}\n\treturn nodes\n}.bind(\n\tnull,\n\tcreateTreeWalker &&\n\t\tcreateTreeWalker(document, 1 /*NodeFilter.SHOW_ELEMENT*/),\n)\n\n/**\n * Returns `document` for element. That could be a `shadowRoot`\n *\n * @param {Element} node\n * @returns {Document | ShadowRoot}\n */\n\nexport const getDocumentForElement = node => {\n\tconst document = node.getRootNode()\n\tconst { nodeType } = document\n\t// getRootNode returns:\n\t// 1. Node for isConnected = false\n\t// 2. Document for isConnected = true\n\t// 3. shadowRoot for custom elements\n\n\t// always return a Document-like\n\treturn nodeType === 11 || nodeType === 9\n\t\t? document\n\t\t: node.ownerDocument\n}\n\nexport const getOwnValues = o =>\n\tgetOwnPropertyNames(o).map(key => {\n\t\ttry {\n\t\t\treturn o[key]\n\t\t} catch (e) {}\n\t})\n\nexport function getSetterNamesFromPrototype(object, set = new Set()) {\n\tconst descriptors = getOwnPropertyDescriptors(object)\n\n\tfor (const key in descriptors) {\n\t\tif (descriptors[key].set) {\n\t\t\tset.add(key)\n\t\t}\n\t}\n\n\treturn set\n}\n\n/**\n * Unwraps values. If the argument is a function then it runs it\n * recursively and returns the value\n *\n * @template T\n * @param {MaybeAccessor<T>} value - Maybe function\n */\nexport function getValue(value) {\n\twhile (typeof value === 'function') value = value()\n\treturn value\n}\n\n/**\n * Unwraps `value` and returns `element` if result is a `Node`, else\n * `undefined` in the case isn't a `Node`\n *\n * @param {Function | any} value - Maybe function\n * @param {...any} args? - Arguments\n * @returns {Node | undefined}\n */\nexport function getValueElement(value, ...args) {\n\tconst element = getValueWithArguments(value, ...args)\n\treturn element instanceof Node ? element : undefined\n}\n\nexport const getValueWithArguments = (value, ...args) =>\n\ttypeof value === 'function'\n\t\t? args.length\n\t\t\t? getValue(value(...args))\n\t\t\t: getValue(value())\n\t\t: value\n\n/**\n * Identity function, given `x` returns `x`\n *\n * @template T\n * @param {T} x\n * @returns {T}\n */\nexport const identity = x => x\n\n/**\n * When `value` is an object, it will check if the `key` on `target`\n * is `configurable`\n *\n * @param {object} target\n * @param {PropertyKey} key\n * @param {boolean | undefined} value\n */\nexport const isConfigurable = (target, key, value) => {\n\tif (isObject(value)) {\n\t\tconst descriptor = getOwnPropertyDescriptor(target, key)\n\t\tif (descriptor) {\n\t\t\treturn descriptor.configurable\n\t\t}\n\t}\n\treturn true\n}\n\n/**\n * Returns `true` when `typeof` of `value` is `function`\n *\n * @param {any} value\n * @returns {boolean}\n */\nexport const isFunction = value => typeof value === 'function'\n\n/**\n * Returns `true` when value is Iterable\n *\n * @param {any} value\n * @returns {boolean}\n */\nexport const isIterable = value => value?.[Symbol.iterator]\n\n/**\n * Returns `true` if the value is `null` or `undefined`\n *\n * @param {any} value\n * @returns {boolean}\n */\nexport const isNullUndefined = value =>\n\tvalue === undefined || value === null\n\n/**\n * Returns `true` when typeof of value is object and not null\n *\n * @param {any} value\n * @returns {boolean}\n */\nexport const isObject = value =>\n\tvalue !== null && typeof value === 'object'\n\n/**\n * Returns `true` when object morphed between array/object\n *\n * @param {any} a\n * @param {any} b\n * @returns {boolean}\n */\nexport const morphedBetweenArrayAndObject = (a, b) =>\n\t(isObject(a) && !isObject(b)) ||\n\t(isObject(b) && !isObject(a)) ||\n\t(isArray(a) && !isArray(b)) ||\n\t(isArray(b) && !isArray(a))\n\n/**\n * Returns `true` if the property is defined in the `prototype` and\n * absent in the `object`\n *\n * @param {object} target\n * @param {PropertyKey} key\n */\nexport const isPrototypeProperty = (target, key) =>\n\t// must do `key in target` to check that it DOES have it somewhere\n\t// must do !hasOwnProperty to check that isnt an own property\n\tkey in target && !hasOwnProperty(target, key)\n\n/**\n * Returns `true` when `typeof` of `value` is `string`\n *\n * @param {any} value\n * @returns {boolean}\n */\nexport const isString = value => typeof value === 'string'\n\n/**\n * Returns `true` when `typeof` of `value` is `number`\n *\n * @param {any} value\n * @returns {boolean}\n */\nexport const isNumber = value => typeof value === 'number'\n\n/**\n * Returns `true` when `typeof` of `value` is `symbol`\n *\n * @param {any} value\n * @returns {boolean}\n */\nexport const isSymbol = value => typeof value === 'symbol'\n\n/**\n * Returns `true` when `typeof` of `value` is `boolean`\n *\n * @param {any} value\n * @returns {boolean}\n */\nexport const isBoolean = value => typeof value === 'boolean'\n\n/**\n * Returns `true` when `value` may be a promise\n *\n * @param {any} value\n * @returns {boolean}\n */\nexport const isPromise = value => isFunction(value?.then)\n\nexport const noop = () => {}\n\n// an optional value is `true` by default, so most of the time is undefined which means is `true`\n// to avoid having conditions like `if(something.bla === undefined || something.bla)`\n// this function will short it to `if(optional(something.bla))`\n// additionally the value is resolved, for cases like `when={() => show() && optional(props.when)}`\n\n/**\n * Returns `true` when value is true or undefined\n *\n * @param {Function | boolean | undefined} value\n * @returns {boolean} True when value is true or undefined\n */\nexport const optional = value =>\n\tvalue === undefined || getValue(value)\n\nexport const partAdd = (node, className) => node.part.add(className)\n\nexport const partRemove = (node, className) =>\n\tnode.part.remove(className)\n\nexport const querySelector = (node, query) =>\n\tnode.querySelector(query)\n\nexport const querySelectorAll = (node, query) =>\n\tnode.querySelectorAll(query)\n\nexport function* range(start, stop, step = 1) {\n\tif (step < 0) step = Math.abs(step)\n\tyield start\n\tif (start < stop) {\n\t\twhile (start < stop) {\n\t\t\tyield (start += step)\n\t\t}\n\t} else {\n\t\twhile (start > stop) {\n\t\t\tyield (start -= step)\n\t\t}\n\t}\n}\n\nexport const {\n\townKeys: reflectOwnKeys,\n\thas: reflectHas,\n\tdeleteProperty: reflectDeleteProperty,\n\tgetOwnPropertyDescriptor: reflectGetOwnPropertyDescriptor,\n\tget: reflectGet,\n\tapply: reflectApply,\n\tset: reflectSet,\n} = Reflect\n\n/**\n * Removes a value from an array\n *\n * @template T\n * @param {T[]} array\n * @param {T} value To remove from the array\n */\nexport function removeFromArray(array, value) {\n\tconst index = array.indexOf(value)\n\tif (index !== -1) array.splice(index, 1)\n}\n/**\n * Removes values from an array based on a condition\n *\n * @template T\n * @param {T[]} array\n * @param {(value: T, index: number) => boolean} cb Function with\n *   condition\n */\nexport function removeFromArrayConditionally(array, cb) {\n\tlet i = array.length\n\twhile (i--) {\n\t\tif (cb(array[i], i)) {\n\t\t\tarray.splice(i, 1)\n\t\t}\n\t}\n}\n/**\n * Removes values from an array based on a condition\n *\n * @param {Iterable<object | any[]>} iterable\n * @param {PropertyKey} key Function with condition\n */\nexport function indexByKey(iterable, key) {\n\tconst byKey = empty()\n\tfor (const item of iterable) {\n\t\tbyKey[item[key]] = item\n\t}\n\treturn byKey\n}\n\n/**\n * Replace a prototype in the prototype chain with another prototype\n *\n * @param {object} target - Target object\n * @param {object} search - The prototype to replace\n * @param {object} replacement - The replacement prototype\n */\nexport function replacePrototypeWith(target, search, replacement) {\n\tlet prototype = target\n\twhile (getPrototypeOf(prototype) !== search) {\n\t\tprototype = getPrototypeOf(prototype)\n\t}\n\n\tsetPrototypeOf(prototype, replacement)\n}\n\nexport const typeString = obj =>\n\tObject.prototype.toString.call(obj).slice(8, -1)\n\nexport function walkParents(context, propertyName, cb) {\n\twhile (context) {\n\t\tif (cb(context)) return true\n\t\tcontext = context[propertyName]\n\t}\n}\n\nclass DataStore {\n\t/** @param {WeakMap | Map} kind */\n\tconstructor(kind) {\n\t\tconst store = new kind()\n\n\t\tconst get = store.get.bind(store)\n\t\tconst set = store.set.bind(store)\n\t\tconst has = store.has.bind(store)\n\t\tconst del = store.delete.bind(store)\n\n\t\tthis.set = set\n\t\tthis.has = has\n\t\tthis.delete = del\n\n\t\tthis.get = (target, defaults = null) => {\n\t\t\tconst o = get(target)\n\n\t\t\tif (defaults !== null && o === undefined) {\n\t\t\t\t/**\n\t\t\t\t * Default values should be passed as a function, so we dont\n\t\t\t\t * constantly initialize values when giving them\n\t\t\t\t */\n\t\t\t\tdefaults = defaults(target)\n\t\t\t\tset(target, defaults)\n\t\t\t\treturn defaults\n\t\t\t}\n\t\t\treturn o\n\t\t}\n\t}\n\n\t*[Symbol.iterator]() {\n\t\tyield this.get\n\t\tyield this.set\n\t\tyield this.has\n\t\tyield this.delete\n\t}\n}\n\n/**\n * Store template\n *\n * @typedef {(\n * \treference: any,\n * \tcreateIfNotExistsAs?: ((target: any) => any) | Function,\n * ) => any} DataStoreGet\n *\n *\n * @typedef {(key: any, value: any) => void} DataStoreSet\n *\n * @typedef {(key: any) => boolean} DataStoreHas\n *\n * @typedef {(key: any) => boolean} DataStoreDelete\n *\n * @typedef {[\n * \tDataStoreGet,\n * \tDataStoreSet,\n * \tDataStoreHas,\n * \tDataStoreDelete,\n * ] & {\n * \tget: DataStoreGet\n * \tset: DataStoreSet\n * \thas: DataStoreHas\n * \tdelete: DataStoreDelete\n * }} DataStoreT\n */\n\n/**\n * Creates a WeakMap to store data\n *\n * @returns {DataStoreT}\n */\nexport const weakStore = () => new DataStore(WeakMap)\n\n/**\n * Creates a Map to store data\n *\n * @returns {DataStoreT}\n */\nexport const cacheStore = () => new DataStore(Map)\n\nexport const classListAdd = (node, className) =>\n\tnode.classList.add(className)\n\nexport const classListRemove = (node, className) =>\n\tnode.classList.remove(className)\n\n/**\n * - Returns `adoptedStyleSheets` for a document\n *\n * @param {Document | ShadowRoot} document\n */\nexport const adoptedStyleSheetsGet = document =>\n\tdocument?.adoptedStyleSheets\n\nexport const adoptedStyleSheets =\n\t/* #__PURE__*/ adoptedStyleSheetsGet(document)\n\n/**\n * Adds a style sheet to the document\n *\n * @param {Document | ShadowRoot} document\n * @param {CSSStyleSheet} styleSheet\n */\nexport const adoptedStyleSheetsAdd = (document, styleSheet) =>\n\tadoptedStyleSheetsGet(document).push(styleSheet)\n\n/**\n * Removes a style sheet from the document\n *\n * @param {Document | ShadowRoot} document\n * @param {CSSStyleSheet} styleSheet\n */\nexport const adoptedStyleSheetsRemove = (document, styleSheet) =>\n\tremoveFromArray(adoptedStyleSheetsGet(document), styleSheet)\n\n/**\n * Adds a style sheet to the custom element\n *\n * @param {Document | ShadowRoot} document\n * @param {(CSSStyleSheet | string)[]} styleSheets\n */\nexport function addStyleSheets(document, styleSheets = []) {\n\tfor (const sheet of styleSheets) {\n\t\tif (sheet) {\n\t\t\tsheet instanceof CSSStyleSheet\n\t\t\t\t? adoptedStyleSheetsAdd(document, sheet)\n\t\t\t\t: addStyleSheetExternal(document, sheet)\n\t\t}\n\t}\n}\n\n/**\n * Adds the stylesheet from urls. It uses a cache, to avoid having to\n * fire a request for each external sheet when used in more than one\n * custom element. Also, all reference the same object.\n *\n * @param {Document | ShadowRoot} document\n * @param {string} text\n */\nexport const addStyleSheetExternal = withState(\n\t(state, document, text) => {\n\t\tstate\n\t\t\t.get(text, text =>\n\t\t\t\ttext.startsWith('http')\n\t\t\t\t\t? fetch(text)\n\t\t\t\t\t\t\t.then(r => r.text())\n\t\t\t\t\t\t\t.then(css => sheet(css))\n\t\t\t\t\t: promise(resolve => resolve(sheet(text))),\n\t\t\t)\n\t\t\t.then(styleSheet => adoptedStyleSheetsAdd(document, styleSheet))\n\t},\n)\n\n/**\n * Swaps classNames and waits for the animation to end\n *\n * @param {Element} element\n * @param {string} oldClass - `class` with the old animation\n * @param {string} newClass - `class` with the new animation\n */\nexport const animateClassTo = (element, oldClass, newClass) =>\n\tpromise(resolve =>\n\t\trequestAnimationFrame(() => {\n\t\t\tclassListRemove(element, oldClass)\n\t\t\tclassListAdd(element, newClass)\n\t\t\telement.getAnimations().length\n\t\t\t\t? resolved(waitEvent(element, 'animationend'), resolve)\n\t\t\t\t: resolve()\n\t\t}),\n\t)\n\n/**\n * Swaps parts and waits for the animation to end\n *\n * @param {Element} element\n * @param {string} oldPart - `part` with the old animation\n * @param {string} newPart - `part` with the new animation\n */\nexport const animatePartTo = (element, oldPart, newPart) =>\n\tpromise(resolve =>\n\t\trequestAnimationFrame(() => {\n\t\t\tpartRemove(element, oldPart)\n\t\t\tpartAdd(element, newPart)\n\t\t\telement.getAnimations().length\n\t\t\t\t? resolved(waitEvent(element, 'animationend'), resolve)\n\t\t\t\t: resolve()\n\t\t}),\n\t)\n\n/**\n * Creates tagged css and returns a CSSStyleSheet. Mostly for css\n * highlighting in js\n *\n * @param {TemplateStringsArray} template\n * @param {...any} values\n * @returns {CSSStyleSheet}\n */\nexport const css = (template, ...values) =>\n\tsheet(String.raw({ raw: template }, ...values))\n\n/**\n * Creates a stylesheet from a css string\n *\n * @param {string} css\n * @returns {CSSStyleSheet}\n */\nexport const sheet = withCache(css => {\n\tconst sheet = new CSSStyleSheet()\n\t/**\n\t * Replace is asynchronous and can accept `@import` statements\n\t * referencing external resources.\n\t */\n\tsheet.replace(css)\n\n\treturn sheet\n})\n\n/**\n * @param {Element} node\n * @param {string} eventName\n * @param {any} [data]\n */\n\nexport const emit = (\n\tnode,\n\teventName,\n\tdata = { bubbles: true, cancelable: true, composed: true },\n) => node.dispatchEvent(new CustomEvent(eventName, data))\n\nexport function stopEvent(e) {\n\tpreventDefault(e)\n\tstopPropagation(e)\n\tstopImmediatePropagation(e)\n}\n\nexport const preventDefault = e => e.preventDefault()\nexport const stopPropagation = e => e.stopPropagation()\nexport const stopImmediatePropagation = e =>\n\te.stopImmediatePropagation()\n\n/**\n * Waits for an event to be dispatched and runs a callback\n *\n * @param {Element} element\n * @param {string} eventName\n */\nexport const waitEvent = withState(\n\t(state, element, eventName) =>\n\t\tpromise((resolve, reject) => {\n\t\t\t/**\n\t\t\t * To prevent firing `transitionend` twice it needs to stop\n\t\t\t * listening the old one because maybe wasn't dispatched and\n\t\t\t * running a new transition will make it dispatch twice\n\t\t\t */\n\t\t\tconst previous = state.get(element, empty)\n\t\t\tprevious.reject && previous.reject()\n\t\t\telement.removeEventListener(eventName, previous.resolve)\n\t\t\tstate.set(element, { resolve, reject })\n\t\t\telement.addEventListener(eventName, resolve, {\n\t\t\t\tonce: true,\n\t\t\t})\n\t\t}),\n\tweakStore,\n)\n\nexport const addEventNative = (where, type, handler) =>\n\twhere.addEventListener(type, handler, handler)\n\nexport const removeEventNative = (where, type, handler) =>\n\twhere.removeEventListener(type, handler, handler)\n\n/** @param {EventListener} fn */\nexport const passiveEvent = fn => ({ handleEvent: fn, passive: true })\n\nexport const warn = (...args) => console.warn(...args)\nexport const error = (...args) => console.error(...args)\n","// symbols\n\nimport { Symbol } from './lib/std.js'\n\nexport const $isComponent = Symbol()\nexport const $isClass = Symbol()\nexport const $isReactive = Symbol()\nexport const $isMap = Symbol()\n\n// supported namespaces\n\nconst prefix = 'http://www.w3.org/'\n\n// when a tag/attribute is missing the namespace this puts it back in\n\nexport const NS = {\n\t__proto__: null,\n\tsvg: prefix + '2000/svg',\n\tmath: prefix + '1998/Math/MathML',\n\thtml: prefix + '1999/xhtml',\n\txlink: prefix + '1999/xlink',\n}\n","/**\n * This is so far the core of Solid JS Reactivity, this may change.\n *\n * Adaptation for potas needs have been made:\n *\n * - Ported to Classes what does fit\n * - Signal has more options: `label` and `save` previous value\n * - Writing to a signal returns `true` when the value changes\n * - Signal is an object that could be used as signal.read/write or\n *   destructured as an array.\n * - Signals can save and wont run functions\n * - `update` function on Signal that could be used to use the old value\n */\n\nimport {\n\t$isClass,\n\t$isComponent,\n\t$isMap,\n\t$isReactive,\n} from '../constants.js'\n\nimport {\n\tassign,\n\temptyArray,\n\tentries,\n\tflat,\n\tgetValue,\n\tgroupBy,\n\tisArray,\n\tisFunction,\n\tisIterable,\n\tisObject,\n\tisPromise,\n\tkeys,\n\tnoop,\n\tnothing,\n\tqueueMicrotask,\n\tremoveFromArray,\n\tresolved,\n\tSymbol,\n\twithResolvers,\n} from './std.js'\n\n/** SORRY TYPES KIND OF MESSY AROUND HERE, IM BUSY WITH SOMEHTING ELSE */\n\n/**\n * Returns true when value is reactive (a signal)\n *\n * @param {any} value\n * @returns {boolean}\n */\nexport const isReactive = value =>\n\tisFunction(value) && $isReactive in value\n\n/**\n * Marks a function as reactive. Reactive functions are ran inside\n * effects.\n *\n * @param {Function} fn - Function to mark as reactive\n * @returns {Function}\n */\nexport function markReactive(fn) {\n\tfn[$isReactive] = undefined\n\treturn fn\n}\n\nconst CLEAN = 0\nconst STALE = 1\nconst CHECK = 2\n\n/** @type {Computation} */\nlet Owner\n/** @type {Computation} */\nlet Listener\n\n/** @type {undefined | null | any[]} */\n\nlet Updates = null\n/** @type {undefined | null | any[]} */\n\nlet Effects = null\n\nlet Time = 0\n\n// ROOT\n\nclass Root {\n\t/** @type {Root | undefined} */\n\towner\n\n\t/** @type {Root | Root[] | null | undefined} */\n\towned\n\n\t/** @type {Function | Function[] | null | undefined} */\n\tcleanups\n\n\t/** @type {any} */\n\tcontext\n\n\t/**\n\t * @param {undefined | Root} owner\n\t * @param {object} [options]\n\t */\n\tconstructor(owner, options) {\n\t\tif (owner) {\n\t\t\tthis.owner = owner\n\n\t\t\tif (owner.context) {\n\t\t\t\tthis.context = owner.context\n\t\t\t}\n\t\t}\n\n\t\toptions && assign(this, options)\n\t}\n\t/** @param {Function} fn */\n\taddCleanups(fn) {\n\t\tif (!this.cleanups) {\n\t\t\tthis.cleanups = fn\n\t\t} else if (isArray(this.cleanups)) {\n\t\t\tthis.cleanups.push(fn)\n\t\t} else {\n\t\t\tthis.cleanups = [this.cleanups, fn]\n\t\t}\n\t}\n\t/** @param {Root} value */\n\taddOwned(value) {\n\t\tif (!this.owned) {\n\t\t\tthis.owned = value\n\t\t} else if (isArray(this.owned)) {\n\t\t\tthis.owned.push(value)\n\t\t} else {\n\t\t\tthis.owned = [this.owned, value]\n\t\t}\n\t}\n\n\tdispose() {\n\t\tthis.disposeOwned()\n\t\tthis.doCleanups()\n\t}\n\n\tdisposeOwned() {\n\t\tif (!this.owned) {\n\t\t} else if (isArray(this.owned)) {\n\t\t\tfor (let i = this.owned.length - 1; i >= 0; i--) {\n\t\t\t\tthis.owned[i].dispose()\n\t\t\t}\n\t\t\tthis.owned = null\n\t\t} else {\n\t\t\tthis.owned.dispose()\n\t\t\tthis.owned = null\n\t\t}\n\t}\n\n\tdoCleanups() {\n\t\tif (!this.cleanups) {\n\t\t} else if (isArray(this.cleanups)) {\n\t\t\tfor (let i = this.cleanups.length - 1; i >= 0; i--) {\n\t\t\t\tthis.cleanups[i]()\n\t\t\t}\n\t\t\tthis.cleanups = null\n\t\t} else {\n\t\t\tthis.cleanups()\n\t\t\tthis.cleanups = null\n\t\t}\n\t}\n}\n\n// COMPUTATION\n\nclass Computation extends Root {\n\tstate = STALE\n\n\tupdatedAt = 0\n\n\t/** @type {Function | undefined} */\n\tfn\n\n\tsources\n\tsourceSlots\n\n\t/**\n\t * @param {Root} [owner]\n\t * @param {Function} [fn]\n\t * @param {object} [options]\n\t */\n\tconstructor(owner, fn, options) {\n\t\tsuper(owner, options)\n\n\t\tthis.fn = fn\n\n\t\towner && owner.addOwned(this)\n\t}\n\n\tupdate() {\n\t\tthis.dispose()\n\n\t\tconst time = Time\n\n\t\tconst prevOwner = Owner\n\t\tconst prevListener = Listener\n\n\t\tListener = Owner = this\n\t\ttry {\n\t\t\tthis.fn()\n\t\t} catch (err) {\n\t\t\tthis.updatedAt = time + 1\n\n\t\t\tthrow err\n\t\t} finally {\n\t\t\tOwner = prevOwner\n\t\t\tListener = prevListener\n\t\t}\n\n\t\tif (this.updatedAt < time) {\n\t\t\tthis.updatedAt = time\n\t\t}\n\t}\n\n\tdispose() {\n\t\tconst { sources, sourceSlots } = this\n\n\t\tif (sources && sources.length) {\n\t\t\tlet source\n\t\t\tlet observers\n\t\t\tlet index\n\n\t\t\tlet observer\n\t\t\tlet slot\n\t\t\twhile (sources.length) {\n\t\t\t\tsource = sources.pop()\n\t\t\t\tobservers = source.observers\n\n\t\t\t\tindex = sourceSlots.pop()\n\n\t\t\t\tif (observers && observers.length) {\n\t\t\t\t\tobserver = observers.pop()\n\t\t\t\t\tslot = source.observerSlots.pop()\n\n\t\t\t\t\tif (index < observers.length) {\n\t\t\t\t\t\tobserver.sourceSlots[slot] = index\n\t\t\t\t\t\tobservers[index] = observer\n\t\t\t\t\t\tsource.observerSlots[index] = slot\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tsuper.dispose()\n\n\t\tthis.state = CLEAN\n\t}\n\tqueue() {\n\t\tEffects.push(this)\n\t}\n}\n\nclass Effect extends Computation {\n\tuser = true\n\n\t/**\n\t * @param {Root} [owner]\n\t * @param {Function} [fn]\n\t * @param {object} [options]\n\t */\n\tconstructor(owner, fn, options) {\n\t\tsuper(owner, fn, options)\n\n\t\tEffects ? Effects.push(this) : batch(() => this.update())\n\t}\n}\n\nclass SyncEffect extends Computation {\n\t/**\n\t * @param {Root} [owner]\n\t * @param {Function} [fn]\n\t * @param {object} [options]\n\t */\n\tconstructor(owner, fn, options) {\n\t\tsuper(owner, fn, options)\n\n\t\tbatch(() => this.update())\n\t}\n}\n\n// SIGNALS\n\nclass Memo extends Computation {\n\tvalue\n\n\tobservers\n\tobserverSlots\n\n\t// options:\n\t// equals\n\t/**\n\t * @param {Root} [owner]\n\t * @param {Function} [fn]\n\t * @param {object} [options]\n\t */\n\tconstructor(owner, fn, options) {\n\t\tsuper(owner, fn, options)\n\n\t\treturn this.read\n\t}\n\n\tread = markReactive(() => {\n\t\tif (this.state) {\n\t\t\tif (this.state === STALE) {\n\t\t\t\tthis.update()\n\t\t\t} else {\n\t\t\t\tconst updates = Updates\n\t\t\t\tUpdates = null\n\t\t\t\trunUpdates(() => upstream(this))\n\t\t\t\tUpdates = updates\n\t\t\t}\n\t\t}\n\n\t\tif (Listener) {\n\t\t\tconst sourceSlot = this.observers ? this.observers.length : 0\n\n\t\t\tif (Listener.sources) {\n\t\t\t\tListener.sources.push(this)\n\t\t\t\tListener.sourceSlots.push(sourceSlot)\n\t\t\t} else {\n\t\t\t\tListener.sources = [this]\n\t\t\t\tListener.sourceSlots = [sourceSlot]\n\t\t\t}\n\n\t\t\tconst observerSlot = Listener.sources.length - 1\n\n\t\t\tif (sourceSlot) {\n\t\t\t\tthis.observers.push(Listener)\n\t\t\t\tthis.observerSlots.push(observerSlot)\n\t\t\t} else {\n\t\t\t\tthis.observers = [Listener]\n\t\t\t\tthis.observerSlots = [observerSlot]\n\t\t\t}\n\t\t}\n\n\t\treturn this.value\n\t})\n\n\twrite(value) {\n\t\tif (this.equals === false || !this.equals(this.value, value)) {\n\t\t\tthis.value = value\n\n\t\t\tif (this.observers && this.observers.length) {\n\t\t\t\trunUpdates(() => {\n\t\t\t\t\tfor (const observer of this.observers) {\n\t\t\t\t\t\tif (observer.state === CLEAN) {\n\t\t\t\t\t\t\tobserver.queue()\n\t\t\t\t\t\t\tobserver.observers && downstream(observer)\n\t\t\t\t\t\t}\n\t\t\t\t\t\tobserver.state = STALE\n\t\t\t\t\t}\n\t\t\t\t})\n\t\t\t}\n\t\t}\n\t}\n\t/**\n\t * @param {any} a\n\t * @param {any} b\n\t */\n\tequals(a, b) {\n\t\treturn a === b\n\t}\n\n\tupdate() {\n\t\tthis.dispose()\n\n\t\tlet nextValue\n\n\t\tconst time = Time\n\n\t\tconst prevOwner = Owner\n\t\tconst prevListener = Listener\n\n\t\tListener = Owner = this\n\t\ttry {\n\t\t\tnextValue = this.fn()\n\t\t} catch (err) {\n\t\t\tthis.state = STALE\n\t\t\tthis.disposeOwned()\n\n\t\t\tthis.updatedAt = time + 1\n\n\t\t\tthrow err\n\t\t} finally {\n\t\t\tOwner = prevOwner\n\t\t\tListener = prevListener\n\t\t}\n\t\tif (this.updatedAt <= time) {\n\t\t\tif (this.updatedAt !== 0) {\n\t\t\t\tthis.write(nextValue)\n\t\t\t} else {\n\t\t\t\tthis.value = nextValue\n\t\t\t}\n\t\t\tthis.updatedAt = time\n\t\t}\n\t}\n\tqueue() {\n\t\tUpdates.push(this)\n\t}\n}\n\n// SIGNAL\n\n/** @template in T */\nclass Signal {\n\tvalue\n\t/** @private */\n\tobservers\n\t/** @private */\n\tobserverSlots\n\n\t// options:\n\t// equals\n\t// save\n\n\t// `prev` if option save was given\n\t/**\n\t * @param {T} [value]\n\t * @param {SignalOptions} [options]\n\t */\n\tconstructor(value, options) {\n\t\tthis.value = value\n\t\tif (options) {\n\t\t\tassign(this, options)\n\t\t\tif (this.save) {\n\t\t\t\t/** @private */\n\t\t\t\tthis.prev = value\n\t\t\t}\n\t\t}\n\t}\n\t/** @returns SignalAccessor<T> */\n\tread = markReactive(() => {\n\t\t// checkReadForbidden()\n\n\t\tif (Listener) {\n\t\t\tconst sourceSlot = this.observers ? this.observers.length : 0\n\n\t\t\tif (Listener.sources) {\n\t\t\t\tListener.sources.push(this)\n\t\t\t\tListener.sourceSlots.push(sourceSlot)\n\t\t\t} else {\n\t\t\t\tListener.sources = [this]\n\t\t\t\tListener.sourceSlots = [sourceSlot]\n\t\t\t}\n\n\t\t\tconst observerSlot = Listener.sources.length - 1\n\n\t\t\tif (sourceSlot) {\n\t\t\t\tthis.observers.push(Listener)\n\t\t\t\tthis.observerSlots.push(observerSlot)\n\t\t\t} else {\n\t\t\t\tthis.observers = [Listener]\n\t\t\t\tthis.observerSlots = [observerSlot]\n\t\t\t}\n\t\t}\n\n\t\treturn this.value\n\t})\n\n\t/**\n\t * @param {T} [value]\n\t * @returns SignalSetter<T>\n\t */\n\twrite = value => {\n\t\tif (this.equals === false || !this.equals(this.value, value)) {\n\t\t\tif (this.save) {\n\t\t\t\tthis.prev = this.value\n\t\t\t}\n\t\t\tthis.value = value\n\n\t\t\tif (this.observers && this.observers.length) {\n\t\t\t\trunUpdates(() => {\n\t\t\t\t\tfor (const observer of this.observers) {\n\t\t\t\t\t\tif (observer.state === CLEAN) {\n\t\t\t\t\t\t\tobserver.queue()\n\t\t\t\t\t\t\tobserver.observers && downstream(observer)\n\t\t\t\t\t\t}\n\t\t\t\t\t\tobserver.state = STALE\n\t\t\t\t\t}\n\t\t\t\t})\n\t\t\t}\n\t\t\treturn true\n\t\t}\n\t\treturn false\n\t}\n\t/**\n\t * @param {T} [value]\n\t * @returns SignalUpdate<T>\n\t */\n\tupdate = value => {\n\t\treturn this.write(isFunction(value) ? value(this.value) : value)\n\t}\n\t/** @private */\n\tequals(a, b) {\n\t\treturn a === b\n\t}\n\n\t*[Symbol.iterator]() {\n\t\t/** @type SignalAccessor<T> */\n\t\tyield this.read\n\t\t/** @type SignalSetter<T> */\n\t\tyield this.write\n\t\t/** @type SignalUpdate<T> */\n\t\tyield this.update\n\t}\n}\n\n// API\n\n/**\n * Creates a new root\n *\n * @param {(dispose: () => void) => any} fn\n * @param {object} [options]\n * @returns {any}\n */\nexport function root(fn, options) {\n\tconst root = new Root(Owner, options)\n\treturn runWithOwner(root, () => fn(() => root.dispose()))\n}\n\n/**\n * Creates a signal\n *\n * @template T\n * @param {T} [initialValue] - Initial value of the signal\n * @param {SignalOptions} [options] - Signal options\n */\n/* #__NO_SIDE_EFFECTS__ */\nexport function signal(initialValue, options) {\n\treturn new Signal(initialValue, options)\n}\n\n/**\n * Creates an effect\n *\n * @param {Function} fn\n * @param {object} [options]\n */\nexport function effect(fn, options) {\n\tnew Effect(Owner, fn, options)\n}\n\n/**\n * Creates an effect with explicit dependencies\n *\n * @param {Function} depend - Function that causes tracking\n * @param {Function} fn - Function that wont cause tracking\n * @param {object} [options]\n */\nexport function on(depend, fn, options) {\n\teffect(() => {\n\t\tdepend()\n\t\tuntrack(fn)\n\t}, options)\n}\n\n/**\n * Creates a syncEffect\n *\n * @param {Function} fn\n * @param {object} [options]\n */\nexport function syncEffect(fn, options) {\n\treturn new SyncEffect(Owner, fn, options)\n}\n\n/**\n * Creates a read-only signal from the return value of a function that\n * automatically updates\n *\n * @template T\n * @param {() => T} fn - Function to re-run when dependencies change\n * @param {SignalOptions} [options]\n * @returns {SignalAccessor<T>} - Read only signal\n */\n\n/* #__NO_SIDE_EFFECTS__ */ export function memo(\n\tfn,\n\toptions = undefined,\n) {\n\treturn new Memo(Owner, fn, options)\n}\n\n/**\n * Batches changes to signals\n *\n * @param {Function} fn\n * @returns {any}\n */\nexport const batch = runUpdates\n\n/**\n * Returns current owner\n *\n * @returns {typeof Owner}\n */\nexport function owner() {\n\treturn Owner\n}\n\nfunction runWithOwner(owner, fn) {\n\tconst prevOwner = Owner\n\tconst prevListener = Listener\n\n\tOwner = owner\n\tListener = undefined\n\n\ttry {\n\t\treturn runUpdates(fn, true)\n\t} catch (err) {\n\t\tthrow err\n\t} finally {\n\t\tOwner = prevOwner\n\t\tListener = prevListener\n\t}\n}\n\n/**\n * Disables tracking for a function\n *\n * @param {Function} fn - Function to run with tracking disabled\n * @returns {any}\n */\nexport function untrack(fn) {\n\tif (Listener === undefined) {\n\t\treturn fn()\n\t}\n\n\tconst prevListener = Listener\n\tListener = undefined\n\ttry {\n\t\treturn fn()\n\t} finally {\n\t\tListener = prevListener\n\t}\n}\n\n/**\n * Runs a callback on cleanup, returns callback\n *\n * @template T\n * @param {T} fn\n * @returns {T}\n */\nexport function cleanup(fn) {\n\tOwner && Owner.addCleanups(fn)\n\n\treturn fn\n}\n\n// UPDATES\n\nfunction runTop(node) {\n\tswitch (node.state) {\n\t\tcase CLEAN: {\n\t\t\tbreak\n\t\t}\n\t\tcase CHECK: {\n\t\t\tupstream(node)\n\t\t\tbreak\n\t\t}\n\n\t\tdefault: {\n\t\t\tconst ancestors = []\n\n\t\t\tdo {\n\t\t\t\tnode.state && ancestors.push(node)\n\n\t\t\t\tnode = node.owner\n\t\t\t} while (node && node.updatedAt < Time)\n\n\t\t\tfor (let i = ancestors.length - 1, updates; i >= 0; i--) {\n\t\t\t\tnode = ancestors[i]\n\n\t\t\t\tswitch (node.state) {\n\t\t\t\t\tcase STALE: {\n\t\t\t\t\t\tnode.update()\n\t\t\t\t\t\tbreak\n\t\t\t\t\t}\n\t\t\t\t\tcase CHECK: {\n\t\t\t\t\t\tupdates = Updates\n\t\t\t\t\t\tUpdates = null\n\t\t\t\t\t\trunUpdates(() => upstream(node, ancestors[0]))\n\t\t\t\t\t\tUpdates = updates\n\t\t\t\t\t\tbreak\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n}\n\nfunction runUpdates(fn, init = false) {\n\tif (Updates) {\n\t\treturn fn()\n\t}\n\n\tlet wait = false\n\n\tif (!init) {\n\t\tUpdates = []\n\t}\n\n\tif (Effects) {\n\t\twait = true\n\t} else {\n\t\tEffects = []\n\t}\n\n\tTime++\n\n\ttry {\n\t\tconst res = fn()\n\n\t\tif (Updates) {\n\t\t\tfor (const update of Updates) {\n\t\t\t\trunTop(update)\n\t\t\t}\n\t\t}\n\t\tUpdates = null\n\n\t\tif (!wait) {\n\t\t\tconst effects = Effects\n\t\t\tEffects = null\n\t\t\teffects.length && runUpdates(() => runEffects(effects))\n\t\t}\n\n\t\treturn res\n\t} catch (err) {\n\t\tif (!wait) {\n\t\t\tEffects = null\n\t\t}\n\t\tUpdates = null\n\n\t\tthrow err\n\t}\n}\n\nfunction runEffects(queue) {\n\tlet userLength = 0\n\tfor (const effect of queue) {\n\t\tif (effect.user) {\n\t\t\tqueue[userLength++] = effect\n\t\t} else {\n\t\t\trunTop(effect)\n\t\t}\n\t}\n\n\tfor (let i = 0; i < userLength; i++) {\n\t\trunTop(queue[i])\n\t}\n}\n\nfunction upstream(node, ignore) {\n\tnode.state = CLEAN\n\n\tfor (const source of node.sources) {\n\t\tif (source.sources) {\n\t\t\tswitch (source.state) {\n\t\t\t\tcase STALE: {\n\t\t\t\t\tif (source !== ignore && source.updatedAt < Time) {\n\t\t\t\t\t\trunTop(source)\n\t\t\t\t\t}\n\t\t\t\t\tbreak\n\t\t\t\t}\n\t\t\t\tcase CHECK: {\n\t\t\t\t\tupstream(source, ignore)\n\t\t\t\t\tbreak\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n}\n\nfunction downstream(node) {\n\tfor (const observer of node.observers) {\n\t\tif (observer.state === CLEAN) {\n\t\t\tobserver.state = CHECK\n\t\t\tobserver.queue()\n\t\t\tobserver.observers && downstream(observer)\n\t\t}\n\t}\n}\n\n/**\n * Creates a context and returns a function to get or set the value\n *\n * @param {any} [defaultValue] - Default value for the context\n */\nexport function Context(defaultValue = undefined) {\n\treturn useContext.bind(null, Symbol(), defaultValue)\n}\n\n/**\n * @overload Gets the context value\n * @returns {any} Context value\n */\n/**\n * @overload Runs `fn` with a new value as context\n * @param {any} newValue - New value for the context\n * @param {Function} fn - Callback to run with the new context value\n * @returns {Children} Children\n */\n/**\n * @param {any} newValue\n * @param {Function} fn\n */\nfunction useContext(id, defaultValue, newValue, fn) {\n\tif (newValue === undefined) {\n\t\treturn Owner?.context && Owner.context[id] !== undefined\n\t\t\t? Owner.context[id]\n\t\t\t: defaultValue\n\t} else {\n\t\tlet res\n\n\t\tsyncEffect(() => {\n\t\t\tOwner.context = {\n\t\t\t\t...Owner.context,\n\t\t\t\t[id]: newValue,\n\t\t\t}\n\t\t\tres = untrack(fn)\n\t\t})\n\n\t\treturn res\n\t}\n}\n\n/**\n * Returns an owned function\n *\n * @param {Function | undefined} cb\n * @returns {() => any}\n */\nexport const owned = cb => {\n\tconst o = Owner\n\treturn cb ? (...args) => runWithOwner(o, () => cb(...args)) : noop\n}\n\n/**\n * Proxies a signals property access so you dont have to call the\n * function\n *\n * @template T\n * @param {SignalAccessor<T>} snigal - Signal to proxy\n * @param {object} [target] - Target object for the proxy\n * @returns {object} An object that will read the properties from the\n *   signal\n */\nexport const proxy = (snigal, target = nothing) =>\n\tnew Proxy(target, {\n\t\tget(target, key) {\n\t\t\treturn snigal()[key]\n\t\t},\n\t\thas(target, key) {\n\t\t\treturn key in snigal()\n\t\t},\n\t\townKeys(target) {\n\t\t\treturn keys(snigal())\n\t\t},\n\t})\n\n/**\n * A self contained signal function, when an argument is present it\n * writes to the signal, when theres no argument it reads the signal.\n *\n * @template T\n * @param {T} [value] - Optional initial value\n * @returns {SignalFunction<T>}\n */\nexport function signalFunction(value) {\n\tconst [read, write] = signal(value)\n\treturn markReactive((...args) =>\n\t\targs.length ? write(args[0]) : read(),\n\t)\n}\n\n/**\n * To set and read refs. To use in ref attribute.\n *\n * @template T\n * @returns {SignalFunction<T>}\n */\nexport const ref = () => signalFunction()\n\n/**\n * Runs a function inside an effect if value is a function.\n * Aditionally unwraps promises.\n *\n * @param {any} value\n * @param {(value) => any} fn\n */\nexport function withValue(value, fn) {\n\tif (isFunction(value)) {\n\t\teffect(() => withValue(getValue(value), fn))\n\t} else if (isPromise(value)) {\n\t\tvalue.then(owned(value => withValue(value, fn)))\n\t} else {\n\t\tfn(value)\n\t}\n}\n\n/**\n * Runs a function inside an effect if value is a function\n *\n * @param {any} value\n * @param {(value: any, prev?: any) => any} fn\n */\nexport function withPrevValue(value, fn) {\n\tif (isFunction(value)) {\n\t\tlet prev\n\t\teffect(() => {\n\t\t\tconst val = getValue(value)\n\t\t\tfn(val, prev)\n\t\t\tprev = val\n\t\t})\n\t} else {\n\t\tfn(value)\n\t}\n}\n\n/**\n * Lazy and writable version of `memo`, its writable and will run the\n * function only when used\n *\n * @author ryansolid\n * @param {Function} fn - Function to re-run when dependencies change\n * @returns {((...args) => any) | (() => any)}\n */\nexport function writable(fn) {\n\tconst result = memo(() => signal(fn()))\n\n\treturn markReactive((...args) => {\n\t\treturn args.length ? result().write(args[0]) : result().read()\n\t})\n}\n\n/**\n * Creates an asynchronously effect\n *\n * @param {(currentRunningEffect: Promise<any>) => any} fn - A\n *   function that receives a `currentRunningEffect` that should be\n *   awaited for when wanting to run effects synchronously, that's it\n *   one effect after another.\n */\nexport function asyncEffect(fn) {\n\tconst queue = []\n\teffect(() => {\n\t\tconst { promise, resolve } = withResolvers()\n\n\t\tqueue.push(promise)\n\n\t\tfunction onDone() {\n\t\t\tremoveFromArray(queue, promise)\n\t\t\tresolve()\n\t\t}\n\n\t\tresolved(\n\t\t\tfn(queue.length === 1 ? undefined : queue[queue.length - 2]),\n\t\t\tonDone,\n\t\t)\n\t})\n}\n\n/**\n * A Promise loader handler. Allows to display/run something or\n * nothing while a promise is resolving. Allows to run a callback when\n * the promise resolves. Allows to get notified of errors, and\n * display/run something or nothing, if wanted a `retry` function is\n * given for retrying the promise. All functions run with the original\n * owner, so it's `Context` friendly.\n *\n * @param {(() => Promise<any>) | Promise<any>} fn - Function that\n *   returns a promise\n * @param {{\n * \tonLoading?: any\n * \tonLoaded?: Function\n * \tonError?: ((e: Error, retry: Function) => any) | any\n * }} [options]\n *\n * @returns {Component}\n * @url https://pota.quack.uy/lazy\n */\nexport const lazy = (fn, options = nothing) =>\n\tmarkComponent(props => {\n\t\tconst { onLoading, onLoaded, onError } = options\n\n\t\tconst [value, setValue] = signal(onLoading)\n\n\t\tconst _onLoaded = owned(onLoaded)\n\n\t\tconst retry = () =>\n\t\t\tPromise.resolve(isFunction(fn) ? fn() : fn)\n\t\t\t\t.then(r => {\n\t\t\t\t\tsetValue(\n\t\t\t\t\t\tmarkComponent(() => {\n\t\t\t\t\t\t\tr = isObject(r) && r.default ? r.default : r\n\t\t\t\t\t\t\treturn isFunction(r) ? r(props) : r\n\t\t\t\t\t\t}),\n\t\t\t\t\t)\n\t\t\t\t\tmicrotask(_onLoaded)\n\t\t\t\t})\n\t\t\t\t.catch(e =>\n\t\t\t\t\tonError\n\t\t\t\t\t\t? setValue(\n\t\t\t\t\t\t\t\tmarkComponent(() =>\n\t\t\t\t\t\t\t\t\tisFunction(onError) ? onError(e, retry) : onError,\n\t\t\t\t\t\t\t\t),\n\t\t\t\t\t\t\t)\n\t\t\t\t\t\t: console.error(e),\n\t\t\t\t)\n\t\tretry()\n\n\t\treturn value\n\t})\n\nexport const Lazy = props => lazy(props.children, props)\n\nexport const microtask = fn => queueMicrotask(owned(fn))\n\n// MAP\n\nclass Row {\n\trunId\n\titem\n\tindex\n\tisDupe\n\tdisposer\n\tnodes\n\n\tconstructor(item, index, fn, isDupe) {\n\t\tthis.item = item\n\t\tthis.index = index\n\t\tthis.isDupe = isDupe\n\n\t\troot(disposer => {\n\t\t\tthis.disposer = disposer\n\t\t\t/** @type Children[] */\n\t\t\tthis.nodes = fn(item, index)\n\t\t})\n\t}\n\tbegin() {\n\t\treturn this.nodes[0]\n\t}\n\tend() {\n\t\treturn this.nodes[this.nodes.length - 1]\n\t}\n\tnodesForRow() {\n\t\tconst begin = this.begin()\n\t\tconst end = this.end()\n\n\t\tconst nodes = [begin]\n\n\t\tlet nextSibling = begin\n\t\twhile (nextSibling !== end) {\n\t\t\tnextSibling = nextSibling.nextSibling\n\t\t\tnodes.push(nextSibling)\n\t\t}\n\n\t\treturn nodes\n\t}\n}\n\n/**\n * Reactive Map\n *\n * @template T\n * @param {Each<T>} list\n * @param {Function} callback\n * @param {boolean} [sort]\n * @param {Children} [fallback]\n */\nexport function map(list, callback, sort, fallback) {\n\tconst cache = new Map()\n\tconst duplicates = new Map() // for when caching by value is not possible [1, 2, 1, 1, 1]\n\n\tlet runId = 0\n\n\tlet rows = []\n\t/** @type any[] */\n\tlet prev = []\n\n\tfunction clear() {\n\t\tfor (const row of prev) {\n\t\t\trow.disposer()\n\t\t}\n\t\tcache.clear()\n\t\tduplicates.clear()\n\n\t\trows.length = 0\n\t\tprev.length = 0\n\t}\n\n\t// to get rid of all nodes when parent disposes\n\tcleanup(clear)\n\n\tfunction dispose(row) {\n\t\t// delete from cache\n\t\tif (!row.isDupe) {\n\t\t\tcache.delete(row.item)\n\t\t} else {\n\t\t\tconst arr = duplicates.get(row.item)\n\t\t\tarr.length === 1\n\t\t\t\t? duplicates.delete(row.item)\n\t\t\t\t: removeFromArray(arr, row)\n\t\t}\n\n\t\trow.disposer()\n\t}\n\n\t/**\n\t * @param {Function} fn\n\t * @returns {Children}\n\t */\n\tfunction mapper(fn) {\n\t\tconst cb = fn\n\t\t\t? (item, index) => fn(callback(item, index), index)\n\t\t\t: callback\n\n\t\tconst value = getValue(list) || []\n\n\t\t/** To allow iterate objects as if were an array with indexes */\n\t\tconst items = isIterable(value) ? value.entries() : entries(value)\n\n\t\trunId++\n\t\trows = []\n\t\tconst hasPrev = prev.length\n\n\t\tfor (const [index, item] of items) {\n\t\t\tlet row = hasPrev ? cache.get(item) : undefined\n\n\t\t\t// if the item doesnt exists, create it\n\t\t\tif (row === undefined) {\n\t\t\t\trow = new Row(item, index, cb, false)\n\t\t\t\tcache.set(item, row)\n\t\t\t} else if (row.runId === runId) {\n\t\t\t\t// a map will save only 1 of any primitive duplicates, say: [1, 1, 1, 1]\n\t\t\t\t// if the saved value was already used on this run, create a new one\n\t\t\t\tlet dupes = duplicates.get(item)\n\t\t\t\tif (!dupes) {\n\t\t\t\t\tdupes = []\n\t\t\t\t\tduplicates.set(item, dupes)\n\t\t\t\t}\n\t\t\t\tfor (const dupe of dupes) {\n\t\t\t\t\tif (dupe.runId !== runId) {\n\t\t\t\t\t\trow = dupe\n\t\t\t\t\t\tbreak\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif (row.runId === runId) {\n\t\t\t\t\trow = new Row(item, index, cb, true)\n\t\t\t\t\tdupes.push(row)\n\t\t\t\t}\n\t\t\t}\n\n\t\t\trow.runId = runId // mark used on this run\n\t\t\trow.index = index // save sort order\n\t\t\trows.push(row)\n\t\t}\n\n\t\t// fast clear\n\t\tif (rows.length === 0) {\n\t\t\tclear()\n\t\t\tprev = rows\n\t\t\treturn fallback ? fn(fallback) : emptyArray\n\t\t}\n\n\t\t// remove rows that arent present on the current run\n\t\tfor (let i = 0; i < prev.length; i++) {\n\t\t\tif (prev[i].runId !== runId) {\n\t\t\t\tdispose(prev[i])\n\t\t\t\tremoveFromArray(prev, prev[i--])\n\t\t\t}\n\t\t}\n\n\t\t// reorder elements\n\t\t// `rows.length > 1` because no need for sorting when there are no items\n\t\t// `prev.length > 0` to skip sorting on creation as its already sorted\n\t\tif (sort && rows.length > 1 && prev.length) {\n\t\t\t// when appending to already created it shouldnt sort\n\t\t\t// as its already sorted\n\t\t\tlet sort = false\n\t\t\tfor (let i = 0; i < prev.length && i < rows.length; i++) {\n\t\t\t\tif (prev[i] !== rows[i]) {\n\t\t\t\t\tsort = true\n\t\t\t\t\tbreak\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (sort) {\n\t\t\t\t// if the planets align it handles swapping\n\t\t\t\t// a = sorted\n\t\t\t\t// b = unsorted\n\t\t\t\tconst { a, b } = groupBy(rows, (value, index) =>\n\t\t\t\t\trows[index] === prev[index] ? 'a' : 'b',\n\t\t\t\t)\n\n\t\t\t\tlet unsorted = b?.length\n\t\t\t\tif (\n\t\t\t\t\ta &&\n\t\t\t\t\tb &&\n\t\t\t\t\ta.length &&\n\t\t\t\t\tb.length &&\n\t\t\t\t\tb.length < a.length &&\n\t\t\t\t\tb.every(item => prev.includes(item))\n\t\t\t\t) {\n\t\t\t\t\tfor (const usort of b) {\n\t\t\t\t\t\tfor (const sort of a) {\n\t\t\t\t\t\t\tif (usort.index === sort.index - 1) {\n\t\t\t\t\t\t\t\tsort.begin().before(...usort.nodesForRow())\n\t\t\t\t\t\t\t\tunsorted--\n\t\t\t\t\t\t\t\tbreak\n\t\t\t\t\t\t\t} else if (usort.index === sort.index + 1) {\n\t\t\t\t\t\t\t\tsort.end().after(...usort.nodesForRow())\n\t\t\t\t\t\t\t\tunsorted--\n\t\t\t\t\t\t\t\tbreak\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tif (unsorted) {\n\t\t\t\t\t// handles all other cases\n\t\t\t\t\t// best for any combination of: push/pop/shift/unshift/insertion/deletion\n\t\t\t\t\t// must check in reverse as on creation stuff is added to the end\n\n\t\t\t\t\tlet current = rows[rows.length - 1]\n\t\t\t\t\tfor (let i = rows.length - 1; i > 0; i--) {\n\t\t\t\t\t\tconst previous = rows[i - 1]\n\t\t\t\t\t\tif (current.begin().previousSibling !== previous.end()) {\n\t\t\t\t\t\t\tcurrent.begin().before(...previous.nodesForRow())\n\t\t\t\t\t\t}\n\t\t\t\t\t\tcurrent = previous\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\t// save sorted list\n\t\tprev = rows\n\n\t\t// return external representation\n\t\treturn rows.flatMap(item => item.nodes)\n\t}\n\tmapper[$isMap] = undefined\n\treturn mapper\n}\n\n/**\n * Resolves and returns `children` in a memo\n *\n * @param {Component | Children} fn\n * @url https://pota.quack.uy/resolve\n */\nexport function resolve(fn) {\n\tconst children = isFunction(fn) ? memo(fn) : () => fn\n\treturn memo(() => unwrap(children()))\n}\n\n/**\n * Recursively unwrap children functions\n *\n * @param {Component} children\n */\nfunction unwrap(children) {\n\tif (isFunction(children)) {\n\t\treturn unwrap(children())\n\t}\n\n\tif (isArray(children)) {\n\t\tconst childrens = []\n\t\tfor (let child of children) {\n\t\t\tchild = unwrap(child)\n\t\t\tisArray(child)\n\t\t\t\t? childrens.push(...child)\n\t\t\t\t: childrens.push(child)\n\t\t}\n\t\treturn childrens\n\t}\n\n\treturn children\n}\n\n/**\n * Extend `Pota` and define a `render(props){}` method to create a\n * class component. `ready(cb)` and `cleanup(cb)` methods will be\n * registered automatically\n *\n * @url https://pota.quack.uy/Classes\n */\nexport class Pota {}\n\nPota[$isClass] = undefined\n\n/**\n * Returns true if the `value` is a `Component`\n *\n * @param {any} value\n * @returns {boolean}\n */\nexport const isComponent = value =>\n\tisFunction(value) && $isComponent in value\n\n/**\n * Returns true if the value can be made a Component\n *\n * @param {any} value\n * @returns {boolean}\n */\nexport function isComponentable(value) {\n\treturn (\n\t\t!isReactive(value) &&\n\t\t(isFunction(value) ||\n\t\t\t(!isArray(value) && isObject(value) && !isPromise(value)))\n\t)\n}\n\n// avoid [1,2] and support { toString(){ return \"something\"} }\n\n/**\n * Makes of `children` a function. Reactive children will run as is,\n * non-reactive children will run untracked, regular children will\n * just return.\n *\n * @param {Children} children\n * @returns {Function}\n */\nexport function makeCallback(children) {\n\t/**\n\t * When children is an array, as in >${[0, 1, 2]}< then children\n\t * will end as `[[0, 1, 2]]`, so flat it\n\t */\n\n\tchildren = isArray(children) ? flat(children) : children\n\n\tconst callbacks = !isArray(children)\n\t\t? callback(children)\n\t\t: children.map(callback)\n\n\treturn !isArray(children)\n\t\t? markComponent((...args) => callbacks(args))\n\t\t: markComponent((...args) =>\n\t\t\t\tcallbacks.map(callback => callback(args)),\n\t\t\t)\n}\n\nconst callback = child =>\n\tisFunction(child)\n\t\t? isReactive(child)\n\t\t\t? args => {\n\t\t\t\t\t/**\n\t\t\t\t\t * The function inside the `for` is saved in a signal. The\n\t\t\t\t\t * result of the signal is our callback\n\t\t\t\t\t *\n\t\t\t\t\t * ```js\n\t\t\t\t\t * htmlEffect(\n\t\t\t\t\t * \thtml =>\n\t\t\t\t\t * \t\thtml`<table>\n\t\t\t\t\t * \t\t\t<tr>\n\t\t\t\t\t * \t\t\t\t<th>name</th>\n\t\t\t\t\t * \t\t\t</tr>\n\t\t\t\t\t * \t\t\t<for each=\"${tests}\">\n\t\t\t\t\t * \t\t\t\t${item =>\n\t\t\t\t\t * \t\t\t\t\thtml`<tr>\n\t\t\t\t\t * \t\t\t\t\t\t<td>${item.name}</td>\n\t\t\t\t\t * \t\t\t\t\t</tr>`}\n\t\t\t\t\t * \t\t\t</for>\n\t\t\t\t\t * \t\t</table>`,\n\t\t\t\t\t * )\n\t\t\t\t\t * ```\n\t\t\t\t\t */\n\t\t\t\t\tconst r = child()\n\t\t\t\t\treturn isFunction(r)\n\t\t\t\t\t\t? isReactive(r)\n\t\t\t\t\t\t\t? r()\n\t\t\t\t\t\t\t: untrack(() => r(...args))\n\t\t\t\t\t\t: r\n\t\t\t\t}\n\t\t\t: args => untrack(() => child(...args))\n\t\t: () => child\n\n// allows to tell a `signal function` from a `component function`\n// signals and user functions go in effects, for reactivity\n// components and callbacks are untracked and wont go in effects to avoid re-rendering\n\n/**\n * Marks a function as a `Component`.\n *\n * @template T\n * @param {T} fn - Function to mark as a `Component`\n */\nexport function markComponent(fn) {\n\tfn[$isComponent] = undefined\n\treturn fn\n}\n\n/**\n * Adds an event listener to a node\n *\n * @param {Element | Document | typeof window} node - Element to add\n *   the event listener\n * @param {(keyof WindowEventMap & keyof GlobalEventHandlersEventMap)\n * \t| string} type\n *   - The name of the event listener\n *\n * @param {EventListener\n * \t| EventListenerObject\n * \t| (EventListenerObject & AddEventListenerOptions)} handler\n *   - Function to handle the event\n *\n * @returns {Function} - An `off` function for removing the event\n *   listener\n * @url https://pota.quack.uy/props/EventListener\n */\nexport function addEvent(node, type, handler) {\n\tnode.addEventListener(\n\t\ttype,\n\t\thandler,\n\t\t!isFunction(handler) && handler,\n\t)\n\n\t/**\n\t * Removes event on tracking scope disposal.\n\t *\n\t * Situation: the event was added to the `document` or `window`\n\t * manually using `addEvent`, say to listen for clicks as a \"click\n\t * outside\". The event needs to be removed when the component that\n\t * added it is disposed.\n\t */\n\n\treturn cleanup(() => removeEvent(node, type, handler))\n}\n\n/**\n * Removes an event listener from a node\n *\n * @param {Element | Document | typeof window} node - Element to add\n *   the event listener\n * @param {(keyof WindowEventMap & keyof GlobalEventHandlersEventMap)\n * \t| string} type\n *   - The name of the event listener\n *\n * @param {EventListener\n * \t| EventListenerObject\n * \t| (EventListenerObject & AddEventListenerOptions)} handler\n *   - Function to handle the event\n *\n * @returns {Function} - An `on` function for adding back the event\n *   listener\n * @url https://pota.quack.uy/props/EventListener\n */\nexport function removeEvent(node, type, handler) {\n\tnode.removeEventListener(\n\t\ttype,\n\t\thandler,\n\t\t!isFunction(handler) && handler,\n\t)\n\n\treturn () => addEvent(node, type, handler)\n}\n\n/**\n * It gives a handler an owner, so stuff runs batched on it, and\n * things like context and cleanup work\n */\nexport const ownedEvent = handler =>\n\t'handleEvent' in handler\n\t\t? {\n\t\t\t\t...handler,\n\t\t\t\thandleEvent: owned(e => handler.handleEvent(e)),\n\t\t\t}\n\t\t: owned(handler)\n","import { owned } from './lib/reactive.js'\nimport { call, queueMicrotask } from './lib/std.js'\n\n/**\n * The purpose of this file is to guarantee the timing of some\n * callbacks. It queues a microtask, then the callbacks are added to a\n * position in the array. These are run with a priority.\n */\n\n/** @type boolean */\nlet added\n\n/** @type [][] */\nlet queue\n\nfunction reset() {\n\tqueue = [[], [], [], [], [], []]\n\tadded = false\n}\n\n// initialization\nreset()\n\n/**\n * Queues a callback at a priority\n *\n * @param {PropertyKey} priority - Priority\n * @param {Function} fn - Function to run once the callbacks at this\n *   priority run\n */\nfunction add(priority, fn) {\n\tif (!added) {\n\t\tadded = true\n\t\tqueueMicrotask(run)\n\t}\n\tqueue[priority].push(owned(fn))\n}\n\n/** Runs all queued callbacks */\nfunction run() {\n\tconst q = queue\n\treset()\n\n\tfor (const fns of q) {\n\t\tfns.length && call(fns)\n\t}\n}\n\n/**\n * Queue a function to run before everything else (onProps, onRef,\n * onMount, ready) ex focus restoration\n *\n * @param {Function} fn\n */\nexport const onFixes = fn => add(0, fn)\n\n/**\n * Queue a function to run before (onRef, onMount, ready) ex running\n * user functions on elements via plugins\n *\n * @param {Function} fn\n */\nexport const onProps = fn => add(1, fn)\n\n/**\n * Queue a function to run onRef (before onMount, after onProps)\n *\n * @param {Function} fn\n */\nexport const onRef = fn => add(2, fn)\n\n/**\n * Queue a function to run onMount (before ready, after onRef)\n *\n * @param {Function} fn\n */\nexport const onMount = fn => add(3, fn)\n\n/**\n * Queue a function to run on ready (after onMount)\n *\n * @param {Function} fn\n * @url https://pota.quack.uy/ready\n */\nexport const ready = fn => add(4, fn)\n\n/**\n * Queue a function to run after all user defined processes\n *\n * @param {Function} fn\n */\nexport const onDone = fn => add(5, fn)\n","import { cacheStore } from '../lib/std.js'\nimport { onProps } from '../scheduler.js'\n\nexport const plugins = cacheStore()\nexport const pluginsNS = cacheStore()\n\n/**\n * Defines a prop that can be used on any Element\n *\n * @param {string} propName - Name of the prop\n * @param {(\n * \tnode: Element,\n * \tpropName: string,\n * \tpropValue: Function | any,\n * \tprops: object,\n * ) => void} fn\n *   - Function to run when this prop is found on any Element\n *\n * @param {boolean} [onMicrotask=true] - To avoid the problem of\n *   needed props not being set, or children elements not created yet.\n *   Default is `true`\n * @url https://pota.quack.uy/props/propsPlugin\n */\nexport const propsPlugin = (propName, fn, onMicrotask) => {\n\tplugin(plugins, propName, fn, onMicrotask)\n}\n\n/**\n * Defines a namespaced prop that can be used on any Element\n *\n * @param {string} NSName - Name of the namespace\n * @param {(\n * \tnode: Element,\n * \tpropName: string,\n * \tpropValue: Function | any,\n * \tprops: object,\n * \tlocalName: string,\n * \tns: string,\n * ) => void} fn\n *   - Function to run when this prop is found on any Element\n *\n * @param {boolean} [onMicrotask=true] - Set to run on a microtask to\n *   avoid the problem of needed props not being set, or children\n *   elements not being created yet. Default is `true`\n */\nexport const propsPluginNS = (NSName, fn, onMicrotask) => {\n\tplugin(pluginsNS, NSName, fn, onMicrotask)\n}\n\n/**\n * Defines prop and namespaced prop that can be used on any Element\n *\n * @param {string} propName - Name of the prop/namespace\n * @param {Function} fn - Function to run when this prop is found on\n *   any Element\n * @param {boolean} [onMicrotask=true] - Set to run on a microtask to\n *   avoid the problem of needed props not being set, or children\n *   elements not being created yet. Default is `true`\n */\nexport const propsPluginBoth = (propName, fn, onMicrotask) => {\n\tplugin(plugins, propName, fn, onMicrotask)\n\tplugin(pluginsNS, propName, fn, onMicrotask)\n}\n\nconst plugin = (plugins, name, fn, onMicrotask = true) => {\n\tplugins.set(\n\t\tname,\n\t\t!onMicrotask ? fn : (...args) => onProps(() => fn(...args)),\n\t)\n}\n","import { withValue } from '../lib/reactive.js'\nimport { isNullUndefined } from '../lib/std.js'\n\nimport { NS } from '../constants.js'\n\n// NODE ATTRIBUTES\n\n/**\n * @param {Element} node\n * @param {string} name\n * @param {unknown} value\n * @param {object} props\n * @param {string} localName\n * @param {string} ns\n */\nexport const setAttributeNS = (\n\tnode,\n\tname,\n\tvalue,\n\tprops,\n\tlocalName,\n\tns,\n) => setAttribute(node, localName, value)\n\n/**\n * @param {Element} node\n * @param {string} name\n * @param {unknown} value\n * @param {string} [ns]\n * @url https://pota.quack.uy/props/setAttribute\n */\nexport const setAttribute = (node, name, value, ns) =>\n\twithValue(value, value => _setAttribute(node, name, value, ns))\n\n/**\n * @param {Element} node\n * @param {string} name\n * @param {string} value\n * @param {string } [ns]\n */\nfunction _setAttribute(node, name, value, ns) {\n\t// if the value is null or undefined it will be removed\n\tif (isNullUndefined(value)) {\n\t\tns && NS[ns]\n\t\t\t? node.removeAttributeNS(NS[ns], name)\n\t\t\t: node.removeAttribute(name)\n\t} else {\n\t\tns && NS[ns]\n\t\t\t? node.setAttributeNS(NS[ns], name, value)\n\t\t\t: node.setAttribute(name, value)\n\t}\n}\n","import { withValue } from '../lib/reactive.js'\nimport { isNullUndefined } from '../lib/std.js'\n\n/**\n * @param {Element} node\n * @param {string} name\n * @param {unknown} value\n * @param {object} props\n * @param {string} localName\n * @param {string} ns\n */\nexport const setPropertyNS = (\n\tnode,\n\tname,\n\tvalue,\n\tprops,\n\tlocalName,\n\tns,\n) => {\n\tsetProperty(node, localName, value)\n}\n\n/**\n * @param {Element} node\n * @param {string} name\n * @param {unknown} value\n * @url https://pota.quack.uy/props/setProperty\n */\nexport const setProperty = (node, name, value) => {\n\twithValue(value, value => _setProperty(node, name, value))\n}\n/**\n * @param {Element} node\n * @param {string} name\n * @param {unknown} value\n */\nexport function _setProperty(node, name, value) {\n\t// if the value is null or undefined it will be set to null\n\tif (isNullUndefined(value)) {\n\t\t// defaulting to `undefined` breaks `progress` tag and the whole page\n\t\tnode[name] = null\n\t} else {\n\t\tnode[name] = value\n\t}\n}\n","// NODE UNKNOWN PROPERTIES / ATTRIBUTES\n\nimport { withValue } from '../lib/reactive.js'\nimport {\n\tgetPrototypeOf,\n\tgetSetterNamesFromPrototype,\n} from '../lib/std.js'\nimport { setAttribute } from './attribute.js'\nimport { setProperty } from './property.js'\n\n/**\n * @param {Element} node\n * @param {string} name\n * @param {unknown} value\n * @param {string} [ns]\n */\nexport const setUnknown = (node, name, value, ns) => {\n\twithValue(value, value => _setUnknown(node, name, value, ns))\n}\n\n/**\n * @param {Element} node\n * @param {string} name\n * @param {unknown} value\n * @param {string} [ns]\n */\nexport const _setUnknown = (node, name, value, ns) => {\n\tconst setters = elementSetters(node)\n\n\tif (\n\t\tsetters.element.has(name) &&\n\t\t(typeof value !== 'string' || node.isCustomElement)\n\t) {\n\t\t/**\n\t\t * 1. when it's different to a string to avoid coarcing\n\t\t *    on native elements (ex: (img.width = '16px') === 0)\n\t\t * 2. when a native element has a setter\n\t\t * 3. when a custom element has a setter\n\t\t */\n\t\tsetProperty(node, name, value)\n\t} else if (setters.builtIn.has(name)) {\n\t\t// ex: innerHTML, textContent, etc\n\t\tsetProperty(node, name, value)\n\t} else {\n\t\tsetAttribute(node, name, value, ns)\n\t}\n}\n\nconst elements = new Map()\n\n/** @param {Element} node */\nfunction elementSetters(node) {\n\t/**\n\t * Use `node.constructor` instead of `node.nodeName` because it\n\t * handles the difference between `a` `HTMLAnchorElement` and `a`\n\t * `SVGAElement`\n\t */\n\tlet setters = elements.get(node.constructor)\n\tif (setters) return setters\n\tsetters = { builtIn: new Set(builtInSetters), element: new Set() }\n\telements.set(node.constructor, setters)\n\n\tlet store = setters.element\n\tlet proto = getPrototypeOf(node)\n\n\t/**\n\t * Stop at `Element` instead of `HTMLElement` because it handles the\n\t * difference between `HTMLElement`, `SVGElement`, `FutureElement`\n\t * etc\n\t */\n\twhile (proto.constructor !== Element) {\n\t\tconst nextProto = getPrototypeOf(proto)\n\n\t\t/**\n\t\t * The previous prototype to `Element` is a `builtIn`\n\t\t * (`HTMLElement`, `SVGElement`,`FutureElement`, etc)\n\t\t */\n\t\tif (nextProto.constructor === Element) {\n\t\t\tstore = setters.builtIn\n\t\t}\n\t\tgetSetterNamesFromPrototype(proto, store)\n\t\tproto = nextProto\n\t}\n\n\treturn setters\n}\n\n/** Setters shared by all kind of elements */\nconst builtInSetters = getSetterNamesFromPrototype(\n\tElement.prototype,\n\tgetSetterNamesFromPrototype(Node.prototype),\n)\n","// BOOL ATTRIBUTES\n\nimport { withValue } from '../lib/reactive.js'\n\n/**\n * @param {Element} node\n * @param {string} name\n * @param {unknown} value\n * @param {object} props\n * @param {string} localName\n * @param {string} ns\n */\nexport const setBoolNS = (node, name, value, props, localName, ns) =>\n\tsetBool(node, localName, value)\n\n/**\n * @param {Element} node\n * @param {string} name\n * @param {unknown} value\n * @url https://pota.quack.uy/props/setBool\n */\nexport const setBool = (node, name, value) =>\n\twithValue(value, value => _setBool(node, name, value))\n\n/**\n * @param {Element} node\n * @param {string} name\n * @param {unknown} value\n */\nexport const _setBool = (node, name, value) =>\n\t// if the value is falsy gets removed\n\tvalue ? node.setAttribute(name, '') : node.removeAttribute(name)\n","// node style\n\nimport { withValue } from '../lib/reactive.js'\nimport {\n\tgetValue,\n\tisFunction,\n\tisNullUndefined,\n\tisObject,\n\tisString,\n} from '../lib/std.js'\n\n/**\n * @param {DOMElement} node\n * @param {string} name\n * @param {StylePropertyValue} value\n * @param {object} props\n * @url https://pota.quack.uy/props/setStyle\n */\nexport const setStyle = (node, name, value, props) =>\n\tsetNodeStyle(node.style, value)\n\n/**\n * @param {DOMElement} node\n * @param {string} name\n * @param {StylePropertyValue} value\n * @param {object} props\n * @param {string} localName\n * @param {string} ns\n */\nexport const setStyleNS = (node, name, value, props, localName, ns) =>\n\tsetNodeStyle(\n\t\tnode.style,\n\t\tisObject(value) ? value : { [localName]: value },\n\t)\n\n/**\n * @param {DOMElement} node\n * @param {string} name\n * @param {StylePropertyValue} value\n * @param {object} props\n * @param {string} localName\n * @param {string} ns\n */\nexport const setVarNS = (node, name, value, props, localName, ns) =>\n\tsetNodeStyle(node.style, { ['--' + localName]: value })\n\n/**\n * @param {CSSStyleDeclaration} style\n * @param {StylePropertyValue} value\n */\nfunction setNodeStyle(style, value) {\n\tif (isString(value)) {\n\t\tstyle.cssText = value\n\t} else if (isFunction(value)) {\n\t\twithValue(value, value => setNodeStyle(style, getValue(value)))\n\t} else if (isObject(value)) {\n\t\tfor (const name in value) {\n\t\t\tsetStyleValue(style, name, value[name])\n\t\t}\n\t}\n}\n\n/**\n * @param {DOMElement} node\n * @param {string} name\n * @param {unknown} value\n */\nexport const setElementStyle = (node, name, value) =>\n\tsetStyleValue(node.style, name, value)\n\n/**\n * @param {CSSStyleDeclaration} style\n * @param {string} name\n * @param {unknown} value\n */\nconst setStyleValue = (style, name, value) =>\n\twithValue(value, value => _setStyleValue(style, name, value))\n\n/**\n * @param {CSSStyleDeclaration} style\n * @param {string} name\n * @param {string | null} value\n */\nconst _setStyleValue = (style, name, value) =>\n\t// if the value is null or undefined it will be removed\n\tisNullUndefined(value)\n\t\t? style.removeProperty(name)\n\t\t: style.setProperty(name, value)\n","// node class / classList\n\nimport { withPrevValue, withValue } from '../lib/reactive.js'\nimport {\n\tclassListAdd,\n\tclassListRemove,\n\tisFunction,\n\tisString,\n} from '../lib/std.js'\n\n/**\n * @param {Element} node\n * @param {string} name\n * @param {object | string | ArrayLike<any>} value\n * @param {object} props\n */\nexport const setClass = (node, name, value, props) => {\n\tisString(value)\n\t\t? node.setAttribute('class', value)\n\t\t: setClassList(node, value)\n}\n\n/**\n * @param {Element} node\n * @param {string} name\n * @param {object | string | ArrayLike<any>} value\n * @param {object} props\n * @param {string} localName\n * @param {string} ns\n */\nexport const setClassNS = (\n\tnode,\n\tname,\n\tvalue,\n\tprops,\n\tlocalName,\n\tns,\n) => {\n\tisFunction(value)\n\t\t? setElementClass(node, localName, value)\n\t\t: setClassList(node, value)\n}\n\n/**\n * @param {Element} node\n * @param {object | string | ArrayLike<any>} value\n */\nfunction setClassList(node, value) {\n\tswitch (typeof value) {\n\t\tcase 'string': {\n\t\t\t_setClassListValue(node, value, true)\n\t\t\tbreak\n\t\t}\n\n\t\tcase 'object': {\n\t\t\tlet name\n\t\t\tfor (name in value) {\n\t\t\t\tsetElementClass(node, name, value[name])\n\t\t\t}\n\t\t\tbreak\n\t\t}\n\n\t\tcase 'function': {\n\t\t\twithValue(value, value => setClassList(node, value))\n\t\t\tbreak\n\t\t}\n\t}\n}\n/**\n * @param {Element} node\n * @param {string} name\n * @param {unknown} value\n */\nexport const setElementClass = (node, name, value) => {\n\twithPrevValue(value, (value, prev) => {\n\t\t// on initialization do not remove whats not there\n\t\tif (!value && !prev) {\n\t\t} else {\n\t\t\t_setClassListValue(node, name, value)\n\t\t}\n\t})\n}\n\n/**\n * @param {Element} node\n * @param {string} name\n * @param {unknown} value\n */\n\nconst _setClassListValue = (node, name, value) => {\n\t// null, undefined or false, the class is removed\n\t!value\n\t\t? classListRemove(node, name)\n\t\t: classListAdd(node, ...name.trim().split(/\\s+/))\n}\n","import { addEvent, ownedEvent } from '../lib/reactive.js'\n\n/**\n * @param {Element} node\n * @param {string} name\n * @param {EventListener\n * \t| EventListenerObject\n * \t| (EventListenerObject & AddEventListenerOptions)} value\n * @param {object} props\n * @param {string} localName\n * @param {string} ns\n */\nexport const setEventNS = (node, name, value, props, localName, ns) =>\n\t// `value &&` because avoids crash when `on:click={bla}` and `bla === null`\n\tvalue && addEvent(node, localName, ownedEvent(value))\n","import { cleanup, withValue } from '../lib/reactive.js'\nimport { isNullUndefined } from '../lib/std.js'\nimport { _setUnknown } from './unknown.js'\n\n/**\n * `value` as a prop is special cased so the button `reset` in forms\n * works as expected. The first time a value is set, its done as an\n * attribute.\n */\nexport const setValue = (node, name, value) =>\n\twithValue(value, value => _setValue(node, name, value))\n\nconst defaults = new Set()\n\nfunction _setValue(node, name, value) {\n\tif (!defaults.has(node)) {\n\t\tdefaults.add(node)\n\t\tcleanup(() => defaults.delete(node))\n\n\t\tif (!isNullUndefined(value)) {\n\t\t\tswitch (node.tagName) {\n\t\t\t\tcase 'INPUT': {\n\t\t\t\t\tnode.setAttribute('value', value)\n\t\t\t\t\treturn\n\t\t\t\t}\n\t\t\t\tcase 'TEXTAREA': {\n\t\t\t\t\tnode.textContent = value\n\t\t\t\t\treturn\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tif (!value && node.tagName === 'PROGRESS') {\n\t\tnode.removeAttribute('value')\n\t} else {\n\t\t_setUnknown(node, name, value)\n\t}\n}\n","/** Returns true or false with a `chance` of getting `true` */\nexport const chance = (chance = 50, generator = random) => {\n\treturn generator() < chance / 100\n}\n\n/** Returns random number between 0 and 1 */\nexport const random = () =>\n\tcrypto.getRandomValues(new Uint32Array(1))[0] / (0xffffffff + 1)\n\nexport const randomBetween = (\n\tmin = 0,\n\tmax = 100,\n\tgenerator = random,\n) => Math.floor(generator() * (max - min + 1)) + min\n\nexport const randomColor = (min = 0, max = 255) =>\n\t'rgb(' +\n\trandomBetween(min, max) +\n\t',' +\n\trandomBetween(min, max) +\n\t',' +\n\trandomBetween(min, max) +\n\t')'\n\nexport const randomId = () =>\n\tcrypto.getRandomValues(new BigUint64Array(1))[0].toString(36)\n\n/**\n * Returns a random number generator based on a seed that generates\n * numbers between 0 and 1\n *\n * @param {number} seed\n */\nexport function randomSeeded(seed) {\n\tconst m = 2 ** 35 - 31\n\tlet s = seed % m\n\treturn () => (s = (s * 185852) % m) / m\n}\n","import {\n\tadoptedStyleSheetsAdd,\n\tclassListAdd,\n\tgetDocumentForElement,\n\tsheet,\n\twithState,\n} from '../lib/std.js'\n\nimport { randomId } from '../plugin/useRandom.js'\n\n/**\n * @param {Element} node\n * @param {string} name\n * @param {string} value\n * @param {object} props\n */\nexport const setCSS = (node, name, value, props) => {\n\tsetNodeCSS(node, value)\n}\n\n/**\n * @param {Element} node\n * @param {string} value\n */\nconst setNodeCSS = withState((state, node, value) => {\n\tclassListAdd(\n\t\tnode,\n\t\tstate.get(value, value => {\n\t\t\tconst id = 'c' + randomId()\n\t\t\tadoptedStyleSheetsAdd(\n\t\t\t\tgetDocumentForElement(node),\n\t\t\t\tsheet(value.replace(/class/g, '.' + id)),\n\t\t\t)\n\t\t\treturn id\n\t\t}),\n\t)\n})\n","import { cleanup } from '../lib/reactive.js'\n\nimport { onMount, onRef } from '../scheduler.js'\n\n/**\n * @param {Element} node\n * @param {string} name\n * @param {Function} value\n * @param {object} props\n */\nexport const setRef = (node, name, value, props) =>\n\tonRef(() => value(node))\n\n/**\n * @param {Element} node\n * @param {string} name\n * @param {Function} value\n * @param {object} props\n */\nexport const setOnMount = (node, name, value, props) =>\n\tonMount(() => value(node))\n\n/**\n * @param {Element} node\n * @param {string} name\n * @param {Function} value\n * @param {object} props\n */\nexport const setUnmount = (node, name, value, props) =>\n\tcleanup(() => value(node))\n","import {\n\tplugins,\n\tpluginsNS,\n\tpropsPlugin,\n\tpropsPluginBoth,\n\tpropsPluginNS,\n} from './plugin.js'\nimport { setUnknown } from './unknown.js'\n\n// exports\n\nexport { setAttribute } from './attribute.js'\nexport { setBool } from './bool.js'\nexport { setProperty } from './property.js'\nexport { setUnknown } from './unknown.js'\nexport { setElementStyle as setStyle } from './style.js'\nexport { setElementClass as setClass } from './class.js'\n\n// PLUGINS NS\n\n// namespaced attributes/properties\n\nimport { setPropertyNS } from './property.js'\npropsPluginNS('prop', setPropertyNS, false)\n\nimport { setAttributeNS } from './attribute.js'\npropsPluginNS('attr', setAttributeNS, false)\n\nimport { setBoolNS } from './bool.js'\npropsPluginNS('bool', setBoolNS, false)\n\n// events\n\nimport { setEventNS } from './event.js'\npropsPluginNS('on', setEventNS, false)\n\n// var\n\nimport { setVarNS } from './style.js'\npropsPluginNS('var', setVarNS, false)\n\n// PLUGINS REGULAR\n\n// noop\n\nimport { empty, noop } from '../lib/std.js'\npropsPlugin('__dev', noop, false)\npropsPlugin('xmlns', noop, false)\n\n// value\n\nimport { setValue } from './value.js'\npropsPlugin('value', setValue, false)\n\nimport { setProperty } from './property.js'\npropsPlugin('textContent', setProperty, false)\n\n// PLUGIN BOTH\n\n// css\n\nimport { setCSS } from './css.js'\npropsPlugin('plugin:css', setCSS, false)\n\n// mount\n\nimport { setOnMount } from './lifecycle.js'\npropsPluginBoth('onMount', setOnMount, false)\n\n// unmount\n\nimport { setUnmount } from './lifecycle.js'\npropsPluginBoth('onUnmount', setUnmount, false)\n\n// ref\n\nimport { setRef } from './lifecycle.js'\npropsPluginBoth('ref', setRef, false)\n\n// PLUGIN BOTH DIFFERENT\n\n// styles\n\nimport { setStyle, setStyleNS } from './style.js'\npropsPlugin('style', setStyle, false)\npropsPluginNS('style', setStyleNS, false)\n\n// class\n\nimport { setClass, setClassNS } from './class.js'\npropsPlugin('class', setClass, false)\npropsPluginNS('class', setClassNS, false)\n\n// catch all\n\n/**\n * Assigns props to an Element\n * @template T\n * @param {Element} node - Element to which assign props\n * @param {T} props - Props to assign\n */\nexport function assignProps(node, props) {\n\tfor (const name in props) {\n\t\tassignProp(node, name, props[name], props)\n\t}\n}\n\nconst propNS = empty()\n\n/**\n * Assigns a prop to an Element\n\n * @template T\n * @param {Element} node\n * @param {string} name\n * @param {any} value\n * @param {T} props\n */\nexport function assignProp(node, name, value, props) {\n\t// run plugins\n\tlet plugin = plugins.get(name)\n\tif (plugin) {\n\t\tplugin(node, name, value, props)\n\t} else if (propNS[name] || name.includes(':')) {\n\t\t// with ns\n\t\tpropNS[name] = propNS[name] || name.split(':')\n\t\tconst [ns, localName] = propNS[name]\n\n\t\t// run plugins NS\n\t\tplugin = pluginsNS.get(ns)\n\t\tplugin\n\t\t\t? plugin(node, name, value, props, localName, ns)\n\t\t\t: setUnknown(node, name, value, ns)\n\t} else {\n\t\t// catch all\n\t\tsetUnknown(node, name, value)\n\t}\n}\n","// CONSTANTS\n\nimport { $isClass, $isMap, NS } from './constants.js'\n\n// LIB\n\nimport {\n\tcleanup,\n\tContext,\n\teffect,\n\tisReactive,\n\troot,\n\tsignal,\n\tuntrack,\n} from './lib/reactive.js'\n\nimport {\n\tadoptedStyleSheetsAdd,\n\tadoptedStyleSheetsRemove,\n\tcreateElement,\n\tcreateElementNS,\n\tcreateTextNode,\n\tCSSStyleSheet,\n\tdocument,\n\tDocumentFragment,\n\tflat,\n\tfreeze,\n\tgetDocumentForElement,\n\timportNode,\n\tisArray,\n\tisConnected,\n\titerator,\n\tnothing,\n\tquerySelector,\n\tresolved,\n\tstringify,\n\ttoArray,\n\twalkElements,\n} from './lib/std.js'\n\nimport {\n\tisComponent,\n\tisComponentable,\n\tmarkComponent,\n} from './lib/reactive.js'\n\nimport { onFixes, ready } from './scheduler.js'\n\n// PROPERTIES / ATTRIBUTES\n\nimport { assignProps } from './props/@main.js'\nimport { propsPlugin } from './props/plugin.js'\n\n// STATE\n\nconst useXMLNS = context()\n\n// COMPONENTS\n\n/**\n * Used by the regular JSX transform, as `<>...</>` or\n * `<Fragment>...</Fragment>`.\n */\nexport const Fragment = props => props.children\n\n/**\n * Creates components for things. When props argument is given, the\n * props become fixed. When props argument is ommited, it allows you\n * to keep calling the returned function with new props. Returns a\n * function because we need to render from parent to children instead\n * of from children to parent. This allows to properly set the\n * reactivity tree (think of nested effects that clear inner effects,\n * context, etc).\n *\n * @param {string | Function | Element | object | symbol} value -\n *   Component\n * @param {any} [props] Object\n * @returns {Children}\n * @url https://pota.quack.uy/Component\n */\n\nexport function Component(value, props) {\n\tif (value === Fragment) {\n\t\treturn props.children\n\t}\n\n\t/** Freeze props so isnt directly writable */\n\tfreeze(props)\n\n\t/** Create a callable function to pass `props` */\n\tconst component = Factory(value)\n\n\treturn props === undefined\n\t\t? component\n\t\t: markComponent(propsOverride =>\n\t\t\t\tcomponent(\n\t\t\t\t\tpropsOverride\n\t\t\t\t\t\t? freeze({ ...props, ...propsOverride })\n\t\t\t\t\t\t: props,\n\t\t\t\t),\n\t\t\t)\n}\n\n/**\n * Creates a component that could be called with a props object\n *\n * @template T\n * @param {any} value\n * @returns {Component}\n */\n\nfunction Factory(value) {\n\tif (isComponent(value)) {\n\t\treturn value\n\t}\n\n\tswitch (typeof value) {\n\t\tcase 'string': {\n\t\t\t// string component, 'div' becomes <div>\n\t\t\treturn markComponent(props => createTag(value, props))\n\t\t}\n\t\tcase 'function': {\n\t\t\tif ($isClass in value) {\n\t\t\t\t// class component <MyComponent../>\n\t\t\t\treturn markComponent(props => createClass(value, props))\n\t\t\t}\n\n\t\t\t/**\n\t\t\t * ```js\n\t\t\t * const [Count, setCount] = signal(1)\n\t\t\t * return <Count />\n\t\t\t * ```\n\t\t\t */\n\t\t\tif (isReactive(value)) {\n\t\t\t\treturn markComponent(() => createAnything(value))\n\t\t\t}\n\n\t\t\t// function component <MyComponent../>\n\t\t\t// value = value\n\t\t\treturn markComponent(value)\n\t\t}\n\t\tdefault: {\n\t\t\tif (value instanceof Element) {\n\t\t\t\t// node component <div>\n\t\t\t\treturn markComponent(props => createNode(value, props))\n\t\t\t}\n\n\t\t\treturn markComponent(() => createAnything(value))\n\t\t}\n\t}\n}\n\nexport function createComponent(value) {\n\tconst component = Factory(value)\n\n\treturn props => {\n\t\t/** Freeze props so isnt directly writable */\n\t\tfreeze(props)\n\t\treturn markComponent(() => component(props))\n\t}\n}\n\nfunction createClass(value, props) {\n\tconst i = new value()\n\ti.ready && ready(() => i.ready())\n\ti.cleanup && cleanup(() => i.cleanup())\n\n\treturn i.render(props)\n}\n\nfunction createAnything(value) {\n\treturn value\n}\n\n/**\n * Creates a x/html element from a tagName\n *\n * @template P\n * @param {TagNames} tagName\n * @param {P} props\n * @returns {Element} Element\n */\nfunction createTag(tagName, props) {\n\t/**\n\t * Namespace, use props xmlns or special case svg, math, etc in case\n\t * of missing xmlns attribute\n\t */\n\tconst xmlns = props?.xmlns || NS[tagName]\n\n\treturn withXMLNS(\n\t\txmlns,\n\t\txmlns =>\n\t\t\tcreateNode(\n\t\t\t\txmlns\n\t\t\t\t\t? createElementNS(xmlns, tagName)\n\t\t\t\t\t: createElement(tagName),\n\t\t\t\tprops,\n\t\t\t),\n\t\ttagName,\n\t)\n}\n\nfunction withXMLNS(xmlns, fn, tagName) {\n\tconst nsContext = useXMLNS()\n\n\tif (xmlns && xmlns !== nsContext) {\n\t\t// the xmlns changed, use the new xmlns\n\t\treturn useXMLNS(xmlns, () => fn(xmlns))\n\t}\n\n\t/**\n\t * `foreignObject` children are created with html xmlns (default\n\t * browser behaviour)\n\t */\n\tif (nsContext && tagName === 'foreignObject') {\n\t\treturn useXMLNS(NS.html, () => fn(nsContext))\n\t}\n\n\treturn fn(nsContext)\n}\n\n// PARTIALS\n\nfunction parseHTML(content, xmlns) {\n\tconst template = xmlns\n\t\t? createElementNS(xmlns, 'template')\n\t\t: createElement('template')\n\n\ttemplate.innerHTML = content\n\n\t// xml\n\tlet tlpContent = template.content\n\tif (!tlpContent) {\n\t\tconst childNodes = template.childNodes\n\t\tif (childNodes.length === 1) {\n\t\t\treturn template.firstChild\n\t\t}\n\n\t\ttlpContent = new DocumentFragment()\n\t\ttlpContent.append(...childNodes)\n\t}\n\n\treturn tlpContent.childNodes.length === 1\n\t\t? tlpContent.firstChild\n\t\t: tlpContent\n}\n\n/**\n * @param {string} content\n * @param {{\n * \tx?: string\n * \ti?: boolean\n * \tm?: number\n * }} propsData\n */\nexport function createPartial(content, propsData = nothing) {\n\tlet clone = () => {\n\t\tconst node = withXMLNS(propsData.x, xmlns =>\n\t\t\tparseHTML(content, xmlns),\n\t\t)\n\n\t\tclone = propsData.i\n\t\t\t? importNode.bind(null, node, true)\n\t\t\t: node.cloneNode.bind(node, true)\n\t\treturn clone()\n\t}\n\n\treturn props =>\n\t\tmarkComponent(() => assignPartialProps(clone(), props, propsData))\n}\n\nfunction assignPartialProps(node, props, propsData) {\n\tif (props) {\n\t\tconst nodes = walkElements(node, propsData.m)\n\n\t\twithXMLNS(propsData.x, xmlns => {\n\t\t\tfor (let i = 0; i < props.length; i++) {\n\t\t\t\tassignProps(nodes[propsData[i] || i], props[i])\n\t\t\t}\n\t\t})\n\t}\n\n\treturn node instanceof DocumentFragment\n\t\t? toArray(node.childNodes)\n\t\t: node\n}\n\n/**\n * Assigns props to an element and creates its children\n *\n * @template P\n * @param {Element} node\n * @param {P} props\n * @returns {Element} Element\n */\nfunction createNode(node, props) {\n\tprops && assignProps(node, props)\n\n\treturn node\n}\n\n/**\n * Creates the children for a parent\n *\n * @param {Element} parent\n * @param {Children} child\n * @param {boolean} [relative]\n * @param {Text | undefined} [prev]\n */\nfunction createChildren(\n\tparent,\n\tchild,\n\trelative = false,\n\tprev = undefined,\n) {\n\tswitch (typeof child) {\n\t\t// string/number\n\t\tcase 'string':\n\t\tcase 'number': {\n\t\t\tif (prev instanceof Text) {\n\t\t\t\tprev.nodeValue = child\n\t\t\t\treturn prev\n\t\t\t}\n\n\t\t\t/**\n\t\t\t * The text node could be created by just doing\n\t\t\t * `parent.textContent = value` when the parent node has no\n\t\t\t * children.\n\t\t\t */\n\t\t\tif (!relative && parent.childNodes.length === 0) {\n\t\t\t\tparent.textContent = child\n\t\t\t\treturn parent.firstChild\n\t\t\t}\n\n\t\t\treturn insertNode(parent, createTextNode(child), relative)\n\t\t}\n\n\t\tcase 'function': {\n\t\t\t// component\n\t\t\tif (isComponent(child)) {\n\t\t\t\treturn createChildren(parent, untrack(child), relative)\n\t\t\t}\n\n\t\t\tlet node = []\n\n\t\t\t// signal/memo/external/user provided function\n\t\t\t// needs placeholder to stay in position\n\t\t\tparent = createPlaceholder(parent, relative)\n\n\t\t\t// For - TODO move this to the `For` component\n\t\t\t$isMap in child\n\t\t\t\t? effect(() => {\n\t\t\t\t\t\tnode = toDiff(\n\t\t\t\t\t\t\tnode,\n\t\t\t\t\t\t\tchild(child => {\n\t\t\t\t\t\t\t\t/**\n\t\t\t\t\t\t\t\t * Wrap the item with placeholders, for when stuff in\n\t\t\t\t\t\t\t\t * between moves. If a `Show` adds and removes nodes,\n\t\t\t\t\t\t\t\t * we dont have a reference to these nodes. By\n\t\t\t\t\t\t\t\t * delimiting with a shore, we can just handle\n\t\t\t\t\t\t\t\t * anything in between as a group.\n\t\t\t\t\t\t\t\t */\n\t\t\t\t\t\t\t\tconst begin = createPlaceholder(parent, true)\n\t\t\t\t\t\t\t\tconst end = createPlaceholder(parent, true)\n\t\t\t\t\t\t\t\treturn [begin, createChildren(end, child, true), end]\n\t\t\t\t\t\t\t}),\n\t\t\t\t\t\t\ttrue,\n\t\t\t\t\t\t)\n\t\t\t\t\t})\n\t\t\t\t: effect(() => {\n\t\t\t\t\t\t// maybe a signal (at least a function) so needs an effect\n\t\t\t\t\t\tnode = toDiff(\n\t\t\t\t\t\t\tnode,\n\t\t\t\t\t\t\t[createChildren(parent, child(), true, node[0])].flat(\n\t\t\t\t\t\t\t\tInfinity,\n\t\t\t\t\t\t\t),\n\t\t\t\t\t\t\ttrue,\n\t\t\t\t\t\t)\n\t\t\t\t\t})\n\n\t\t\tcleanup(() => {\n\t\t\t\ttoDiff(node)\n\t\t\t\tparent.remove()\n\t\t\t})\n\n\t\t\t/**\n\t\t\t * A placeholder is created and added to the document but doesnt\n\t\t\t * form part of the children. The placeholder needs to be\n\t\t\t * returned so it forms part of the group of children. If\n\t\t\t * children are moved and the placeholder is not moved with\n\t\t\t * them, then, whenever children update these will be at the\n\t\t\t * wrong place. wrong place: where the placeholder is and not\n\t\t\t * where the children were moved to\n\t\t\t */\n\t\t\treturn parent\n\t\t}\n\n\t\tcase 'object': {\n\t\t\t// Node/DocumentFragment\n\t\t\tif (child instanceof Node) {\n\t\t\t\t/**\n\t\t\t\t * DocumentFragment are special as only the children get added\n\t\t\t\t * to the document and the document becomes empty. If we dont\n\t\t\t\t * insert them 1 by 1 then we wont have a reference to them\n\t\t\t\t * for deletion on cleanup with node.remove()\n\t\t\t\t */\n\t\t\t\tif (child instanceof DocumentFragment) {\n\t\t\t\t\treturn createChildren(\n\t\t\t\t\t\tparent,\n\t\t\t\t\t\ttoArray(child.childNodes),\n\t\t\t\t\t\trelative,\n\t\t\t\t\t)\n\t\t\t\t}\n\t\t\t\treturn insertNode(parent, child, relative)\n\t\t\t}\n\n\t\t\t// children/fragments\n\t\t\tif (isArray(child)) {\n\t\t\t\treturn child.length === 1\n\t\t\t\t\t? createChildren(parent, child[0], relative)\n\t\t\t\t\t: child.map(child =>\n\t\t\t\t\t\t\tcreateChildren(parent, child, relative),\n\t\t\t\t\t\t)\n\t\t\t}\n\n\t\t\t/**\n\t\t\t * The value is `null`, as in {null} or like a show returning\n\t\t\t * `null` on the falsy case\n\t\t\t */\n\t\t\tif (child === null) {\n\t\t\t\treturn undefined\n\t\t\t}\n\n\t\t\t// async components\n\t\t\tif ('then' in child) {\n\t\t\t\tconst [value, setValue] = signal(undefined)\n\n\t\t\t\tconst onResult = result =>\n\t\t\t\t\tisConnected(parent) && setValue(result)\n\n\t\t\t\tresolved(child, onResult)\n\n\t\t\t\treturn createChildren(parent, value, relative)\n\t\t\t}\n\n\t\t\t// iterable/Map/Set/NodeList\n\t\t\tif (iterator in child) {\n\t\t\t\treturn createChildren(\n\t\t\t\t\tparent,\n\t\t\t\t\ttoArray(/** @type Iterator */ child.values()),\n\t\t\t\t\trelative,\n\t\t\t\t)\n\t\t\t\t/**\n\t\t\t\t * For some reason this breaks with a node list in the\n\t\t\t\t * `Context` example of the `html` docs section.\n\t\t\t\t *\n\t\t\t\t *     return toArray(child.values(), child =>\n\t\t\t\t *     \tcreateChildren(parent, child, relative),\n\t\t\t\t *     )\n\t\t\t\t */\n\t\t\t}\n\n\t\t\t// CSSStyleSheet\n\t\t\tif (child instanceof CSSStyleSheet) {\n\t\t\t\t/**\n\t\t\t\t * Custom elements wont report a document unless is already\n\t\t\t\t * connected. So our stylesheet would end on the main document\n\t\t\t\t * instead of the shadowRoot\n\t\t\t\t */\n\t\t\t\tonFixes(() => {\n\t\t\t\t\tif (isConnected(parent)) {\n\t\t\t\t\t\tconst doc = getDocumentForElement(parent)\n\t\t\t\t\t\tadoptedStyleSheetsAdd(doc, child)\n\n\t\t\t\t\t\tcleanup(() => adoptedStyleSheetsRemove(doc, child))\n\t\t\t\t\t}\n\t\t\t\t})\n\n\t\t\t\treturn undefined\n\t\t\t}\n\n\t\t\t// object.toString fancy objects\n\t\t\treturn createChildren(\n\t\t\t\tparent,\n\t\t\t\t// Object.create(null) would fail to convert to string\n\t\t\t\t'toString' in child ? child.toString() : stringify(child),\n\t\t\t\trelative,\n\t\t\t)\n\t\t}\n\t\tcase 'undefined': {\n\t\t\treturn undefined\n\t\t}\n\t\tdefault: {\n\t\t\t// boolean/bigint/symbol/catch all\n\t\t\t// toString() is needed for `Symbol`\n\t\t\treturn insertNode(\n\t\t\t\tparent,\n\t\t\t\tcreateTextNode(/** @type object */ child.toString()),\n\t\t\t\trelative,\n\t\t\t)\n\t\t}\n\t}\n}\n\npropsPlugin(\n\t'children',\n\t(node, propName, propValue) => createChildren(node, propValue),\n\tfalse,\n)\n\n/**\n * Creates placeholder to keep nodes in position\n *\n * @param {Element} parent\n * @param {boolean} [relative]\n * @returns {Element}\n */\nconst createPlaceholder = (parent, relative) =>\n\tinsertNode(parent, createTextNode(''), relative)\n\nconst head = document.head\n\n/**\n * Adds the element to the document\n *\n * @param {Element} parent\n * @param {Element} node\n * @param {boolean} [relative]\n * @returns {Element}\n */\n\nfunction insertNode(parent, node, relative) {\n\t// special case `head`\n\tif (parent === head) {\n\t\tconst name = node.tagName\n\n\t\t// search for tags that should be unique\n\t\tlet prev\n\t\tif (name === 'TITLE') {\n\t\t\tprev = querySelector(head, 'title')\n\t\t} else if (name === 'META') {\n\t\t\tprev =\n\t\t\t\tquerySelector(\n\t\t\t\t\thead,\n\t\t\t\t\t'meta[name=\"' + node.getAttribute('name') + '\"]',\n\t\t\t\t) ||\n\t\t\t\tquerySelector(\n\t\t\t\t\thead,\n\t\t\t\t\t'meta[property=\"' + node.getAttribute('property') + '\"]',\n\t\t\t\t)\n\t\t} else if (name === 'LINK' && node.rel === 'canonical') {\n\t\t\tprev = querySelector(head, 'link[rel=\"canonical\"]')\n\t\t}\n\n\t\t// replace old node if there's any\n\t\tprev ? prev.replaceWith(node) : parent.appendChild(node)\n\t} else {\n\t\trelative ? parent.before(node) : parent.appendChild(node)\n\t}\n\n\treturn node\n}\n\n// RENDERING\n\n/**\n * WARNINGS Removal of the element on where you render/insert into,\n * wont cause disposal of what you render/insert.\n */\n\n/**\n * Inserts children into a parent\n *\n * @param {any} children - Thing to render\n * @param {Element} [parent] - Mount point, defaults to document.body\n * @param {{ clear?: boolean; relative?: boolean }} [options] -\n *   Mounting options\n * @returns {() => void} Disposer\n * @url https://pota.quack.uy/render\n */\nexport function render(children, parent, options = nothing) {\n\tconst dispose = root(dispose => {\n\t\tinsert(children, parent, options)\n\t\treturn dispose\n\t})\n\n\t// run dispose when the parent scope disposes\n\tcleanup(dispose)\n\n\treturn dispose\n}\n\n/**\n * @param {any} children - Thing to render\n * @param {Element} [parent] - Mount point, defaults to\n *   `document.body`\n * @param {{ clear?: boolean; relative?: boolean }} [options] -\n *   Mounting options\n */\nexport function insert(\n\tchildren,\n\tparent = document.body,\n\toptions = nothing,\n) {\n\tif (options.clear && parent) parent.textContent = ''\n\n\tconst node = createChildren(\n\t\tparent,\n\t\tisComponentable(children) ? Factory(children) : children,\n\t\toptions.relative,\n\t)\n\n\tcleanup(() => toDiff([node].flat(Infinity)))\n\n\treturn node\n}\n\n/**\n * Creates and returns HTML Elements for `children`\n *\n * @param {Children} children\n * @returns {Children}\n * @url https://pota.quack.uy/toHTML\n */\nexport const toHTML = children =>\n\t/**\n\t * DocumentFragment is transformed to an `Array` of `Node/Element`,\n\t * that way we can keep a reference to the nodes. Because when the\n\t * DocumentFragment is used, it removes the nodes from the\n\t * DocumentFragment and then we will lose the reference.\n\t */\n\n\tflat(toHTMLFragment(children).childNodes)\n\n/**\n * Creates and returns a DocumentFragment for `children`\n *\n * @param {Children} children\n * @returns {DocumentFragment}\n * @url https://pota.quack.uy/toHTML\n */\nexport function toHTMLFragment(children) {\n\tconst fragment = new DocumentFragment()\n\tcreateChildren(fragment, children)\n\n\treturn fragment\n}\n\n/**\n * Creates a context and returns a function to get or set the value\n *\n * @param {any} [defaultValue] - Default value for the context\n * @returns {Function & { Provider: ({ value }) => Children }}\n *   Context\n * @url https://pota.quack.uy/Reactivity/Context\n */\n/* #__NO_SIDE_EFFECTS__ */ export function context(\n\tdefaultValue = undefined,\n) {\n\t/** @type {Function & { Provider: ({ value }) => Children }} */\n\tconst ctx = Context(defaultValue)\n\n\t/**\n\t * Sets the `value` for the context\n\t *\n\t * @param {object} props\n\t * @param {any} props.value\n\t * @param {Children} [props.children]\n\t * @returns {Children} Children\n\t * @url https://pota.quack.uy/Reactivity/Context\n\t */\n\tctx.Provider = props =>\n\t\tctx(props.value, () => toHTML(props.children))\n\n\treturn ctx\n}\n\n/**\n * Removes from the DOM `prev` elements not found in `next`\n *\n * @param {Element[]} prev - Array with previous elements\n * @param {Element[]} next - Array with next elements\n * @returns {Element[]}\n */\nfunction toDiff(prev = [], next = [], short = false) {\n\t// if theres something to remove\n\tif (prev.length) {\n\t\tconst nextLength = next.length\n\n\t\t// fast clear\n\t\tif (\n\t\t\tshort &&\n\t\t\tnextLength === 0 &&\n\t\t\t// + 1 because of the original placeholder\n\t\t\tprev.length + 1 === prev[0].parentNode.childNodes.length\n\t\t) {\n\t\t\tconst parent = prev[0].parentNode\n\t\t\t// save the placeholder\n\t\t\tconst lastChild = parent.lastChild\n\t\t\tparent.textContent = ''\n\t\t\tparent.appendChild(lastChild)\n\t\t} else {\n\t\t\tfor (const item of prev) {\n\t\t\t\tif (item && (nextLength === 0 || !next.includes(item))) {\n\t\t\t\t\titem.remove()\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\treturn next\n}\n","import {\n\taddStyleSheets,\n\temit,\n\tisString,\n\tquerySelector,\n\tremoveAttribute,\n\tsetAttribute,\n} from '../lib/std.js'\n\nimport { Component, toHTMLFragment } from '../renderer.js'\n\n/**\n * Defines a custom Element (if isnt defined already)\n *\n * @param {string} name - Name for the custom element\n * @param {CustomElementConstructor} constructor - Class for the\n *   custom element\n * @param {ElementDefinitionOptions} [options] - Options passed to\n *   `customElements.define`\n */\nexport function customElement(name, constructor, options) {\n\tif (customElements.get(name) === undefined) {\n\t\tcustomElements.define(name, constructor, options)\n\t}\n}\n\nexport class CustomElement extends HTMLElement {\n\tconstructor() {\n\t\tsuper()\n\n\t\tconst shadowRoot = this.attachShadow({\n\t\t\tmode: 'open',\n\t\t})\n\n\t\t// this is needed because `baseStyleSheets/styleSheets` are `static`\n\t\tconst constructor = this.constructor\n\n\t\taddStyleSheets(shadowRoot, constructor.baseStyleSheets)\n\t\taddStyleSheets(shadowRoot, constructor.styleSheets)\n\t}\n\n\t/* DOM API */\n\n\t/**\n\t * Shortcut for querySelector\n\t *\n\t * @param {string} query\n\t */\n\tquery(query) {\n\t\treturn querySelector(this, query)\n\t}\n\t/**\n\t * Shortcut for this.shadowRoot.innerHTML\n\t *\n\t * @param {string | Component} value\n\t */\n\tset html(value) {\n\t\tif (isString(value)) {\n\t\t\tthis.shadowRoot.innerHTML = value\n\t\t} else {\n\t\t\tthis.shadowRoot.replaceChildren(\n\t\t\t\ttoHTMLFragment(Component(value || 'slot')),\n\t\t\t)\n\t\t}\n\t}\n\n\t/**\n\t * Toggles attribute `hidden`\n\t *\n\t * @param {boolean} value\n\t */\n\tset hidden(value) {\n\t\tvalue\n\t\t\t? setAttribute(this, 'hidden', '')\n\t\t\t: removeAttribute(this, 'hidden')\n\t}\n\n\t/* EVENTS API */\n\n\t/**\n\t * Emits an event\n\t *\n\t * @param {string} eventName\n\t * @param {any} [data]\n\t */\n\temit(eventName, data) {\n\t\temit(this, eventName, data)\n\t}\n\n\t/* SLOTS API */\n\n\thasSlot(name) {\n\t\treturn this.query(`:scope [slot=\"${name}\"]`)\n\t}\n}\n","import { css } from '../lib/std.js'\n\nimport { Component } from '../renderer.js'\nimport { CustomElement, customElement } from './CustomElement.js'\n\n/**\n * Similar to `Show`, but doesn't remove its children from the\n * document\n *\n * @template T\n * @param {{\n * \twhen: When<T>\n * \tchildren?: Children\n * \tfallback?: Children\n * }} props\n * @returns {Children}\n * @url https://pota.quack.uy/Components/Collapse\n */\nexport function Collapse(props) {\n\t// need to include the class here because else its not treeshaked\n\tclass CollapseElement extends CustomElement {\n\t\tstatic styleSheets = [\n\t\t\tcss`\n\t\t\t\t:host {\n\t\t\t\t\tdisplay: contents;\n\t\t\t\t}\n\t\t\t`,\n\t\t]\n\n\t\t/** @param {any} value - To toggle children */\n\t\tset when(value) {\n\t\t\tthis.html = value ? '<slot/>' : props.fallback || ''\n\t\t}\n\t}\n\n\tconst name = 'pota-collapse'\n\n\tcustomElement(name, CollapseElement)\n\n\treturn Component(name, {\n\t\twhen: props.when,\n\t\tchildren: props.children,\n\t})\n}\n","import { Component } from '../renderer.js'\n\n/**\n * Creates components dynamically\n *\n * @template props\n * @param {{\n * \tcomponent: Component\n * } & props} props\n * @url https://pota.quack.uy/Components/Dynamic\n */\n\nexport const Dynamic = props =>\n\t// `component` needs to be deleted else it will end in the tag as an attribute\n\tComponent(props.component, { ...props, component: undefined })\n","import { makeCallback, map } from '../lib/reactive.js'\nimport {\n\tactiveElement,\n\tdocumentElement,\n\tisConnected,\n} from '../lib/std.js'\n\nimport { onFixes } from '../scheduler.js'\n\n/**\n * Renders reactive values from an signal that returns an Iterable\n * object\n *\n * @template T\n * @param {object} props\n * @param {Each<T>} props.each\n * @param {boolean} [props.restoreFocus] - If the focused element\n *   moves it may lose focus\n * @param {Children} [props.children]\n * @param {Children} [props.fallback]\n * @returns {Children}\n * @url https://pota.quack.uy/Components/For\n */\n\nexport const For = props =>\n\tmap(\n\t\t() => {\n\t\t\tprops.restoreFocus && queue()\n\t\t\treturn props.each\n\t\t},\n\t\tmakeCallback(props.children),\n\t\ttrue,\n\t\tprops.fallback,\n\t)\n\n/** @type {boolean} */\nlet queued\n\n// because re-ordering the elements trashes focus\nfunction queue() {\n\tif (!queued) {\n\t\tqueued = true\n\n\t\tconst active = activeElement()\n\t\tconst scroll = documentElement.scrollTop\n\n\t\tonFixes(() => {\n\t\t\tqueued = false\n\t\t\t// re-ordering the elements trashes focus\n\t\t\tactive &&\n\t\t\t\tactive !== activeElement() &&\n\t\t\t\tisConnected(active) &&\n\t\t\t\tactive.focus()\n\n\t\t\tdocumentElement.scrollTop = scroll\n\t\t})\n\t}\n}\n","import { insert } from '../renderer.js'\n\n/**\n * Portals children to a different element while keeping the original\n * scope\n *\n * @param {object} props\n * @param {Element} props.mount\n * @param {Children} [props.children]\n * @url https://pota.quack.uy/Components/Portal\n */\nexport function Portal(props) {\n\tinsert(props.children, props.mount)\n}\n","import { document } from '../lib/std.js'\nimport { Component } from '../renderer.js'\nimport { Portal } from './Portal.js'\n\n/**\n * Mounts children on `document.head`\n *\n * @param {{\n * \tchildren?: Children\n * }} props\n * @returns {Children}\n * @url https://pota.quack.uy/Components/Head\n */\nexport const Head = props =>\n\tComponent(Portal, {\n\t\tmount: document.head,\n\t\tchildren: props.children,\n\t})\n","import { range } from '../lib/std.js'\nimport { Component } from '../renderer.js'\nimport { For } from './For.js'\n\n/**\n * Renders children based on the range function arguments\n *\n * @param {object} props\n * @param {number} props.start\n * @param {number} props.stop\n * @param {number} props.step\n * @param {Children} [props.children]\n * @returns {Children}\n */\n\nexport function Range(props) {\n\tconst result = range(\n\t\tprops.start ?? 0,\n\t\tprops.stop ?? 0,\n\t\tprops.step ?? 1,\n\t)\n\treturn Component(For, {\n\t\teach: Array.from(result),\n\t\tchildren: props.children,\n\t})\n}\n","import {\n\tdocument,\n\tlocation,\n\tquerySelector,\n\twindow,\n} from '../lib/std.js'\n\n/**\n * Scrolls to an element\n *\n * @param {Element} item - Element to scroll to\n */\nexport function scrollToElement(item) {\n\t/** Scroll children of element to the top */\n\titem.scrollTop = 0\n\n\t/** Scroll to element */\n\titem.scrollIntoView(true)\n}\n\n/** Scrolls to `window.location.hash` */\nexport const scrollToLocationHash = () =>\n\tscrollToSelector(location.hash)\n\n/**\n * Scrolls to element that matches the hash\n *\n * @param {string} selector - Hash to scroll to\n * @returns {boolean} True on success\n */\nexport function scrollToSelector(selector) {\n\tif (selector) {\n\t\ttry {\n\t\t\t// selector could be invalid\n\t\t\tconst item = querySelector(document, selector)\n\t\t\tif (item) {\n\t\t\t\tscrollToElement(item)\n\t\t\t\treturn true\n\t\t\t}\n\t\t} catch (e) {}\n\t}\n\treturn false\n}\n\n/**\n * Scrolls to hash and in case isnt found it scrolls to the top\n *\n * @param {string} selector - Hash to scroll to\n */\nexport function scrollToSelectorWithFallback(selector) {\n\tif (!scrollToSelector(selector)) scrollToTop()\n}\n\n/** Scrolls to the top of the window */\nexport const scrollToTop = () =>\n\twindow.scrollTo({ top: 0, behavior: 'auto' })\n","import { global } from '../lib/std.js'\n\nexport const cleanLink = v => v.replace(/[\\.,\"]$/, '')\n\nexport const encodeURIComponent = global.encodeURIComponent\n\n/**\n * Safe guard. `decodeURIComponent` will fail with malformed strings:\n * links are copied, pasted, manipulated by people, software etc\n *\n * @param {string} string - String to decode\n * @returns {string} Returns decoded string or original string on\n *   error\n */\nfunction _decodeURIComponent(string) {\n\ttry {\n\t\treturn decodeURIComponent(string)\n\t} catch (e) {\n\t\treturn string\n\t}\n}\nexport { _decodeURIComponent as decodeURIComponent }\n\n/**\n * Returns true if the link is absolute: starts with '/', '#' or\n * 'http'\n *\n * @param {string} href - Url\n * @returns {boolean} Returns true if the link is absolute\n */\nexport const isAbsolute = href =>\n\thref[0] === '/' || href[0] === '#' || /^http/.test(href)\n\n/**\n * Returns true if the link is external. It does so by checking that\n * window.location.origin is present at the beginning of the url\n *\n * @param {string} url - Url\n * @returns {boolean} Returns true if the link is external\n */\nexport const isExternal = url =>\n\t// origin could be http://example.net and link could be http://example.net.ha.com, so add \"/\"\n\t/^http/.test(url) && !(url + '/').startsWith(origin + '/')\n\n/**\n * Returns true if the link is relative\n *\n * @param {string} url - Url\n * @returns {boolean} Returns true if the link relative\n */\nexport const isRelative = url => !isAbsolute(url)\n\n/**\n * Replace params in an url for the encoded equivalent\n *\n * @param {string | undefined} url - Url\n * @param {object} [params] - Key-value pair to replace\n * @returns {string} Url with the params replaced\n */\nexport const replaceParams = (url, params) =>\n\tparams\n\t\t? url.replace(/\\:([a-z0-9_\\-]+)/gi, (a, b) =>\n\t\t\t\t// only replace the ones defined on params\n\t\t\t\tparams[b] !== undefined ? encodeURIComponent(params[b]) : a,\n\t\t\t)\n\t\t: url\n","import { memo, signal } from '../../lib/reactive.js'\nimport { nothing, removeFromArray } from '../../lib/std.js'\n\nimport { context } from '../../renderer.js'\n\n/* #__NO_SIDE_EFFECTS__ */ export function create(props = nothing) {\n\tconst [children, setChildren, updateChildren] = signal([])\n\n\treturn {\n\t\tbase: '', // the composed base route\n\t\thref: () => '', // the url of the route\n\t\tparent: undefined, // parent context\n\t\tshow: () => false, // if the route is shown\n\t\tparams: () => () => nothing, // params of the route\n\t\tscroll: [], // elements to scroll\n\t\t// the children routes\n\t\taddChildren: child => {\n\t\t\tupdateChildren(children => {\n\t\t\t\tchildren.push(child)\n\t\t\t\treturn [...children]\n\t\t\t})\n\t\t},\n\t\tremoveChildren: child => {\n\t\t\tupdateChildren(children => {\n\t\t\t\tremoveFromArray(children, child)\n\t\t\t\treturn [...children]\n\t\t\t})\n\t\t},\n\t\tnoneMatch: memo(() => {\n\t\t\treturn (\n\t\t\t\t/**\n\t\t\t\t * If doesnt have siblings then is not a 404\n\t\t\t\t *\n\t\t\t\t * @example\n\t\t\t\t * \t<Route>\n\t\t\t\t * \t<Component/> <Router.Default/> <-- Router.Default should never render\n\t\t\t\t * \t</Route>\n\t\t\t\t */\n\t\t\t\tchildren().length &&\n\t\t\t\t// when it has sibling, check if at least 1 rendered\n\t\t\t\tchildren().every(children => !children.show())\n\t\t\t)\n\t\t}),\n\t\t// override\n\t\t...props,\n\t}\n}\n\nexport const Context = context(create())\n","import { memo, signal } from '../lib/reactive.js'\nimport {\n\tdocument,\n\tempty,\n\tentries,\n\thistory,\n\tnothing,\n\toptional,\n\torigin,\n\tpreventDefault,\n\twalkParents,\n\tlocation as wLocation,\n} from '../lib/std.js'\n\nimport { scrollToSelectorWithFallback } from './useScroll.js'\n\nimport {\n\tdecodeURIComponent,\n\tisExternal,\n\treplaceParams,\n} from './useURL.js'\n\nimport { Context } from '../web/router/context.js'\nimport { useTimeout } from './useTimeout.js'\n\n// window.location signal\n\nconst [getLocation, setLocation] = signal(wLocation, {\n\tequals: false,\n})\n\n// only trigger on what changed\n\nconst protocol = wLocation.protocol\nconst protocolIsBlob = protocol === 'blob:' // for playgrounds\nconst protocolIsFile = protocol === 'file:' // for electron\n\nconst pathname = memo(() =>\n\tprotocolIsFile ? '' : getLocation().pathname,\n)\nconst search = memo(() => getLocation().search)\nconst href = memo(() => getLocation().href)\n\n// http://location/# reports hash to be empty\n// http://location/ reports hash to be empty\n// handle this difference by checking if \"#\" is at the end of `href`\nconst hash = memo(() => getLocation().hash || '#')\n\n/**\n * @typedef {object} location\n * @property {SignalAccessor<string>} href - The full url\n * @property {SignalAccessor<string>} pathname - Mirror of\n *   window.location.pathname\n * @property {SignalAccessor<string>} hash - Everything after #\n * @property {SignalAccessor<string>} path - Pathname + hash\n * @property {SignalAccessor<string>} query - Key value pairs with\n *   search params\n * @property {Function} params - Key value pairs with route params\n */\n\n/** @type location */\nexport const location = {\n\thref,\n\tpathname,\n\thash,\n\tpath: memo(() => pathname() + hash()),\n\tquery: memo(() => {\n\t\tconst value = search()\n\t\tconst searchParams = empty()\n\t\tconst params = new URL(origin + '/' + value).searchParams\n\t\tfor (const [key, value] of params.entries()) {\n\t\t\tsearchParams[key] = value\n\t\t}\n\t\treturn searchParams\n\t}),\n\tparams: () => {\n\t\tconst routes = []\n\t\twalkParents(Context(), 'parent', context => {\n\t\t\troutes.push(context.params)\n\t\t})\n\t\tconst params = empty()\n\n\t\tfor (const param of routes) {\n\t\t\t// `|| params` because when nothing is found the result is undefined\n\t\t\tfor (const [key, value] of entries(param()() || nothing)) {\n\t\t\t\tparams[key] =\n\t\t\t\t\tvalue !== undefined ? decodeURIComponent(value) : value\n\t\t\t}\n\t\t}\n\t\treturn params\n\t},\n}\n\nlet BeforeLeave = []\n\n/**\n * Run code before leaving the route, return or resolve to false to\n * reject, return true to continue\n *\n * @param {Function | Promise<unknown>} callback - Run before leaving\n *   the route\n * @url https://pota.quack.uy/Components/Router/useBeforeLeave\n */\nexport const useBeforeLeave = callback => {\n\taddListeners()\n\n\tBeforeLeave.push({\n\t\thref: Context().href() || wLocation.href,\n\t\tcallback,\n\t})\n}\n\n/**\n * Returns a boolean telling if navigation is allowed\n *\n * @param {string} href\n * @returns {Promise<boolean>}\n */\nasync function canNavigate(href) {\n\tconst newBeforeLeave = []\n\tfor (const beforeLeave of BeforeLeave) {\n\t\tif (href.indexOf(beforeLeave.href) !== 0) {\n\t\t\tif (!(await beforeLeave.callback().catch(() => false)))\n\t\t\t\treturn false\n\t\t} else {\n\t\t\tnewBeforeLeave.push(beforeLeave)\n\t\t}\n\t}\n\tBeforeLeave = newBeforeLeave\n\treturn true\n}\n\n/**\n * Navigates to a new location\n *\n * @param {string} href\n * @param {{ scroll?: boolean; replace?: boolean }} options\n * @url https://pota.quack.uy/Components/Router/Navigate\n */\nasync function navigate(href, options = nothing) {\n\tif (wLocation.href !== href) {\n\t\tif (await canNavigate(href)) {\n\t\t\tconst fn = () => navigateInternal(href, options)\n\t\t\t// navigate with transition if available\n\t\t\tdocument.startViewTransition &&\n\t\t\twLocation.href.replace(/#.*/, '') !== href.replace(/#.*/, '')\n\t\t\t\t? document.startViewTransition(fn)\n\t\t\t\t: fn()\n\t\t}\n\t}\n}\n\nfunction navigateInternal(href, options) {\n\tif (options.replace) {\n\t\thistory.replaceState(null, '', href)\n\t} else {\n\t\thistory.pushState(null, '', href)\n\t}\n\tsetLocation(wLocation)\n\n\tif (optional(options.scroll)) {\n\t\tscrollToSelectorWithFallback(wLocation.hash)\n\t}\n}\n\n/**\n * Navigates to a new location programmatically\n *\n * @param {string} href\n * @param {{\n * \tparams?: object\n * \tscroll?: boolean\n * \treplace?: boolean\n * \tdelay?: number\n * }} options\n * @url https://pota.quack.uy/Components/Router/Navigate\n */\nfunction navigateUser(href, options = nothing) {\n\taddListeners()\n\n\thref = replaceParams(href, options.params)\n\n\t/**\n\t * When the user provides the url, it may pass a relative path, this\n\t * makes it absolute\n\t */\n\thref = href.startsWith('http')\n\t\t? href\n\t\t: new URL(href, wLocation.href).href\n\n\tconst nav = () => navigate(href, options)\n\n\toptions.delay ? useTimeout(nav, options.delay).start() : nav()\n}\nexport { navigateUser as navigate }\n\n/**\n * Navigates to a new location from JSX\n *\n * @param {{\n * \thref: string\n * \tscroll?: boolean\n * \treplace?: boolean\n * \tparams?: object\n * \tdelay?: number\n * }} props\n * @url https://pota.quack.uy/Components/Router/Navigate\n */\nexport function Navigate(props) {\n\taddListeners()\n\tnavigateUser(props.href, props)\n\treturn props.children\n}\n\n// listeners\n\nlet addListenersAdded = false\n\nexport function addListeners() {\n\tif (!addListenersAdded) {\n\t\taddListenersAdded = true\n\n\t\tdocument.addEventListener('click', onLinkClick)\n\n\t\taddEventListener('hashchange', onLocationChange)\n\t\taddEventListener('popstate', onLocationChange)\n\t}\n}\n\n// listen when using browser buttons\n// safe to use async as its on a listener\nasync function onLocationChange() {\n\t// chrome has a bug on which if you use the back/forward button\n\t// it will change the title of the tab to whatever it was before\n\t// if the navigation is prevented (therefore the title/page wont change)\n\t// it will still use the old title even if the title tag didn't change at all\n\tconst title = document.title\n\tdocument.title = title + ' '\n\tdocument.title = title\n\n\tif (await canNavigate(wLocation.href)) {\n\t\tsetLocation(wLocation)\n\t} else {\n\t\thistory.pushState(null, '', location.href())\n\t}\n}\n\nfunction onLinkClick(e) {\n\tif (\n\t\te.defaultPrevented ||\n\t\te.button !== 0 ||\n\t\te.metaKey ||\n\t\te.altKey ||\n\t\te.ctrlKey ||\n\t\te.shiftKey\n\t)\n\t\treturn\n\n\t// find link\n\tconst node = e\n\t\t.composedPath()\n\t\t.find(item => item instanceof HTMLAnchorElement)\n\n\t// validate\n\tif (\n\t\t!node ||\n\t\t!node.href ||\n\t\tnode.download ||\n\t\tnode.target ||\n\t\t// !node.href.startsWith('http') || // when using a different protocol\n\t\t(!protocolIsBlob && protocol !== node.protocol) ||\n\t\tisExternal(node.href) ||\n\t\t(node.rel && node.rel.split(/\\s/).includes('external'))\n\t) {\n\t\treturn\n\t}\n\n\tpreventDefault(e)\n\n\tnavigate(node.href, {\n\t\treplace: node.replace,\n\t})\n}\n","import { makeCallback, memo, resolve } from '../lib/reactive.js'\n\nimport { getValue, isFunction, isNullUndefined } from '../lib/std.js'\n\n/**\n * Renders its children based on a condition\n *\n * @template T\n * @param {object} props\n * @param {When<T>} props.when\n * @param {Children} [props.fallback]\n * @param {Children} [props.children]\n * @returns {Children}\n * @url https://pota.quack.uy/Components/Show\n */\nexport function Show(props) {\n\t// fallback\n\tconst fallback = isNullUndefined(props.fallback)\n\t\t? undefined\n\t\t: memo(() => resolve(props.fallback))\n\n\t// callback\n\tconst callback = makeCallback(props.children)\n\n\t// shortcircuit non-functions\n\tif (!isFunction(props.when)) {\n\t\treturn props.when ? callback(() => props.when) : fallback\n\t}\n\n\t// signals/functions\n\tconst value = memo(() => getValue(props.when))\n\tconst condition = memo(() => !!value())\n\n\treturn memo(() => (condition() ? callback(value) : fallback))\n}\n","import {\n\tscrollToLocationHash,\n\tscrollToSelector,\n\tscrollToTop,\n} from '../../plugin/useScroll.js'\n\nimport { walkParents } from '../../lib/std.js'\n\nexport function scroll(context) {\n\t/**\n\t * Scroll to hash first, if doesnt, scroll to positions defined by\n\t * the Routes.\n\t */\n\tif (!scrollToLocationHash()) {\n\t\tif (\n\t\t\t!walkParents(context, 'parent', context => {\n\t\t\t\tif (context.scroll) {\n\t\t\t\t\tfor (const item of context.scroll) {\n\t\t\t\t\t\tif (scrollToSelector(item)) {\n\t\t\t\t\t\t\treturn true\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t})\n\t\t) {\n\t\t\tscrollToTop()\n\t\t}\n\t}\n}\n","import { cleanup, memo, signal } from '../../lib/reactive.js'\nimport { nothing, optional, origin } from '../../lib/std.js'\n\nimport { addListeners, location } from '../../plugin/useLocation.js'\nimport { replaceParams } from '../../plugin/useURL.js'\n\nimport { Collapse } from '../Collapse.js'\nimport { Dynamic } from '../Dynamic.js'\nimport { Show } from '../Show.js'\n\nimport { Component } from '../../renderer.js'\nimport { onDone } from '../../scheduler.js'\n\nimport { Context, create } from './context.js'\nimport { scroll } from './scroll.js'\n\n/**\n * Renders children if the path matches the current location\n *\n * @template T\n * @param {object} props\n * @param {string} [props.path] - Path to match relative to the parent\n *   Route. When `path` is missing, it will render only when the\n *   parent's route path is matched exactly.\n * @param {string[]} [props.scroll] - Elements to scroll when the\n *   route matches\n * @param {object} [props.params] - Key-value pairs params to encode\n *   and replace on the path\n * @param {When<T>} [props.collapse] - To hide the route instead of\n *   removing it from the document\n * @param {When<T>} [props.when] - To stop rendering the route even if\n *   the path matches.\n * @param {Children} [props.fallback] - Fallback for when a `when`\n *   condition is set. If the `when` condition is not set, this wont\n *   be used.\n * @param {Children} [props.children]\n * @returns {Children}\n * @url https://pota.quack.uy/Components/Router/Router\n */\nexport function Router(props) {\n\taddListeners()\n\n\tconst parent = Context()\n\n\tconst base =\n\t\tparent.base +\n\t\treplaceParams(\n\t\t\t// when <Router lacks a path prop is treated as the final route\n\t\t\tprops.path === undefined\n\t\t\t\t? '(|#.*)$' // ends with nothing or has a hash followed of stuff\n\t\t\t\t: // ends with nothing or has a hash followed of stuff\n\t\t\t\t\tprops.path.replace('$', '(|#.*)$'),\n\t\t\tprops.params,\n\t\t)\n\n\tconst route = new RegExp(\n\t\t'^/?' + base.replace(/\\:([a-z0-9_\\-]+)/gi, '(?<$1>[^/#]+)'),\n\t)\n\n\tlet href = ''\n\tconst [params, setParams] = signal(() => nothing)\n\n\t// derived\n\tconst show = memo(() => {\n\t\tconst path = location.path()\n\t\tif (route.test(path)) {\n\t\t\tsetParams(() => route.exec(path).groups)\n\n\t\t\tif (href === '') {\n\t\t\t\thref = path.replace(path.replace(route, ''), '')\n\t\t\t\t// create full link\n\t\t\t\thref =\n\t\t\t\t\t// add origin\n\t\t\t\t\torigin +\n\t\t\t\t\t// add slash after origin if isnt present in the href\n\t\t\t\t\t(href[0] !== '/' ? '/' : '') +\n\t\t\t\t\t// add the path\n\t\t\t\t\thref\n\t\t\t}\n\n\t\t\tonDone(() => scroll(context))\n\n\t\t\treturn true\n\t\t} else {\n\t\t\treturn false\n\t\t}\n\t})\n\n\tconst context = create({\n\t\tbase, // the prefix for the children path\n\t\thref: () => href, // the full url of the route\n\t\tparams,\n\t\tscroll: props.scroll,\n\t\tparent,\n\t\tshow,\n\t})\n\n\tparent.addChildren(context)\n\n\tcleanup(() => parent.removeChildren(context))\n\n\treturn Component(Context.Provider, {\n\t\tvalue: context,\n\t\tchildren: Component(Dynamic, {\n\t\t\tcomponent: props.collapse ? Collapse : Show,\n\t\t\twhen: () => show() && optional(props.when),\n\t\t\tfallback: props.fallback,\n\t\t\tchildren: props.children,\n\t\t}),\n\t})\n}\n\n/**\n * Renders children when no sibling `Router` matches\n *\n * @param {object} props\n * @param {Children} [props.children]\n * @returns {Children}\n */\nRouter.Default = props => {\n\tconst context = Context()\n\treturn Component(Show, {\n\t\twhen: context.noneMatch,\n\t\tchildren: props.children,\n\t})\n}\n","import { addListeners } from '../../plugin/useLocation.js'\nimport { isRelative, replaceParams } from '../../plugin/useURL.js'\n\nimport { Component } from '../../renderer.js'\n\nimport { Context } from './context.js'\n\n/*\n * // props\n * // props.href Url relative to the parent <Router/>\n * // props.params Key-value pair object params to replace in the url\n *   not scroll on location change\n * // props.replace Replace the history entry from the browser} props\n */\n\n/**\n * Creates a link with Router features\n *\n * @param {{\n * \thref: string\n * \tparams?: object\n * \treplace?: boolean\n * } & Props} props\n *\n * @returns {Children}\n * @url https://pota.quack.uy/Components/Router/A\n */\n\nexport function A(props) {\n\taddListeners()\n\n\tlet href = replaceParams(props.href, props.params)\n\n\t// make it absolute\n\t// link is relative to the <Route\n\tconst base = Context().href()\n\thref =\n\t\t!isRelative(href[0]) || !base\n\t\t\t? href\n\t\t\t: base.includes('/#')\n\t\t\t\t? // making link dos/ relative to http://localhost:11433/#uno/\n\t\t\t\t\t// becomes http://localhost:11433/#uno/dos/\n\t\t\t\t\tbase + href\n\t\t\t\t: new URL(href, base).href\n\n\treturn Component('a', { ...{ ...props, href, params: undefined } })\n}\n","import { makeCallback, memo, resolve } from '../lib/reactive.js'\nimport {\n\tgetValue,\n\tidentity,\n\tisArray,\n\tisNullUndefined,\n} from '../lib/std.js'\n\n/**\n * Renders the first child that matches the given `when` condition, or\n * a fallback in case of no match\n *\n * @param {object} props\n * @param {Children} [props.children]\n * @param {Children} [props.fallback]\n * @returns {Children}\n * @url https://pota.quack.uy/Components/Switch\n */\nexport function Switch(props) {\n\tconst matches = resolve(() =>\n\t\tisArray(props.children) ? props.children : [props.children],\n\t)\n\n\tconst fallback = isNullUndefined(props.fallback)\n\t\t? memo(() => {\n\t\t\t\tconst r = matches().find(match => !('when' in match))\n\t\t\t\treturn r && r.children\n\t\t\t})\n\t\t: memo(() => resolve(props.fallback))\n\n\tconst match = memo(() =>\n\t\tmatches().find(match => !!getValue(match.when)),\n\t)\n\n\tconst value = memo(() => match() && getValue(match().when))\n\n\tconst callback = memo(\n\t\t() => match() && makeCallback(match().children),\n\t)\n\treturn memo(() => (match() ? callback()(value) : fallback))\n}\n\n/**\n * Renders the content if the `when` condition is true\n *\n * @template T\n * @param {object} props\n * @param {When<T>} props.when\n * @param {Children} [props.children]\n * @returns {Children}\n */\nexport const Match = identity\n","import {\n\tbatch,\n\tcleanup,\n\troot,\n\tsignal,\n\tsyncEffect,\n} from './lib/reactive.js'\n\nimport {\n\tcreateComment,\n\tcreateTextNode,\n\tempty,\n\terror,\n\tflat,\n\tgetValue,\n\ttoArray,\n\twarn,\n\twithWeakCache,\n} from './lib/std.js'\n\nimport { Component } from './renderer.js'\n\nimport {\n\tA,\n\tCollapse,\n\tDynamic,\n\tFor,\n\tHead,\n\tMatch,\n\tPortal,\n\tRange,\n\tRouter,\n\tShow,\n\tSwitch,\n} from './web/@main.js'\n\nconst defaultRegistry = {\n\tA,\n\tCollapse,\n\tDynamic,\n\tFor,\n\tHead,\n\tMatch,\n\tPortal,\n\tRange,\n\tRouter,\n\tShow,\n\tSwitch,\n}\n\n// parseHTML\n\nconst id = 'pota19611227'\nconst splitId = /(pota19611227)/\n\nconst xmlns = [\n\t'class',\n\t'on',\n\t'prop',\n\t'attr',\n\t'bool',\n\t'style',\n\t'var',\n\t'onMount',\n\t'onUnmount',\n\t'ref',\n]\n\t.map(ns => `xmlns:${ns}=\"/\"`)\n\t.join(' ')\n\n/**\n * Makes Nodes from TemplateStringsArray\n *\n * @param {TemplateStringsArray} content\n * @returns {Element}\n */\nconst parseHTML = withWeakCache(content => {\n\tconst html = new DOMParser().parseFromString(\n\t\t`<xml ${xmlns}>${content.join(id)}</xml>`,\n\t\t'text/xml',\n\t).firstChild.childNodes\n\n\tif (html[0].tagName === 'parsererror') {\n\t\tconst err = html[0]\n\t\terr.style.padding = '1em'\n\t\terr.firstChild.textContent = 'HTML Syntax Error:'\n\t\terr.firstChild.nextSibling.style.cssText = ''\n\t\terr.lastChild.replaceWith(createTextNode(content))\n\t}\n\treturn html\n})\n\n/**\n * Recursively walks a template and transforms it to `h` calls\n *\n * @param {{ components: {} }} html\n * @param {Element[]} cached\n * @param {...any} values\n * @returns {Children}\n */\nfunction toH(html, cached, values) {\n\tlet index = 0\n\tfunction nodes(node) {\n\t\tif (node.nodeType === 1) {\n\t\t\t// element\n\t\t\tconst tagName = node.tagName\n\n\t\t\t// gather props\n\t\t\tconst props = empty()\n\t\t\tfor (let { name, value } of node.attributes) {\n\t\t\t\tif (value === id) {\n\t\t\t\t\tvalue = values[index++]\n\t\t\t\t} else if (value.includes(id)) {\n\t\t\t\t\tconst val = value\n\t\t\t\t\t\t.split(splitId)\n\t\t\t\t\t\t.map(x => (x === id ? values[index++] : x))\n\n\t\t\t\t\tvalue = () => val.map(getValue).join('')\n\t\t\t\t}\n\t\t\t\tprops[name] = value\n\t\t\t}\n\n\t\t\t// gather children\n\t\t\tconst childNodes = node.childNodes\n\t\t\tif (childNodes.length) {\n\t\t\t\tprops.children = flat(toArray(childNodes).map(nodes))\n\t\t\t}\n\n\t\t\t;/[A-Z]/.test(tagName) &&\n\t\t\t\t!html.components[tagName] &&\n\t\t\t\twarn(`html: Forgot to html.define({ ${tagName} })?`)\n\n\t\t\treturn Component(html.components[tagName] || tagName, props)\n\t\t} else if (node.nodeType === 3) {\n\t\t\t// text\n\t\t\tconst value = node.nodeValue\n\t\t\treturn value.includes(id)\n\t\t\t\t? value\n\t\t\t\t\t\t.split(splitId)\n\t\t\t\t\t\t.map(x => (x === id ? values[index++] : x))\n\t\t\t\t: value\n\t\t} else if (node.nodeType === 8) {\n\t\t\t// comment\n\t\t\tconst value = node.nodeValue\n\t\t\tif (value.includes(id)) {\n\t\t\t\tconst val = value\n\t\t\t\t\t.split(splitId)\n\t\t\t\t\t.map(x => (x === id ? values[index++] : x))\n\t\t\t\treturn () => createComment(val.map(getValue).join(''))\n\t\t\t} else {\n\t\t\t\treturn createComment(value)\n\t\t\t}\n\t\t} else {\n\t\t\terror(`html: nodeType not supported ${node.nodeType}`)\n\t\t}\n\t}\n\n\treturn flat(toArray(cached).map(nodes))\n}\n\n/**\n * Function to create cached tagged template components\n *\n * @returns {Function & {\n * \tdefine: ({ components }) => void\n * \tcomponents: {}\n * }}\n * @url https://pota.quack.uy/HTML\n */\n\nexport function HTML() {\n\t/**\n\t * Creates tagged template components\n\t *\n\t * @param {TemplateStringsArray} template\n\t * @param {...any} values\n\t * @returns {Children}\n\t * @url https://pota.quack.uy/HTML\n\t */\n\n\tfunction html(template, ...values) {\n\t\treturn toH(html, parseHTML(template), values)\n\t}\n\n\thtml.components = { ...defaultRegistry }\n\thtml.define = userComponents => {\n\t\tfor (const name in userComponents) {\n\t\t\thtml.components[name] = userComponents[name]\n\t\t}\n\t}\n\n\treturn html\n}\n\nexport const html = HTML()\n","import { signal, cleanup, syncEffect } from '../lib/reactive.js'\nimport { isIterable, toArray } from '../lib/std.js'\n\n/**\n * Returns a `isSelected` function that will return `true` when the\n * argument for it matches the original signal `value`.\n *\n * @param {SignalAccessor<any>} value - Signal with the current value\n */\nexport function useSelector(value) {\n\tconst map = new Map()\n\n\tlet prev = []\n\n\tsyncEffect(() => {\n\t\tconst val = value()\n\n\t\tconst selected = isIterable(val)\n\t\t\t? toArray(val.values())\n\t\t\t: val === undefined\n\t\t\t\t? []\n\t\t\t\t: [val]\n\n\t\t// unselect\n\t\tfor (const value of prev) {\n\t\t\tif (!selected.includes(value)) {\n\t\t\t\tconst current = map.get(value)\n\t\t\t\tcurrent && current.write(false)\n\t\t\t}\n\t\t}\n\n\t\t// select\n\t\tfor (const value of selected) {\n\t\t\tif (!prev.includes(value)) {\n\t\t\t\tconst current = map.get(value)\n\t\t\t\tcurrent && current.write(true)\n\t\t\t}\n\t\t}\n\t\tprev = selected\n\t})\n\n\t/**\n\t * Is selected function, it will return `true` when the value\n\t * matches the current signal.\n\t *\n\t * @template T\n\t * @param {T} item - Values to compare with current\n\t * @returns {SignalAccessor<T>} A signal with a boolean value\n\t */\n\treturn function isSelected(item) {\n\t\tlet selected = map.get(item)\n\t\tif (!selected) {\n\t\t\tselected = signal(prev.includes(item))\n\t\t\tselected.counter = 1\n\t\t\tmap.set(item, selected)\n\t\t} else {\n\t\t\tselected.counter++\n\t\t}\n\n\t\tcleanup(() => {\n\t\t\tif (--selected.counter === 0) {\n\t\t\t\tmap.delete(item)\n\t\t\t}\n\t\t})\n\n\t\treturn selected.read\n\t}\n}\n","export const now = () => Date.now()\n\nexport function date(timestamp = now()) {\n\tconst o = new Date(timestamp)\n\n\treturn (\n\t\to.getFullYear() +\n\t\t'-' +\n\t\t(o.getMonth() + 1 < 10 ? '0' : '') +\n\t\t(o.getMonth() + 1) +\n\t\t'-' +\n\t\t(o.getDate() < 10 ? '0' : '') +\n\t\to.getDate()\n\t)\n}\n\nexport function datetime(timestamp = now()) {\n\treturn date(timestamp) + ' ' + time(timestamp)\n}\n\nexport function time(timestamp = now()) {\n\treturn timeWithSeconds(timestamp).slice(0, -3)\n}\n\nexport function timeWithSeconds(timestamp = now()) {\n\tconst o = new Date(timestamp)\n\n\treturn (\n\t\t(o.getHours() < 10 ? '0' : '') +\n\t\to.getHours() +\n\t\t':' +\n\t\t(o.getMinutes() < 10 ? '0' : '') +\n\t\to.getMinutes() +\n\t\t':' +\n\t\t(o.getSeconds() < 10 ? '0' : '') +\n\t\to.getSeconds()\n\t)\n}\n\nexport function day(timestamp = now(), lang = 'en') {\n\tconst o = new Date(timestamp)\n\n\t// saturday, September 17, 2016\n\treturn o.toLocaleDateString(lang, {\n\t\tweekday: 'long',\n\t\tyear: 'numeric',\n\t\tmonth: 'long',\n\t\tday: 'numeric',\n\t})\n}\n\nexport function measure(name, cb) {\n\tconsole.time(name)\n\tconst r = cb()\n\tconsole.timeEnd(name)\n\treturn r\n}\n\nexport function timing(fn) {\n\tconst start = performance.now()\n\tfn()\n\treturn performance.now() - start\n}\n","import { batch, render, signal } from 'pota'\nimport { html } from 'pota/html'\nimport { useSelector } from 'pota/plugin/useSelector'\nimport { timing } from 'pota/plugin/useTime'\n\nlet idCounter = 1\nconst adjectives = [\n    'pretty',\n    'large',\n    'big',\n    'small',\n    'tall',\n    'short',\n    'long',\n    'handsome',\n    'plain',\n    'quaint',\n    'clean',\n    'elegant',\n    'easy',\n    'angry',\n    'crazy',\n    'helpful',\n    'mushy',\n    'odd',\n    'unsightly',\n    'adorable',\n    'important',\n    'inexpensive',\n    'cheap',\n    'expensive',\n    'fancy',\n  ],\n  colours = [\n    'red',\n    'yellow',\n    'blue',\n    'green',\n    'pink',\n    'brown',\n    'purple',\n    'brown',\n    'white',\n    'black',\n    'orange',\n  ],\n  nouns = [\n    'table',\n    'chair',\n    'house',\n    'bbq',\n    'desk',\n    'car',\n    'pony',\n    'cookie',\n    'sandwich',\n    'burger',\n    'pizza',\n    'mouse',\n    'keyboard',\n  ]\n\nfunction _random(max) {\n  return Math.round(Math.random() * 1000) % max\n}\n\nfunction buildData(count) {\n  let data = new Array(count)\n  for (let i = 0; i < count; i++) {\n    const [label, setLabel] = signal(\n      `${adjectives[_random(adjectives.length)]} ${\n        colours[_random(colours.length)]\n      } ${nouns[_random(nouns.length)]}`,\n    )\n    data[i] = {\n      id: idCounter++,\n      label,\n      setLabel,\n    }\n  }\n  return data\n}\n\nconst bbutton = ({ id, text, fn }) =>\n  html`<div class=\"col-sm-6 smallpad\">\n    <button\n      id=\"${id}\"\n      class=\"btn btn-primary btn-block\"\n      type=\"button\"\n      on:click=\"${fn}\"\n    >\n      ${text}\n    </button>\n  </div>`\n\nconst App = () => {\n  const [data, setData, updateData] = signal([])\n  const [selected, setSelected] = signal([])\n  const run = () => setData(buildData(1000))\n  const runLots = () => {\n    setData(buildData(10000))\n  }\n  const bench = () => {\n    //  console.clear()\n    // warm\n    for (let k = 0; k < 5; k++) {\n      setData(buildData(10000))\n      setData([])\n    }\n\n    let createLarge = 0\n    let clearLarge = 0\n    let createSmall = 0\n    let clearSmall = 0\n    for (let k = 0; k < 10; k++) {\n      createLarge += timing(() => setData(buildData(10000)))\n      clearLarge += timing(() => setData([]))\n      console.log(\n        k + ' createLarge',\n        createLarge / (k + 1),\n        k + ' clearLarge',\n        clearLarge / (k + 1),\n      )\n    }\n    console.log('------------')\n    for (let k = 0; k < 10; k++) {\n      createSmall += timing(() => setData(buildData(1000)))\n      clearSmall += timing(() => setData([]))\n      console.log(\n        k + ' createSmall',\n        createSmall / (k + 1),\n        k + ' clearSmall',\n        clearSmall / (k + 1),\n      )\n    }\n  }\n  const add = () => updateData(d => [...d, ...buildData(1000)])\n  const update = () =>\n    batch(() => {\n      for (let i = 0, d = data(), len = d.length; i < len; i += 10)\n        d[i].setLabel(l => l + ' !!!')\n    })\n  const swapRows = () => {\n    const d = data().slice()\n    if (d.length > 998) {\n      let tmp = d[1]\n      d[1] = d[998]\n      d[998] = tmp\n      setData(d)\n    }\n  }\n  const clear = () => setData([])\n  const remove = id =>\n    updateData(d => {\n      const idx = d.findIndex(datum => datum.id === id)\n      d.splice(idx, 1)\n      return [...d]\n    })\n  const isSelected = useSelector(selected)\n\n  html.define({ bbutton })\n\n  return html`<div class=\"container\">\n    <div class=\"jumbotron\">\n      <div class=\"row\">\n        <div class=\"col-md-6\">\n          <h1>pota Keyed</h1>\n        </div>\n        <div class=\"col-md-6\">\n          <div class=\"row\">\n            <bbutton\n              id=\"run\"\n              text=\"Create 1,000 rows\"\n              fn=\"${run}\"\n            />\n            <bbutton\n              id=\"runlots\"\n              text=\"Create 10,000 rows\"\n              fn=\"${runLots}\"\n            />\n            <bbutton\n              id=\"add\"\n              text=\"Append 1,000 rows\"\n              fn=\"${add}\"\n            />\n            <bbutton\n              id=\"update\"\n              text=\"Update every 10th row\"\n              fn=\"${update}\"\n            />\n            <bbutton\n              id=\"clear\"\n              text=\"Clear\"\n              fn=\"${clear}\"\n            />\n            <bbutton\n              id=\"swaprows\"\n              text=\"Swap Rows\"\n              fn=\"${swapRows}\"\n            />\n            <bbutton\n              id=\"bench\"\n              text=\"bench\"\n              fn=\"${bench}\"\n            />\n          </div>\n        </div>\n      </div>\n    </div>\n    <table\n      class=\"table table-hover table-striped test-data\"\n      on:click=\"${e => {\n        const element = e.target\n        if (element.setSelected !== undefined) {\n          setSelected(element.setSelected)\n        } else if (element.removeRow !== undefined) {\n          remove(element.removeRow)\n        }\n      }}\"\n    >\n      <tbody>\n        <For each=\"${data}\">\n          ${row => {\n            const { id, label } = row\n\n            return html`<tr class:danger=\"${isSelected(id)}\">\n              <td class=\"col-md-1\">${id}</td>\n              <td class=\"col-md-4\">\n                <a prop:setSelected=\"${id}\">${label}</a>\n              </td>\n              <td class=\"col-md-1\">\n                <a>\n                  <span\n                    class=\"glyphicon glyphicon-remove\"\n                    aria-hidden=\"true\"\n                    prop:removeRow=\"${id}\"\n                  />\n                </a>\n              </td>\n              <td class=\"col-md-6\" />\n            </tr>`\n          }}\n        </For>\n      </tbody>\n    </table>\n    <span\n      class=\"preloadicon glyphicon glyphicon-remove\"\n      aria-hidden=\"true\"\n    />\n  </div>`\n}\n\nrender(App, document.getElementById('main'))\n"],"names":["ce","customElements","define","bind","name","constructor","options","prototype","isCustomElement","global","globalThis","window","CSSStyleSheet","document","DocumentFragment","Object","Promise","Symbol","queueMicrotask","assign","entries","freeze","getOwnPropertyDescriptors","getPrototypeOf","groupBy","isArray","Array","toArray","from","iterator","stringify","JSON","history","location","origin","promise","fn","resolved","onDone","then","catch","setAttribute","node","value","removeAttribute","isConnected","activeElement","documentElement","call","fns","createElement","createElementNS","createTextNode","createComment","createTreeWalker","empty","create","emptyArray","nothing","flat","arr","length","withState","state","cacheStore","withCache","cache","thing","get","withWeakCache","weakStore","walk","max","Infinity","nodes","nodeType","push","currentNode","nextNode","getDocumentForElement","getRootNode","ownerDocument","getSetterNamesFromPrototype","object","set","Set","descriptors","key","add","getValue","identity","x","isFunction","isIterable","isNullUndefined","undefined","isObject","isString","isPromise","noop","optional","querySelector","query","range","start","stop","step","Math","abs","removeFromArray","array","index","indexOf","splice","walkParents","context","propertyName","cb","DataStore","kind","store","has","del","delete","target","defaults","o","WeakMap","Map","classListAdd","className","classList","classListRemove","remove","adoptedStyleSheetsGet","adoptedStyleSheets","adoptedStyleSheetsAdd","styleSheet","adoptedStyleSheetsRemove","addStyleSheets","styleSheets","sheet","addStyleSheetExternal","text","startsWith","fetch","r","css","resolve","template","values","String","raw","replace","emit","eventName","data","bubbles","cancelable","composed","dispatchEvent","CustomEvent","preventDefault","e","warn","args","console","error","$isComponent","$isClass","$isReactive","$isMap","prefix","NS","__proto__","svg","math","html","xlink","isReactive","markReactive","CLEAN","STALE","CHECK","Owner","Listener","Updates","Effects","Time","Root","owner","owned","cleanups","addCleanups","addOwned","dispose","disposeOwned","doCleanups","i","Computation","updatedAt","sources","sourceSlots","update","time","prevOwner","prevListener","err","source","observers","observer","slot","pop","observerSlots","queue","Effect","user","batch","SyncEffect","Memo","read","updates","runUpdates","upstream","sourceSlot","observerSlot","write","equals","downstream","a","b","nextValue","Signal","save","prev","root","runWithOwner","signal","initialValue","effect","syncEffect","memo","untrack","cleanup","runTop","ancestors","init","wait","res","effects","runEffects","userLength","ignore","Context","defaultValue","useContext","id","newValue","withValue","withPrevValue","val","Row","runId","item","isDupe","disposer","begin","end","nodesForRow","nextSibling","map","list","callback","sort","fallback","duplicates","rows","clear","row","mapper","items","hasPrev","dupes","dupe","unsorted","every","includes","usort","before","after","current","previous","previousSibling","flatMap","children","unwrap","childrens","child","isComponent","isComponentable","makeCallback","callbacks","markComponent","addEvent","type","handler","addEventListener","removeEvent","removeEventListener","ownedEvent","handleEvent","added","reset","priority","run","q","onFixes","onProps","onRef","onMount","ready","plugins","pluginsNS","propsPlugin","propName","onMicrotask","plugin","propsPluginNS","NSName","propsPluginBoth","setAttributeNS","props","localName","ns","_setAttribute","removeAttributeNS","setPropertyNS","setProperty","_setProperty","setUnknown","_setUnknown","setters","elementSetters","element","builtIn","elements","builtInSetters","proto","Element","nextProto","Node","setBoolNS","setBool","_setBool","setStyle","setNodeStyle","style","setStyleNS","setVarNS","cssText","setStyleValue","_setStyleValue","removeProperty","setClass","setClassList","setClassNS","setElementClass","_setClassListValue","trim","split","setEventNS","setValue","_setValue","tagName","textContent","randomId","crypto","getRandomValues","BigUint64Array","toString","setCSS","setNodeCSS","setRef","setOnMount","setUnmount","assignProps","assignProp","propNS","useXMLNS","Fragment","Component","component","Factory","propsOverride","createTag","createClass","createAnything","createNode","render","xmlns","withXMLNS","nsContext","createChildren","parent","relative","Text","nodeValue","childNodes","firstChild","insertNode","createPlaceholder","toDiff","onResult","result","doc","propValue","head","getAttribute","rel","replaceWith","appendChild","insert","body","toHTML","toHTMLFragment","fragment","ctx","Provider","next","short","nextLength","parentNode","lastChild","customElement","CustomElement","HTMLElement","shadowRoot","attachShadow","mode","baseStyleSheets","innerHTML","replaceChildren","hidden","hasSlot","Collapse","CollapseElement","when","Dynamic","For","restoreFocus","each","queued","active","scroll","scrollTop","focus","Portal","mount","Head","Range","scrollToElement","scrollIntoView","scrollToLocationHash","scrollToSelector","hash","selector","scrollToSelectorWithFallback","scrollToTop","scrollTo","top","behavior","encodeURIComponent","_decodeURIComponent","string","decodeURIComponent","isAbsolute","href","test","isExternal","url","isRelative","replaceParams","params","setChildren","updateChildren","base","show","addChildren","removeChildren","noneMatch","getLocation","setLocation","wLocation","protocol","protocolIsBlob","protocolIsFile","pathname","search","path","searchParams","URL","routes","param","BeforeLeave","canNavigate","newBeforeLeave","beforeLeave","navigate","navigateInternal","startViewTransition","replaceState","pushState","addListenersAdded","addListeners","onLinkClick","onLocationChange","title","defaultPrevented","button","metaKey","altKey","ctrlKey","shiftKey","composedPath","find","HTMLAnchorElement","download","Show","condition","Router","route","RegExp","setParams","exec","groups","collapse","Default","A","Switch","matches","match","Match","defaultRegistry","splitId","join","parseHTML","content","DOMParser","parseFromString","padding","toH","cached","attributes","components","HTML","userComponents","useSelector","selected","isSelected","counter","timing","performance","now","idCounter","adjectives","colours","nouns","_random","round","random","buildData","count","label","setLabel","bbutton","App","setData","updateData","setSelected","runLots","bench","k","createLarge","clearLarge","createSmall","clearSmall","log","d","len","l","swapRows","slice","tmp","idx","findIndex","datum","removeRow","getElementById"],"mappings":"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"}