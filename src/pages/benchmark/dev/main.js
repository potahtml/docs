!function(){"use strict";const t=globalThis,e=t.Symbol,n=t.Object,o=n.assign,s=t=>"function"==typeof t,r=e(),i=e(),c=e(),l=e(),u="http://www.w3.org/",a={__proto__:null,svg:u+"2000/svg",math:u+"1998/Math/MathML",html:u+"1999/xhtml",xlink:u+"1999/xlink"};const d=0,h=1,f=2;let p,b,v=null,g=null,m=0;class w{owner;owned;cleanups;context;constructor(t){this.owner=t,this.context=t?.context}dispose(){let t;const{owned:e,cleanups:n}=this;if(e){for(t=e.length-1;t>=0;t--)e[t].dispose();e.length=0}if(n){for(t=n.length-1;t>=0;t--)n[t]();n.length=0}}}class y extends w{state=h;updatedAt=0;fn;sources;sourceSlots;constructor(t,e){super(t),this.fn=e,t&&(t.owned?t.owned.push(this):t.owned=[this])}update(){this.dispose();const t=m,e=p,n=b;b=p=this;try{this.fn()}catch(e){throw this.updatedAt=t+1,e}finally{p=e,b=n}this.updatedAt<=t&&(this.updatedAt=t)}dispose(){const{sources:t,sourceSlots:e}=this;if(t){let n,o,s,r,i;for(;t.length;)n=t.pop(),o=n.observers,s=e.pop(),o&&o.length&&(r=o.pop(),i=n.observerSlots.pop(),s<o.length&&(r.sourceSlots[i]=s,o[s]=r,n.observerSlots[s]=i))}super.dispose(),this.state=d}}class x extends y{user=!0;constructor(t,e){super(t,e),g?g.push(this):M((()=>this.update()))}}class S extends y{constructor(t,e){super(t,e),M((()=>this.update()))}}class A{value;observers;observerSlots;constructor(t,e){var n;this.value=t,e&&(o(this,e),this.save&&(this.prev=t)),this.read=((n=this.read.bind(this))[c]=void 0,n),this.write=this.write.bind(this),this.update=this.update.bind(this)}read(){if(b){const t=this.observers?this.observers.length:0;b.sources?(b.sources.push(this),b.sourceSlots.push(t)):(b.sources=[this],b.sourceSlots=[t]),this.observers?(this.observers.push(b),this.observerSlots.push(b.sources.length-1)):(this.observers=[b],this.observerSlots=[b.sources.length-1])}return this.value}write(t){return(!1===this.equals||!this.equals(this.value,t))&&(this.save&&(this.prev=this.value),this.value=t,this.observers&&this.observers.length&&T((()=>{for(let t,e=0;e<this.observers.length;e++)t=this.observers[e],t.state===d&&(t.pure?v.push(t):g.push(t),t.observers&&j(t)),t.state=h})),!0)}update(t){return"function"==typeof t&&(t=t(this.value)),this.write(t)}equals(t,e){return t===e}*[e.iterator](){yield this.read,yield this.write,yield this.update}}function k(t){const e=p,n=b,o=new w(p);p=o,b=void 0;try{return T((()=>t(o.dispose.bind(o))),!0)}finally{p=e,b=n}}function N(t,e=void 0){return new A(t,e)}function C(t){return new x(p,t)}const M=T;function L(t){return p&&(p.cleanups?p.cleanups.push(t):p.cleanups=[t]),t}function E(t){switch(t.state){case d:return;case f:return I(t)}const e=[];do{t.state&&e.push(t),t=t.owner}while(t&&t.updatedAt<m);for(let n,o=e.length-1;o>=0;o--)switch((t=e[o]).state){case h:t.update();break;case f:n=v,v=null,T((()=>I(t,e[0]))),v=n}}function T(t,e=!1){if(v)return t();let n=!1;e||(v=[]),g?n=!0:g=[],m++;try{const e=t();if(v&&(!function(t){for(let e=0;e<t.length;e++)E(t[e])}(v),v=null),!n){const t=g;g=null,t.length&&T((()=>function(t){let e,n,o=0;for(e=0;e<t.length;e++)n=t[e],n.user?t[o++]=n:E(n);for(e=0;e<o;e++)E(t[e])}(t)))}return e}catch(t){throw n||(g=null),v=null,t}}function I(t,e){t.state=d;for(let n,o=0;o<t.sources.length;o++)if(n=t.sources[o],n.sources)switch(n.state){case h:n!==e&&n.updatedAt<m&&E(n);break;case f:I(n,e)}}function j(t){for(let e,n=0;n<t.observers.length;n++)e=t.observers[n],e.state===d&&(e.state=f,e.pure?v.push(e):g.push(e),e.observers&&j(e))}function W(t=void 0){const n=e();return q.bind(null,n,t)}function q(t,e,n,o){if(void 0===n)return p?.context&&void 0!==p.context[t]?p.context[t]:e;{let e;return function(t){new S(p,t)}((()=>{p.context={...p.context,[t]:n},e=o()})),e}}const O=()=>{const t=p;return e=>s(e)?function(t,e){const n=p,o=b;p=t,b=void 0;try{return T(e,!0)}catch(t){throw t}finally{p=n,b=o}}(t,e):e},_=t=>{for(;"function"==typeof t;)t=t();return t},D=n.groupBy;function R(t,e){const n=t.indexOf(e);return-1!==n&&t.splice(n,1),t}function F(t){const{begin:e,end:n}=t,o=[e];let s=e;for(;s!==n;)s=s.nextSibling,o.push(s);return o}const H=(t,e)=>s(t)?C((()=>{e(_(t))})):e(t),P=Array.isArray,U=(t,...e)=>P(t)?t[0](...e,...t.slice(1)):t(...e),B=t=>null!==t&&"object"==typeof t,K=n.create.bind(null,null),z=t=>1===t.length?t[0]:t,J=n.freeze,G=t=>null==t,Q=e.iterator;function V(t){const e=performance.now();return t(),performance.now()-e}const X=queueMicrotask,Y=J(K()),Z=JSON.stringify,$=Array.from;const tt=t=>s(t)&&c in t,et=t=>s(t)&&r in t,nt=t=>!tt(t)&&(s(t)||!P(t)&&B(t)&&!t.then);function ot(t){return t[r]=void 0,t}let st,rt;const it=[];function ct(){rt=[[],[],[]],st=!1}function lt(t,e){st||(st=!0,X(ut)),rt[t].push(e)}function ut(){const t=rt;ct();for(const e of t)for(const t of e)U(t);for(const t of it)U(t)}ct();const at=t=>lt(1,t),dt=K(),ht=K(),ft=(t,e,n=!0)=>{bt(dt,t,e,n)},pt=(t,e,n=!0)=>{bt(ht,t,e,n)},bt=(t,e,n,o)=>{t[e]=o?(...t)=>{const e=O();X((()=>e((()=>n(...t)))))}:n},vt=(t,e,n={bubbles:!0,cancelable:!0,composed:!0})=>t.dispatchEvent(new CustomEvent(e,n)),gt=(t,e,n)=>H(n,(n=>mt(t,e,n)));function mt(t,e,n){G(n)?t[e]=null:t[e]=n,"value"===e&&(vt(t,"input"),vt(t,"change"))}const wt=(t,e,n,o)=>H(n,(n=>yt(t,e,n,o)));function yt(t,e,n,o){G(n)?o&&a[o]?t.removeAttributeNS(a[o],e):t.removeAttribute(e):o&&a[o]?t.setAttributeNS(a[o],e,n):t.setAttribute(e,n)}const xt=(t,e,n)=>H(n,(n=>St(t,e,n))),St=(t,e,n)=>n?t.setAttribute(e,""):t.removeAttribute(e);function At(t,e){if(B(e)){let n;for(n in e)kt(t,n,e[n]);return}const n=typeof e;"string"!==n?"function"!==n||C((()=>{At(t,_(e))})):t.cssText=e}const kt=(t,e,n)=>H(n,(n=>Nt(t,e,n))),Nt=(t,e,n)=>G(n)?t.removeProperty(e):t.setProperty(e,n);function Ct(t,e){switch(typeof e){case"string":Lt(t,e,!0);break;case"object":{let n;for(n in e)Mt(t,n,e[n]);break}case"function":H(e,(e=>Ct(t,e)))}}const Mt=(t,e,n)=>H(n,(n=>Lt(t,e,n))),Lt=(t,e,n)=>n?t.classList.add(...e.trim().split(/\s+/)):t.classList.remove(e),Et=(t,e,n,o)=>n(t),Tt=(t,e,n,o)=>lt(0,[n,t]),It=(t,e,n,o)=>L((()=>n(t))),jt=K();function Wt(t){return t in jt||(t.startsWith("on")&&t.toLowerCase()in window?jt[t]=t.slice(2).toLowerCase():jt[t]=void 0),jt[t]}function qt(t,e,n){t.addEventListener(e,n,s(n)?void 0:n);const o=()=>function(t,e,n){return t.removeEventListener(e,n),()=>qt(t,e,n)}(t,e,n);return L(o),o}const Ot=(t,e,n,o)=>H(n,(n=>_t(t,e,n,o))),_t=(t,e,n,o)=>{B(n)?mt(t,e,n):"boolean"!=typeof n||e.includes("-")?(yt(t,e,n,o),G(n)&&mt(t,e,n)):mt(t,e,n)};ft("style",((t,e,n,o)=>At(t.style,n)),!1),pt("style",((t,e,n,o,s,r)=>At(t.style,B(n)?n:{[s]:n})),!1),pt("var",((t,e,n,o,s,r)=>At(t.style,{["--"+s]:n})),!1),ft("class",((t,e,n,o)=>(t=>"string"==typeof t)(n)?t.setAttribute("class",n):Ct(t,n)),!1),pt("class",((t,e,n,o,s,r)=>B(n)?Ct(t,n):Mt(t,s,n)),!1);for(const t of["value","textContent","innerText","innerHTML"])ft(t,gt,!1);pt("prop",((t,e,n,o,s,r)=>gt(t,s,n)),!1),pt("attr",((t,e,n,o,s,r)=>wt(t,s,n)),!1),pt("bool",((t,e,n,o,s,r)=>xt(t,s,n)),!1),ft("onMount",Tt,!1),pt("onMount",Tt,!1),ft("onUnmount",It,!1),pt("onUnmount",It,!1),ft("ref",Et,!1),pt("ref",Et,!1),pt("on",((t,e,n,o,s,r)=>qt(t,s,n)),!1);const Dt=(t,e)=>"is"in e||t.localName?.includes("-");function Rt(t,e){let n,o;for(n in e){if(o=e[n],n in dt){dt[n](t,n,o,e);continue}let s=Wt(n);if(s)qt(t,s,o);else if(n.includes(":")){let[r,i]=n.split(":");if(r in ht){ht[r](t,n,o,e,i,r);continue}if(s=Wt(r),s){qt(t,s,o);continue}Dt(t,e)?mt(t,n,o):Ot(t,n,o,r)}else Dt(t,e)?mt(t,n,o):Ot(t,n,o)}}const Ft=t=>document[t].bind(document),Ht=Ft("createElement"),Pt=Ft("createElementNS"),Ut=Ft("createTextNode"),Bt=document.adoptedStyleSheets;function Kt(t=[],e=[]){e=P(e)?e.flat(1/0):[e];for(let n,o=0;o<t.length;o++)n=t[o],n&&(0===e.length||!e.includes(n))&&n.remove();return e}function zt(){const t=document.createTreeWalker(document,NodeFilter.SHOW_ELEMENT);return(zt=()=>t)()}!function(){const t=new WeakMap,e=t.get.bind(t),n=t.set.bind(t);t.has.bind(t),t.delete.bind(t)}();const Jt=new Map;const Gt=new Map,Qt=new WeakMap,Vt=function(t){const e=W(t);return e.Provider=t=>e(t.value,(()=>ue(t.children))),e}(),Xt=e();function Yt(t,e){return t===Xt?e.children:(J(e),void 0===e?Zt(t):ot(Zt(t).bind(null,e)))}function Zt(t){if(et(t))return t;const e=B(t);let n=e?Qt.get(t):Gt.get(t);if(n)return n;switch(typeof t){case"string":n=ee.bind(null,t);break;case"function":if(i in t){n=$t.bind(null,t);break}if(tt(t)){n=te.bind(null,t);break}n=t;break;default:if(t instanceof Node){n=se.bind(null,t);break}n=te.bind(null,t)}return e?Qt.set(t,n):Gt.set(t,n),ot(n)}function $t(t,e){const n=new t;return n.ready&&at(n.ready.bind(n)),n.cleanup&&L(n.cleanup.bind(n)),n.render(e)}function te(t,e){return t}function ee(t,e){return ne(e?.xmlns||a[t],(n=>se(n?Pt(n,t):Ht(t),e)),t)}function ne(t,e,n){const o=Vt();return t&&t!==o?Vt(t,(()=>e(t))):o&&"foreignObject"===n?Vt(a.html,(()=>e(a.html))):e(o)}function oe(t,e){return ot((()=>ne(e?e[0].xmlns:void 0,(n=>{const o=function(t,e){const n=Jt.get(t);if(n)return n.cloneNode(!0);let o=e?Pt(e,"template"):Ht("template");return o.innerHTML=t,o=e?o.firstChild:1===o.content.childNodes.length?o.content.firstChild:o.content,Jt.set(t,o),o.cloneNode(!0)}(t,n);if(e){const t=[];let n;1===o.nodeType&&o.hasAttribute("pota")&&(t.push(o),o.removeAttribute("pota"));const s=zt();for(s.currentNode=o;n=s.nextNode();)n.hasAttribute("pota")&&(t.push(n),n.removeAttribute("pota"));let r=0;for(const n of t)Rt(n,e[r++])}return o}))))}function se(t,e){return e&&Rt(t,e),t}function re(t,e,n){switch(typeof e){case"string":case"number":return le(t,Ut(e),n);case"function":{if(et(e))return re(t,function(t){if(void 0===b)return t();const e=b;b=void 0;try{return t()}finally{b=e}}(e),n);let o=[];return t=ie(t,void 0,n),l in e?(C((()=>{o=Kt(o,e((e=>{const n=ie(t,void 0,!0),o=ie(t,void 0,!0);return[n,re(o,e,!0),o]})))})),L((()=>{Kt(o),t.remove()})),[o,t]):(C((()=>{o=Kt(o,re(t,e(),!0))})),L((()=>{Kt(o),t.remove()})),[o,t])}case"object":if(P(e))return 1===e.length?re(t,e[0],n):e.map((e=>re(t,e,n)));if(e instanceof Node)return e instanceof DocumentFragment?re(t,$(e.childNodes),n):le(t,e,n);if(null===e)return;if("then"in e){const[o,s]=N(void 0),r=e=>t.isConnected&&s(e);return e.then(r).catch(r),re(t,o,n)}return Q in e?re(t,$(e.values()),n):e instanceof CSSStyleSheet?(Bt.push(e),void L((()=>R(Bt,e)))):re(t,"toString"in e?e.toString():Z(e),n);case"undefined":return;default:return le(t,Ut(e.toString()),n)}}ft("children",((t,e,n)=>re(t,n)),!1);const ie=(t,e,n)=>le(t,Ut(""),n);let ce;function le(t,e,n){if(t===document.head){if(!ce){const t=document.head;ce=t.querySelector.bind(t)}const n=e.tagName;let o;"TITLE"===n?o=ce("title"):"META"===n?o=ce('meta[name="'+e.getAttribute("name")+'"]')||ce('meta[property="'+e.getAttribute("property")+'"]'):"LINK"===n&&"canonical"===e.rel&&(o=ce('link[rel="canonical"]')),o?o.replaceWith(e):t.appendChild(e)}else n?t.before(e):t.appendChild(e);return e}const ue=t=>z(function(t){const e=new DocumentFragment;return re(e,t),e}(t).childNodes);const ae=t=>s(t)?tt(t)?e=>{const n=t();return s(n)?tt(n)?n():n(...e):n}:e=>t(...e):()=>t;K();const de=t=>function(t,e,n){const o=new Map,s=new Map;let r=0,i=[],c=[];function u(){for(let t=0;t<c.length;t++)c[t].dispose(!0);o.clear(),s.clear(),i.length=0,c.length=0}L(u);class a{constructor(t,e,n,o){this.runId=-1,this.item=t,this.index=e,this.isDupe=o,this.disposer=void 0,this.nodes=k((o=>(this.disposer=o,n(t,e))))}get begin(){return this.nodes[0]}get end(){return this.nodes[this.nodes.length-1]}dispose(t){if(void 0===t)if(this.isDupe){const t=s.get(this.item);1===t.length?s.delete(this.item):R(t,this)}else o.delete(this.item);this.disposer()}}function d(l){const d=l?(t,n)=>l(e(t,n),n):e,h=(_(t)||[]).entries();r++,i=[];const f=c.length;for(const[t,e]of h){let n=f?o.get(e):void 0;if(void 0===n)n=new a(e,t,d,!1),o.set(e,n);else if(n.runId===r){let o=s.get(e);o||(o=[],s.set(e,o));for(let t=0;t<o.length;t++)if(o[t].runId!==r){n=o[t];break}n.runId===r&&(n=new a(e,t,d,!0),o.push(n))}n.runId=r,n.index=t,i.push(n)}if(0===i.length)u();else for(let t=0;t<c.length;t++)c[t].runId!==r&&c[t].dispose();if(n&&i.length>1&&c.length){const{a:t,b:e}=D(i,((t,e)=>i[e]===c[e]?"a":"b"));if(t&&e&&t.length&&e.length&&e.length<t.length&&e.every((t=>c.includes(t))))for(const n of e)for(const e of t){if(n.index===e.index-1){e.begin.before(...F(n));break}if(n.index===e.index+1){e.end.after(...F(n));break}}let n=i[i.length-1];for(let t=i.length-1;t>0;t--){const e=i[t-1];n.begin.previousSibling!==e.end&&n.begin.before(...F(e)),n=e}}return c=i,i.map((t=>t.nodes))}return d[l]=void 0,d}(t.each,function(t){t=P(t)?z(t):t;const e=P(t)?t.map(ae):ae(t);return P(t)?ot(((...t)=>e.map((e=>e(t))))):ot(((...t)=>e(t)))}(t.children),!0);let he=1;function fe(t){let e=new Array(t);for(let n=0;n<t;n++){const[t,o,s]=N("elegant green keyboard "+he++);e[n]={id:he,label:t,updateLabel:s}}return e}const pe=({id:t,text:e,fn:n})=>oe('<div class="col-sm-6 smallpad"><button pota class="btn btn-primary btn-block" type=button></button></div>',[{id:t,onClick:n,children:e}]);!function(t,e,n=Y){const o=k((o=>(function(t,e=document.body,n){n.clear&&e&&(e.textContent="");const o=re(e,nt(t)?Zt(t):t,n.relative);L((()=>Kt([o].flat(1/0))))}(t,e,n),o)));L(o)}((()=>{const[t,e,n]=N([]),[o,s]=N(null),r=function(t){const e=new Map;let n;return C((()=>{const o=t();if(o===n)return;const s=e.get(n);s&&s.write(!1);const r=e.get(o);r&&r.write(!0),n=o})),function(n){let o=e.get(n);return o||(o=N(n===t()),o.counter=0,e.set(n,o)),o.counter++,L((()=>{0==--o.counter&&e.delete(n)})),o.read}}(o);return oe('<div class=container><div class=jumbotron><div class=row><div class=col-md-6><h1>pota Keyed</h1></div><div class=col-md-6><div pota class=row></div></div></div></div><table pota class="table table-hover table-striped test-data"><tbody pota></tbody></table><span class="preloadicon glyphicon glyphicon-remove" aria-hidden=true></span></div>',[{children:[Yt(pe,{id:"run",text:"Create 1,000 rows",fn:()=>e(fe(1e3))}),Yt(pe,{id:"runlots",text:"Create 10,000 rows",fn:()=>{e(fe(1e4))}}),Yt(pe,{id:"add",text:"Append 1,000 rows",fn:()=>n((t=>[...t,...fe(1e3)]))}),Yt(pe,{id:"update",text:"Update every 10th row",fn:()=>M((()=>{for(let e=0,n=t(),o=n.length;e<o;e+=10)n[e].updateLabel((t=>t+" !!!"))}))}),Yt(pe,{id:"clear",text:"Clear",fn:()=>e([])}),Yt(pe,{id:"swaprows",text:"Swap Rows",fn:()=>{const n=t().slice();if(n.length>998){let t=n[1];n[1]=n[998],n[998]=t,e(n)}}}),Yt(pe,{id:"bench",text:"bench",fn:()=>{for(let t=0;t<5;t++)e(fe(1e4)),e([]);let t=0,n=0,o=0,s=0;for(let o=0;o<10;o++)t+=V((()=>e(fe(1e4)))),n+=V((()=>e([]))),console.log(o+" createLarge",t/(o+1),o+" clearLarge",n/(o+1));console.log("------------");for(let t=0;t<10;t++)o+=V((()=>e(fe(1e3)))),s+=V((()=>e([]))),console.log(t+" createSmall",o/(t+1),t+" clearSmall",s/(t+1))}})]},{onClick:t=>{const e=t.target;var o;void 0!==e.setSelected?s(e.setSelected):void 0!==e.removeRow&&(o=e.removeRow,n((t=>{const e=t.findIndex((t=>t.id===o));return t.splice(e,1),[...t]})))}},{children:Yt(de,{each:t,children:t=>{const{id:e,label:n}=t;return oe('<tr pota><td pota class=col-md-1></td><td class=col-md-4><a pota></a></td><td class=col-md-1><a><span pota class="glyphicon glyphicon-remove" aria-hidden=true></span></a></td><td class=col-md-6></td></tr>',[{"class:danger":r(e)},{textContent:e},{textContent:n,"prop:setSelected":e},{"prop:removeRow":e}])}})}])}),document.getElementById("main"))}();
//# sourceMappingURL=main.js.map
