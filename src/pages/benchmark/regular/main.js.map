{"version":3,"file":"main.js","sources":["../../../../../pota/src/lib/std.js","../../../../../pota/src/constants.js","../../../../../pota/src/lib/solid.js","../../../../../pota/src/lib/reactive.js","../../../../../pota/src/use/dom.js","../../../../../pota/src/use/css.js","../../../../../pota/src/core/scheduler.js","../../../../../pota/src/core/props/plugin.js","../../../../../pota/src/core/props/property.js","../../../../../pota/src/core/props/event.js","../../../../../pota/src/use/random.js","../../../../../pota/src/core/props/css.js","../../../../../pota/src/core/props/lifecycle.js","../../../../../pota/src/core/props/style.js","../../../../../pota/src/core/props/class.js","../../../../../pota/src/core/props/attribute.js","../../../../../pota/src/core/props/@main.js","../../../../../pota/src/core/renderer.js","../../../../../pota/src/components/For.js","../../../../../pota/src/use/selector.js","index.jsx"],"sourcesContent":["export const window = globalThis\n\nexport const requestAnimationFrame = window.requestAnimationFrame\nexport const queueMicrotask = window.queueMicrotask\n\nexport const history = window.history\nexport const navigator = window.navigator\nexport const location = window.location\nexport const origin = location?.origin\n\nexport const Object = window.Object\nexport const Array = window.Array\nexport const Promise = window.Promise\nexport const Symbol = window.Symbol\n\nexport const assign = Object.assign\nexport const create = Object.create\nexport const defineProperties = Object.defineProperties\nexport const defineProperty = Object.defineProperty\nexport const entries = Object.entries\nexport const freeze = Object.freeze\nexport const fromEntries = Object.fromEntries\nexport const getOwnPropertyDescriptor =\n\tObject.getOwnPropertyDescriptor\nexport const getOwnPropertyDescriptors =\n\tObject.getOwnPropertyDescriptors\nexport const getOwnPropertyNames = Object.getOwnPropertyNames\nexport const getOwnPropertySymbols = Object.getOwnPropertySymbols\nexport const getPrototypeOf = Object.getPrototypeOf\nexport const groupBy = Object.groupBy\nexport const hasOwn = Object.hasOwn\nexport const is = Object.is\nexport const isExtensible = Object.isExtensible\nexport const keys = Object.keys\nexport const values = Object.values\nexport const setPrototypeOf = Object.setPrototypeOf\n\nexport const toArray = Array.from\n\n/**\n * @template T\n * @param {T} value\n */\nexport const toValues = value =>\n\tisArray(value)\n\t\t? value\n\t\t: isObject(value) && 'values' in /** @type {object} */ (value)\n\t\t\t? /** @type {{ values(): IterableIterator<T> }} */ (\n\t\t\t\t\tvalue\n\t\t\t\t).values()\n\t\t\t: toArray(/** @type {Iterable<T> | ArrayLike<T>} */ (value))\n\n/**\n * @template T\n * @param {T} value\n */\nexport const toEntries = value =>\n\tisObject(value) && 'entries' in /** @type {object} */ (value)\n\t\t? /** @type {{ entries(): IterableIterator<[string, T]> }} */ (\n\t\t\t\tvalue\n\t\t\t).entries()\n\t\t: toArray(/** @type {Iterable<T> | ArrayLike<T>} */ (value))\n\nexport const iterator = Symbol.iterator\nexport const Iterator = window.Iterator\n\nexport const stringify = JSON.stringify\n\n/** @param {unknown} o */\nexport const stringifyReadable = o => stringify(o, null, 2)\n\n/** @param {unknown} o */\nexport const stringifySorted = o => {\n\t/** @param {any} o */\n\tfunction sort(o) {\n\t\tif (!isObject(o)) {\n\t\t\treturn o\n\t\t}\n\n\t\tconst asArray = isArray(o)\n\t\t/** @type {unknown[] | { [key: string]: unknown }} */\n\t\tconst tmp = asArray ? [] : {}\n\t\tkeys(o)\n\t\t\t.sort()\n\t\t\t.map(k => (tmp[k] = sort(o[k])))\n\n\t\tif (asArray) {\n\t\t\t// @ts-expect-error\n\t\t\ttmp.sort((a, b) => stringify(a).localeCompare(stringify(b)))\n\t\t}\n\t\treturn tmp\n\t}\n\treturn stringifyReadable(sort(o))\n}\n\n/**\n * @param {(\n * \tresolve: (value: unknown) => void,\n * \treject: (reason?: any) => void,\n * ) => void} fn\n */\nexport const promise = fn => new Promise(fn)\n\n/**\n * Creates a promise together with deferred `resolve`/`reject`\n * helpers.\n *\n * @template T\n * @returns {{\n * \tpromise: Promise<T>\n * \tresolve: (value: T | PromiseLike<T>) => void\n * \treject: (reason?: any) => void\n * }}\n */\nexport const withResolvers = () => Promise.withResolvers()\n\n/**\n * Given a promise it adds `onDone` to `then` and `catch`\n *\n * ```js\n * resolved(promise, onDone)\n * // is same as\n * promise.then(onDone).catch(onDone)\n * ```\n */\nexport const resolved = (promise, onDone) =>\n\tpromise.then(onDone).catch(e => {\n\t\terror(e)\n\t\tonDone(e.toString())\n\t})\n\n/**\n * Runs an array of functions\n *\n * @param {Iterable<Function>} fns\n */\nexport const call = fns => {\n\tfor (const fn of fns) fn()\n}\n\n/**\n * Flats an array recursively and passes values to secondary function\n *\n * @template {unknown | unknown[]} T\n * @param {T} arr\n * @param {(value: T) => void} fn\n */\nexport const flatForEach = (arr, fn) => {\n\tisArray(arr)\n\t\t? arr.flat(Infinity).forEach(value => value && fn(value))\n\t\t: arr\n\t\t\t? fn(arr)\n\t\t\t: nothing\n}\n\n/**\n * Object.defineProperty with `enumerable` and `configurable` set to\n * `true` unless overwriten by `descriptor` argument\n *\n * @template T\n * @param {T} target\n * @param {PropertyKey} key\n * @param {PropertyDescriptor} descriptor\n */\nexport const redefineProperty = (target, key, descriptor) =>\n\tdefineProperty(\n\t\ttarget,\n\t\tkey,\n\t\tassign(create(redefinePropertyDefailts), descriptor),\n\t)\n\nconst redefinePropertyDefailts = {\n\t__proto__: null,\n\tconfigurable: true,\n\tenumerable: true,\n}\n\n/**\n * Returns an object without a prototype\n *\n * @type {Function}\n */\nexport const empty = Object.create.bind(null, null)\n\n/**\n * An empty frozen array\n *\n * @type {readonly unknown[]}\n */\nexport const emptyArray = freeze([])\n\n/** An empty frozen object */\nexport const nothing = freeze(empty())\n\n/**\n * Iterates over own enumerable string and symbol keys.\n *\n * @param {Record<PropertyKey, unknown>} target\n * @returns {IterableIterator<[PropertyKey, unknown]>}\n */\nexport function* entriesIncludingSymbols(target) {\n\tfor (const item of entries(target)) {\n\t\tyield item\n\t}\n\n\tfor (const item of getOwnPropertySymbols(target)) {\n\t\tyield [item, target[item]]\n\t}\n}\n\n/**\n * Compares two values for equality. Handles primitive types, objects,\n * and arrays recursively.\n *\n * @template T\n * @param {T} a - The first value to compare.\n * @param {T} b - The second value to compare.\n * @returns {boolean} True if the values are equal, false otherwise.\n * @url modified version of https://github.com/epoberezkin/fast-deep-equal\n */\nexport function equals(a, b) {\n\tif (a === b) {\n\t\treturn true\n\t}\n\n\tif (a && b && typeof a == 'object' && typeof b == 'object') {\n\t\tif (a.constructor !== b.constructor) {\n\t\t\treturn false\n\t\t}\n\n\t\tlet length, i, k\n\t\tif (isArray(a)) {\n\t\t\tlength = a.length\n\t\t\t// @ts-expect-error\n\t\t\tif (length != b.length) {\n\t\t\t\treturn false\n\t\t\t}\n\t\t\tfor (i = length; i-- !== 0; ) {\n\t\t\t\tif (!equals(a[i], b[i])) {\n\t\t\t\t\treturn false\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn true\n\t\t}\n\n\t\tif (a.constructor === RegExp)\n\t\t\t// @ts-expect-error\n\t\t\treturn a.source === b.source && a.flags === b.flags\n\t\tif (a.valueOf !== Object.prototype.valueOf)\n\t\t\treturn a.valueOf() === b.valueOf()\n\t\tif (a.toString !== Object.prototype.toString)\n\t\t\treturn a.toString() === b.toString()\n\n\t\tk = keys(a)\n\t\tlength = k.length\n\t\tif (length !== keys(b).length) {\n\t\t\treturn false\n\t\t}\n\n\t\tfor (i = length; i-- !== 0; ) {\n\t\t\tif (!Object.prototype.hasOwnProperty.call(b, k[i])) {\n\t\t\t\treturn false\n\t\t\t}\n\t\t}\n\n\t\tfor (i = length; i-- !== 0; ) {\n\t\t\tvar key = k[i]\n\n\t\t\tif (!equals(a[key], b[key])) {\n\t\t\t\treturn false\n\t\t\t}\n\t\t}\n\n\t\treturn true\n\t}\n\n\t// true if both NaN, false otherwise\n\treturn a !== a && b !== b\n}\n\n/**\n * Unwraps an array/childNodes to the first item if the length is 1\n *\n * @param {any[] | NodeListOf<ChildNode>} arr\n * @returns {any}\n */\nexport const unwrapArray = arr => (arr.length === 1 ? arr[0] : arr)\n\n/**\n * Flats an array/childNodes recursively\n *\n * @template {unknown | unknown[]} T\n * @param {T} arr\n * @returns {T[]}\n */\nexport const flatToArray = arr =>\n\tisArray(arr) ? arr.flat(Infinity) : [arr]\n\n/**\n * Flats an array/childNodes recursively if its an array else it\n * returns\n *\n * @template {unknown | unknown[]} T\n * @param {T} arr\n * @returns {T[] | T}\n */\nexport const flatNoArray = arr =>\n\tisArray(arr) ? arr.flat(Infinity) : arr\n\n/**\n * Keeps state in the function as the first param\n *\n * @template {((...args: any[]) => void) & Function} T\n * @param {T} fn - Function to which add state to it\n * @param {() => DataStore<Map<unknown, unknown>>} [state]\n * @returns {(\n * \t...args: Parameters<T> extends [any, ...infer P] ? P : never\n * ) => ReturnType<T>}\n */\nexport const withState = /* #__NO_SIDE_EFFECTS__ */ (\n\tfn,\n\tstate = cacheStore,\n) => fn.bind(null, state())\n\n/**\n * Memoizes a unary function using a strong Map-backed cache.\n *\n * @template T, R\n * @param {(value: T) => R} fn\n * @returns {(value: T) => R}\n */\nexport const withCache = fn =>\n\twithState(\n\t\t(cache, thing) => cache.get(thing, thing => fn(thing)),\n\t\tcacheStore,\n\t)\n/**\n * Memoizes a unary function using a WeakMap-backed cache.\n *\n * @template {object} T\n * @template R\n * @param {(value: T) => R} fn\n * @returns {(value: T) => R}\n */\nexport const withWeakCache = fn =>\n\twithState(\n\t\t(cache, thing) => cache.get(thing, thing => fn(thing)),\n\t\tweakStore,\n\t)\n\n/**\n * Safely collects own property values, skipping getters that throw.\n *\n * @param {Record<PropertyKey, unknown>} o\n * @returns {unknown[]}\n */\nexport const getOwnValues = o =>\n\tgetOwnPropertyNames(o).map(key => {\n\t\ttry {\n\t\t\treturn o[key]\n\t\t} catch (e) {}\n\t})\n\n/**\n * Walks a prototype and returns the names of every setter it defines.\n *\n * @param {object} object\n * @param {Set<PropertyKey>} [set]\n * @returns {Set<PropertyKey>}\n */\nexport function getSetterNamesFromPrototype(object, set = new Set()) {\n\tconst descriptors = getOwnPropertyDescriptors(object)\n\n\tfor (const key in descriptors) {\n\t\tif (descriptors[key].set) {\n\t\t\tset.add(key)\n\t\t}\n\t}\n\n\treturn set\n}\n\n/**\n * Unwraps values. If the argument is a function then it runs it\n * recursively and returns the value\n *\n * @template T\n * @param {Accessor<T>} value - Maybe function\n * @returns T\n */\nexport function getValue(value) {\n\twhile (typeof value === 'function')\n\t\tvalue = /** @type {() => T} */ (value)()\n\treturn value\n}\n\n/**\n * Resolves functions (optionally with arguments) and unwraps nested\n * accessors.\n *\n * @template T\n * @param {T} value\n * @param {...unknown} args\n * @returns {T}\n */\nexport const getValueWithArguments = (value, ...args) =>\n\ttypeof value === 'function'\n\t\t? args.length\n\t\t\t? getValue(value(...args))\n\t\t\t: getValue(value())\n\t\t: value\n\n/**\n * Identity function, given `x` returns `x`\n *\n * @template T\n * @param {T} x\n * @returns {T}\n */\nexport const identity = x => x\n\n/**\n * When `value` is an object, it will check if the `key` on `target`\n * is `configurable`\n *\n * @param {object} target\n * @param {PropertyKey} key\n * @param {boolean | undefined} value\n */\nexport const isConfigurable = (target, key, value) => {\n\tif (isObject(value)) {\n\t\tconst descriptor = getOwnPropertyDescriptor(target, key)\n\t\tif (descriptor) {\n\t\t\treturn descriptor.configurable\n\t\t}\n\t}\n\treturn true\n}\n\n/**\n * Returns `true` when `typeof` of `value` is `function`\n *\n * @template T\n * @param {T} value\n * @returns {value is ((...args:unknown[])=>T)}\n */\nexport const isFunction = value => typeof value === 'function'\n\nexport const isNaN = Number.isNaN\n\n/**\n * Returns `true` when value is Iterable\n *\n * @param {unknown} value\n * @returns {value is Iterable<unknown>}\n */\nexport const isIterable = value => value?.[iterator]\n\n/**\n * Returns `true` if the value is `null` or `undefined`\n *\n * @param {unknown} value\n * @returns {value is null | undefined}\n */\nexport const isNullUndefined = value => value == null\n\n/**\n * Returns `true` when typeof of value is object and not null\n *\n * @template T\n * @param {T} value\n * @returns {value is object}\n */\nexport const isObject = value =>\n\tvalue !== null && typeof value === 'object'\n\n/**\n * Returns `true` when `typeof` of `value` is `string`\n *\n * @param {unknown} value\n * @returns {value is string}\n */\nexport const isString = value => typeof value === 'string'\n\n/**\n * Returns `true` when `typeof` of `value` is `number`\n *\n * @param {unknown} value\n * @returns {value is number}\n */\nexport const isNumber = value => typeof value === 'number'\n\n/**\n * Returns `true` when `typeof` of `value` is `symbol`\n *\n * @param {unknown} value\n * @returns {value is symbol}\n */\nexport const isSymbol = value => typeof value === 'symbol'\n\n/**\n * Returns `true` when `typeof` of `value` is `boolean`\n *\n * @param {unknown} value\n * @returns {value is boolean}\n */\nexport const isBoolean = value => typeof value === 'boolean'\n\n/**\n * Returns `true` when `value` may be a promise\n *\n * @template T\n * @param {T} value\n * @returns {value is Promise<T>}\n */\nexport const isPromise = value =>\n\tisFunction(/** @type {any} */ (value)?.then)\n\n/**\n * @template T\n * @param {T} value\n * @returns {value is array}\n */\nexport const isArray = Array.isArray\n\n/**\n * Returns `true` when object morphed between array/object\n *\n * @param {unknown} a\n * @param {unknown} b\n * @returns {boolean}\n */\nexport const morphedBetweenArrayAndObject = (a, b) =>\n\t(isObject(a) && !isObject(b)) ||\n\t(isObject(b) && !isObject(a)) ||\n\t(isArray(a) && !isArray(b)) ||\n\t(isArray(b) && !isArray(a))\n\n/**\n * Returns `true` if the property is defined in the `prototype` and\n * absent in the `object`\n *\n * @param {object} target\n * @param {PropertyKey} key\n */\nexport const isPrototypeProperty = (target, key) =>\n\t// must do `key in target` to check that it DOES have it somewhere\n\t// must do !hasOwnProperty to check that isnt an own property\n\tkey in target && !hasOwn(target, key)\n\n// https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/GeneratorFunction\nconst GeneratorFunction = function* () {}.constructor\n\n/** Returns `true` when is a generator function */\nexport const isGeneratorFunction = target =>\n\ttarget &&\n\t(target.constructor === GeneratorFunction ||\n\t\ttarget.constructor?.constructor === GeneratorFunction)\n\n/** Function that intentionally performs no operation. */\nexport const noop = () => {}\n\n// an optional value is `true` by default, so most of the time is undefined which means is `true`\n// to avoid having conditions like `if(something.bla === undefined || something.bla)`\n// this function will short it to `if(optional(something.bla))`\n// additionally the value is resolved, for cases like `when={() => show() && optional(props.when)}`\n\n/**\n * Returns `true` when value is `true` or `undefined`\n *\n * @template T\n * @param {T} value\n * @returns {true | T} True when value is true or undefined\n */\nexport const optional = value =>\n\tvalue === undefined || getValue(value)\n\nexport function* range(start, stop, step) {\n\tif (step < 0) step = Math.abs(step)\n\tyield start\n\tif (start < stop) {\n\t\twhile (start < stop) {\n\t\t\tyield (start += step)\n\t\t}\n\t} else {\n\t\twhile (start > stop) {\n\t\t\tyield (start -= step)\n\t\t}\n\t}\n}\n\nexport const {\n\townKeys: reflectOwnKeys,\n\thas: reflectHas,\n\tdeleteProperty: reflectDeleteProperty,\n\tgetOwnPropertyDescriptor: reflectGetOwnPropertyDescriptor,\n\tget: reflectGet,\n\tapply: reflectApply,\n\tset: reflectSet,\n\tisExtensible: reflectIsExtensible,\n} = Reflect\n\n/**\n * Removes a value from an array\n *\n * @template T\n * @param {T[]} array\n * @param {T} value To remove from the array\n */\nexport function removeFromArray(array, value) {\n\tconst index = array.indexOf(value)\n\tif (index !== -1) array.splice(index, 1)\n}\n/**\n * Removes values from an array based on a condition\n *\n * @template T\n * @param {T[]} array\n * @param {(index: number, value: T) => boolean} cb Function with\n *   condition\n */\nexport function removeFromArrayConditionally(array, cb) {\n\tlet i = array.length\n\twhile (i--) {\n\t\tif (cb(i, array[i])) {\n\t\t\tarray.splice(i, 1)\n\t\t}\n\t}\n}\n/**\n * Removes values from an array based on a condition\n *\n * @template T\n * @param {Iterable<T>} iterable\n * @param {PropertyKey} key Function with condition\n */\nexport function indexByKey(iterable, key) {\n\tconst byKey = empty()\n\tfor (const item of iterable) {\n\t\tbyKey[item[key]] = item\n\t}\n\treturn byKey\n}\n\n/**\n * Returns the internal `[[Class]]` tag for a value (e.g. `Array`).\n *\n * @param {unknown} obj\n * @returns {string}\n */\nexport const typeString = obj =>\n\tObject.prototype.toString.call(obj).slice(8, -1)\n\n/**\n * Walks up a linked structure invoking `cb` for each parent until\n * `cb` returns `true`.\n *\n * @param {object} context\n * @param {PropertyKey} propertyName\n * @param {(value: any) => boolean | void} cb\n * @returns {boolean} Whether the callback succeeded.\n */\nexport function walkParents(context, propertyName, cb) {\n\twhile (context) {\n\t\tif (cb(context)) return true\n\t\tcontext = context[propertyName]\n\t}\n\treturn false\n}\n\n/** @template {Map<any, any> | WeakMap<any, any>} T */\nclass DataStore {\n\t/** @param {new () => T} kind */\n\tconstructor(kind) {\n\t\tconst store = new kind()\n\n\t\tconst get = store.get.bind(store)\n\t\tconst set = store.set.bind(store)\n\t\tconst has = store.has.bind(store)\n\t\tconst del = store.delete.bind(store)\n\n\t\tthis.set = set\n\t\tthis.has = has\n\t\tthis.delete = del\n\n\t\tthis.get = (target, defaults = null) => {\n\t\t\tconst o = get(target)\n\n\t\t\tif (defaults !== null && o === undefined) {\n\t\t\t\t/**\n\t\t\t\t * Default values should be passed as a function, so we dont\n\t\t\t\t * constantly initialize values when giving them\n\t\t\t\t */\n\t\t\t\tdefaults = defaults(target)\n\t\t\t\tset(target, defaults)\n\t\t\t\treturn defaults\n\t\t\t}\n\t\t\treturn o\n\t\t}\n\t}\n\n\t*[Symbol.iterator]() {\n\t\tyield this.get\n\t\tyield this.set\n\t\tyield this.has\n\t\tyield this.delete\n\t}\n}\n\n/**\n * Creates a WeakMap-backed `DataStore` instance.\n *\n * @returns {DataStore<WeakMap<any, any>>}\n */\nexport const weakStore = () => new DataStore(WeakMap)\n/**\n * Creates a Map-backed `DataStore` instance.\n *\n * @returns {DataStore<Map<any, any>>}\n */\nexport const cacheStore = () => new DataStore(Map)\n\n/**\n * `console.warn` wrapper kept for consistent dependency\n * injection/mocking.\n *\n * @param {...unknown} args\n * @returns {void}\n */\nexport const warn = (...args) => console.warn(...args)\n/**\n * `console.error` wrapper kept for consistent dependency\n * injection/mocking.\n *\n * @param {...unknown} args\n * @returns {void}\n */\nexport const error = (...args) => console.error(...args)\n\n/**\n * 1. A non-extensible object must return the real object, but still its\n *    children properties could be tracked/proxied\n * 2. A non-configurable property must return the real value\n *\n * [[Get]] For proxy objects enforces the following invariants:\n *\n * - The value reported for a property must be the same as the value of\n *   the corresponding target object property if the target object\n *   property is a non-writable, non-configurable own data property.\n * - The value reported for a property must be undefined if the\n *   corresponding target object property is a non-configurable own\n *   accessor property that has undefined as its [[Get]] attribute.\n */\nexport const isProxyValueReturnInvariant = (target, key, value) =>\n\t!isObject(value) ||\n\t!reflectIsExtensible(target) ||\n\treflectGetOwnPropertyDescriptor(target, key)?.configurable === false\n","// symbols\n\nimport { Symbol } from './lib/std.js'\n\nexport const $isComponent = Symbol()\nexport const $isMap = Symbol()\n\nexport const $isMutable = Symbol()\n\n// supported namespaces\n\nconst prefix = 'http://www.w3.org/'\n\n// when a tag/attribute is missing the namespace this puts it back in\n\n/** @type {Record<string, string>} */\nexport const NS = {\n\t__proto__: null,\n\tsvg: prefix + '2000/svg',\n\tmath: prefix + '1998/Math/MathML',\n\thtml: prefix + '1999/xhtml',\n\txlink: prefix + '1999/xlink',\n\txmlns: prefix + '2000/xmlns/',\n\txml: prefix + 'XML/1998/namespace',\n}\n","import {\n\tassign,\n\tcall,\n\tgetValue,\n\tisArray,\n\tisFunction,\n\tisPromise,\n\tnoop,\n\tnothing,\n\tqueueMicrotask,\n\tremoveFromArray,\n\tSymbol,\n\twalkParents,\n} from './std.js'\n\n/**\n * This is so far the core of Solid JS 1.x Reactivity, but ported to\n * classes and adapted to my taste.\n *\n * Adaptation for potas needs include:\n *\n * - Ported to Classes what does fit\n * - Signal has any options\n * - Writing to a signal returns `boolean` to tell if the value changed\n * - Signal is an object that could be used as signal.read/write or\n *   destructuring\n * - Signals can save and won't run functions\n * - `update` function on Signal that could be used to use the old value\n *   to set a new value\n * - The system is wrapped in a `createReactiveSystem` function so many\n *   systems can be run at the same time, for example for the\n *   developer tools context, so dev-tools context doesnt mess up the\n *   real context\n *\n * WARNING: typings here are a mess, Im slowly working on it.\n *\n * @url https://www.solidjs.com/\n * @url https://github.com/solidjs/solid\n * @url https://github.com/solidjs/signals\n */\n\nexport function createReactiveSystem() {\n\tconst CLEAN = 0\n\tconst STALE = 1\n\tconst CHECK = 2\n\n\t/** @type {undefined | Computation} */\n\tlet Owner\n\n\t/** @type {undefined | Computation} */\n\tlet Listener\n\n\t/** @type {undefined | Memo[]} */\n\tlet Updates\n\n\t/** @type {undefined | any[]} */\n\tlet Effects\n\n\tlet Time = 0\n\n\t// ROOT\n\n\tclass Root {\n\t\t/** @type {undefined | Root} */\n\t\towner\n\n\t\t/** @type {Computation | Computation[]} */\n\t\towned\n\n\t\t/** @type {undefined | Function | Function[]} */\n\t\tcleanups\n\n\t\t/** @type {Record<symbol, unknown>} */\n\t\tcontext\n\n\t\t/**\n\t\t * @param {Computation} owner\n\t\t * @param {object} [options]\n\t\t */\n\t\tconstructor(owner, options) {\n\t\t\tif (owner) {\n\t\t\t\tthis.owner = owner\n\n\t\t\t\tif (owner.context) {\n\t\t\t\t\tthis.context = owner.context\n\t\t\t\t}\n\t\t\t}\n\n\t\t\toptions && assign(this, options)\n\t\t}\n\t\t/** @param {Function} fn */\n\t\taddCleanups(fn) {\n\t\t\tif (!this.cleanups) {\n\t\t\t\tthis.cleanups = fn\n\t\t\t} else if (isArray(this.cleanups)) {\n\t\t\t\tthis.cleanups.push(fn)\n\t\t\t} else {\n\t\t\t\tthis.cleanups = [this.cleanups, fn]\n\t\t\t}\n\t\t}\n\t\t/** @param {Function} fn */\n\t\tcleanupCancel(fn) {\n\t\t\tif (!this.cleanups) {\n\t\t\t} else if (this.cleanups === fn) {\n\t\t\t\tthis.cleanups = undefined\n\t\t\t} else if (isArray(this.cleanups)) {\n\t\t\t\tremoveFromArray(this.cleanups, fn)\n\t\t\t}\n\t\t}\n\t\t/** @param {Computation} value */\n\t\taddOwned(value) {\n\t\t\tif (!this.owned) {\n\t\t\t\tthis.owned = value\n\t\t\t} else if (isArray(this.owned)) {\n\t\t\t\tthis.owned.push(value)\n\t\t\t} else {\n\t\t\t\tthis.owned = [this.owned, value]\n\t\t\t}\n\t\t}\n\n\t\tdispose() {\n\t\t\tthis.disposeOwned()\n\t\t\tthis.doCleanups()\n\t\t}\n\n\t\tdisposeOwned() {\n\t\t\tif (!this.owned) {\n\t\t\t} else if (isArray(this.owned)) {\n\t\t\t\tfor (let i = this.owned.length - 1; i >= 0; i--) {\n\t\t\t\t\tthis.owned[i].dispose()\n\t\t\t\t}\n\t\t\t\tthis.owned = undefined\n\t\t\t} else {\n\t\t\t\tthis.owned.dispose()\n\t\t\t\tthis.owned = undefined\n\t\t\t}\n\t\t}\n\n\t\tdoCleanups() {\n\t\t\tif (!this.cleanups) {\n\t\t\t} else if (isArray(this.cleanups)) {\n\t\t\t\tfor (let i = this.cleanups.length - 1; i >= 0; i--) {\n\t\t\t\t\tthis.cleanups[i]()\n\t\t\t\t}\n\t\t\t\tthis.cleanups = undefined\n\t\t\t} else {\n\t\t\t\tthis.cleanups()\n\t\t\t\tthis.cleanups = undefined\n\t\t\t}\n\t\t}\n\t}\n\n\t// COMPUTATION\n\n\tclass Computation extends Root {\n\t\tstate = 1 /* STALE */\n\n\t\tupdatedAt = 0\n\n\t\t/** @type {Function | undefined} */\n\t\tfn\n\n\t\tsources\n\t\tsourceSlots\n\n\t\t/**\n\t\t * @param {Computation} owner\n\t\t * @param {Function} fn\n\t\t * @param {object} [options]\n\t\t */\n\t\tconstructor(owner, fn, options) {\n\t\t\tsuper(owner, options)\n\n\t\t\tthis.fn = fn\n\n\t\t\towner && owner.addOwned(this)\n\t\t}\n\n\t\tupdate() {\n\t\t\tthis.dispose()\n\n\t\t\tconst time = Time\n\n\t\t\trunWith(this.fn, this, this)\n\n\t\t\t/*} catch (err) {\n\t\t\t\tthis.updatedAt = time + 1\n\t\t\t}*/\n\n\t\t\tif (this.updatedAt < time) {\n\t\t\t\tthis.updatedAt = time\n\t\t\t}\n\t\t}\n\n\t\tdispose() {\n\t\t\tif (this.sources && this.sources.length) {\n\t\t\t\tlet source\n\t\t\t\tlet observers\n\t\t\t\tlet index\n\n\t\t\t\tlet observer\n\t\t\t\tlet slot\n\t\t\t\twhile (this.sources.length) {\n\t\t\t\t\tsource = this.sources.pop()\n\t\t\t\t\tobservers = source.observers\n\n\t\t\t\t\tindex = this.sourceSlots.pop()\n\n\t\t\t\t\tif (observers && observers.length) {\n\t\t\t\t\t\tobserver = observers.pop()\n\t\t\t\t\t\tslot = source.observerSlots.pop()\n\n\t\t\t\t\t\tif (index < observers.length) {\n\t\t\t\t\t\t\tobserver.sourceSlots[slot] = index\n\t\t\t\t\t\t\tobservers[index] = observer\n\t\t\t\t\t\t\tsource.observerSlots[index] = slot\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tsuper.dispose()\n\n\t\t\tthis.state = 0 /* CLEAN */\n\t\t}\n\t\tqueue() {\n\t\t\tEffects.push(this)\n\t\t}\n\t}\n\n\tclass Effect extends Computation {\n\t\tuser = true\n\n\t\t/**\n\t\t * @param {Computation} owner\n\t\t * @param {Function} fn\n\t\t * @param {object} [options]\n\t\t */\n\t\tconstructor(owner, fn, options) {\n\t\t\tsuper(owner, fn, options)\n\n\t\t\tEffects ? Effects.push(this) : batch(() => this.update())\n\t\t}\n\t}\n\n\tclass SyncEffect extends Computation {\n\t\t/**\n\t\t * @param {Computation} owner\n\t\t * @param {Function} fn\n\t\t * @param {object} [options]\n\t\t */\n\t\tconstructor(owner, fn, options) {\n\t\t\tsuper(owner, fn, options)\n\n\t\t\tbatch(() => this.update())\n\t\t}\n\t}\n\n\t// SIGNALS\n\n\t/** @template in T */\n\tclass Memo extends Computation {\n\t\tvalue\n\n\t\tobservers\n\t\tobserverSlots\n\n\t\t// options:\n\t\t// equals\n\t\t/**\n\t\t * @param {Computation} owner\n\t\t * @param {Function} fn\n\t\t * @param {object} [options]\n\t\t */\n\t\tconstructor(owner, fn, options) {\n\t\t\tsuper(owner, fn, options)\n\n\t\t\tif (options) {\n\t\t\t\tassign(this, options)\n\t\t\t\tif (options.equals === false) {\n\t\t\t\t\tthis.equals = this.equalsFalse\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tread = () => {\n\t\t\tif (this.state === 1 /* STALE */) {\n\t\t\t\tthis.update()\n\t\t\t} else if (this.state === 2 /* CHECK */) {\n\t\t\t\tconst updates = Updates\n\t\t\t\tUpdates = undefined\n\t\t\t\trunUpdates(() => upstream(this))\n\t\t\t\tUpdates = updates\n\t\t\t}\n\n\t\t\tif (Listener) {\n\t\t\t\tconst sourceSlot = this.observers ? this.observers.length : 0\n\n\t\t\t\tif (Listener.sources) {\n\t\t\t\t\tListener.sources.push(this)\n\t\t\t\t\tListener.sourceSlots.push(sourceSlot)\n\t\t\t\t} else {\n\t\t\t\t\tListener.sources = [this]\n\t\t\t\t\tListener.sourceSlots = [sourceSlot]\n\t\t\t\t}\n\n\t\t\t\tconst observerSlot = Listener.sources.length - 1\n\n\t\t\t\tif (sourceSlot) {\n\t\t\t\t\tthis.observers.push(Listener)\n\t\t\t\t\tthis.observerSlots.push(observerSlot)\n\t\t\t\t} else {\n\t\t\t\t\tthis.observers = [Listener]\n\t\t\t\t\tthis.observerSlots = [observerSlot]\n\t\t\t\t}\n\t\t\t}\n\n\t\t\treturn this.value\n\t\t}\n\n\t\twrite(value) {\n\t\t\tif (!this.equals(this.value, value)) {\n\t\t\t\tthis.value = value\n\n\t\t\t\tif (this.observers && this.observers.length) {\n\t\t\t\t\trunUpdates(() => {\n\t\t\t\t\t\tfor (const observer of this.observers) {\n\t\t\t\t\t\t\tif (observer.state === 0 /* CLEAN */) {\n\t\t\t\t\t\t\t\tobserver.queue()\n\t\t\t\t\t\t\t\tobserver.observers && downstream(observer)\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tobserver.state = 1 /* STALE */\n\t\t\t\t\t\t}\n\t\t\t\t\t})\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\t/**\n\t\t * @param {T} a\n\t\t * @param {T} b\n\t\t */\n\t\tequals(a, b) {\n\t\t\treturn a === b\n\t\t}\n\t\t/**\n\t\t * @param {T} a\n\t\t * @param {T} b\n\t\t */\n\t\tequalsFalse(a, b) {\n\t\t\treturn false\n\t\t}\n\t\tupdate() {\n\t\t\tthis.dispose()\n\n\t\t\tconst time = Time\n\n\t\t\tconst nextValue = runWith(this.fn, this, this)\n\n\t\t\t/*} catch (err) {\n\t\t\t\tthis.state = 1 // STALE\n\t\t\t\tthis.disposeOwned()\n\n\t\t\t\tthis.updatedAt = time + 1\n\n\t\t\t\tthrow err\n\t\t\t} */\n\n\t\t\tif (this.updatedAt <= time) {\n\t\t\t\tthis.write(nextValue)\n\t\t\t\tthis.updatedAt = time\n\t\t\t}\n\t\t}\n\t\tqueue() {\n\t\t\tUpdates.push(this)\n\t\t}\n\t}\n\n\t/** @template in T */\n\tclass Derived extends Memo {\n\t\tvalue = nothing\n\n\t\tisResolved\n\n\t\t/**\n\t\t * @param {Computation} owner\n\t\t * @param {unknown[]} fn\n\t\t */\n\t\tconstructor(owner, fn) {\n\t\t\t// @ts-expect-error\n\t\t\tsuper(owner, fn)\n\n\t\t\treturn this.self()\n\t\t}\n\n\t\tself() {\n\t\t\treturn assign(\n\t\t\t\t/** @type {SignalFunction<Accessed<T>>} */ (\n\t\t\t\t\t/** @type {unknown} */ (...args) => {\n\t\t\t\t\t\treturn args.length ? this.write(args[0]) : this.read()\n\t\t\t\t\t}\n\t\t\t\t),\n\t\t\t\tthis,\n\t\t\t)\n\t\t}\n\n\t\tresolved = () => {\n\t\t\tthis.read() // tracking\n\t\t\treturn this.isResolved === null\n\t\t}\n\t\trun = () => {\n\t\t\tthis.update()\n\t\t}\n\t\tupdate() {\n\t\t\tthis.dispose()\n\t\t\trunWith(\n\t\t\t\t() => {\n\t\t\t\t\t// @ts-expect-error\n\t\t\t\t\tthis.write(this.fn[0](), this.fn.slice(1))\n\t\t\t\t},\n\t\t\t\tthis,\n\t\t\t\tthis,\n\t\t\t)\n\t\t\t/*\n\t\t\t\t} catch (err) {\n\t\t\t\t\tthis.state = 1 // STALE\n\t\t\t\t\tthis.disposeOwned()\n\n\t\t\t\t\tthis.updatedAt = time + 1\n\n\t\t\t\t\tthrow err\n\t\t\t\t}\n\t\t\t*/\n\t\t}\n\t\twrite(nextValue, fns) {\n\t\t\tconst time = Time\n\n\t\t\tif (this.updatedAt <= time) {\n\t\t\t\tthis.isResolved = undefined\n\n\t\t\t\twithValue(\n\t\t\t\t\tnextValue,\n\t\t\t\t\tnextValue => {\n\t\t\t\t\t\tif (this.updatedAt <= time) {\n\t\t\t\t\t\t\tif (fns && fns.length) {\n\t\t\t\t\t\t\t\tconst fn = fns.shift()\n\t\t\t\t\t\t\t\tthis.write(() => fn(nextValue), fns)\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tthis.isResolved = null\n\n\t\t\t\t\t\t\t\tthis.writeNextValue(nextValue)\n\t\t\t\t\t\t\t\tthis.updatedAt = time\n\n\t\t\t\t\t\t\t\tthis.resolve && this.resolve(this)\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t},\n\t\t\t\t\t() => {\n\t\t\t\t\t\t// is a promise so restore `then`\n\t\t\t\t\t\tthis.thenRestore()\n\n\t\t\t\t\t\t// remove the old value while the promise is resolving\n\t\t\t\t\t\t// to avoid the \"Florida - New York City\" problem\n\t\t\t\t\t\tthis.writeNextValue(nothing)\n\t\t\t\t\t},\n\t\t\t\t)\n\t\t\t}\n\t\t}\n\t\twriteNextValue(value) {\n\t\t\tif (!this.equals(this.value, value)) {\n\t\t\t\tthis.value = value\n\n\t\t\t\tif (this.observers && this.observers.length) {\n\t\t\t\t\trunUpdates(() => {\n\t\t\t\t\t\tfor (const observer of this.observers) {\n\t\t\t\t\t\t\tif (observer.state === 0 /* CLEAN */) {\n\t\t\t\t\t\t\t\tobserver.queue()\n\t\t\t\t\t\t\t\tobserver.observers && downstream(observer)\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tobserver.state = 1 /* STALE */\n\t\t\t\t\t\t}\n\t\t\t\t\t})\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\t/**\n\t\t * Thenable stuff. It has to be a property so assign works\n\t\t * properly\n\t\t */\n\t\tthen = (resolve, reject) => {\n\t\t\tthis._then(resolve, reject)\n\t\t}\n\t\t_then(resolve, reject) {\n\t\t\tthis.resolve = () => {\n\t\t\t\tthis.then = undefined\n\t\t\t\tthis.resolve = undefined\n\t\t\t\tresolve(this.self())\n\t\t\t}\n\t\t\tif (this.resolved()) {\n\t\t\t\tthis.resolve()\n\t\t\t}\n\t\t}\n\t\tthenRestore() {\n\t\t\tif (!this.then) {\n\t\t\t\t// TODO: unsure if has to be restored\n\t\t\t\tthis.then = this._then\n\t\t\t}\n\t\t}\n\t}\n\n\t// SIGNAL\n\n\t/**\n\t * @template in T\n\t * @type SignalObject<T>\n\t */\n\tclass Signal {\n\t\tvalue\n\n\t\t/** @private */\n\t\tobservers\n\t\t/** @private */\n\t\tobserverSlots\n\n\t\t// options:\n\t\t// equals\n\n\t\t/**\n\t\t * @param {T} [value]\n\t\t * @param {SignalOptions<T>} [options]\n\t\t */\n\t\tconstructor(value, options) {\n\t\t\tthis.value = value\n\t\t\tif (options) {\n\t\t\t\tassign(this, options)\n\t\t\t\tif (options.equals === false) {\n\t\t\t\t\tthis.equals = this.equalsFalse\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\t/** @returns SignalAccessor<T> */\n\t\tread = () => {\n\t\t\tif (Listener) {\n\t\t\t\tconst sourceSlot = this.observers ? this.observers.length : 0\n\n\t\t\t\tif (Listener.sources) {\n\t\t\t\t\tListener.sources.push(this)\n\t\t\t\t\tListener.sourceSlots.push(sourceSlot)\n\t\t\t\t} else {\n\t\t\t\t\tListener.sources = [this]\n\t\t\t\t\tListener.sourceSlots = [sourceSlot]\n\t\t\t\t}\n\n\t\t\t\tconst observerSlot = Listener.sources.length - 1\n\n\t\t\t\tif (sourceSlot) {\n\t\t\t\t\tthis.observers.push(Listener)\n\t\t\t\t\tthis.observerSlots.push(observerSlot)\n\t\t\t\t} else {\n\t\t\t\t\tthis.observers = [Listener]\n\t\t\t\t\tthis.observerSlots = [observerSlot]\n\t\t\t\t}\n\t\t\t}\n\n\t\t\treturn this.value\n\t\t}\n\t\t/**\n\t\t * @param {T} [value]\n\t\t * @returns SignalSetter<T>\n\t\t */\n\t\twrite = value => {\n\t\t\tif (!this.equals(this.value, value)) {\n\t\t\t\tthis.value = value\n\n\t\t\t\tif (this.observers && this.observers.length) {\n\t\t\t\t\trunUpdates(() => {\n\t\t\t\t\t\tfor (const observer of this.observers) {\n\t\t\t\t\t\t\tif (observer.state === 0 /* CLEAN */) {\n\t\t\t\t\t\t\t\tobserver.queue()\n\t\t\t\t\t\t\t\tobserver.observers && downstream(observer)\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tobserver.state = 1 /* STALE */\n\t\t\t\t\t\t}\n\t\t\t\t\t})\n\t\t\t\t}\n\t\t\t\treturn true\n\t\t\t}\n\t\t\treturn false\n\t\t}\n\t\t/**\n\t\t * @type SignalUpdate<T>\n\t\t * @returns SignalUpdate<T>\n\t\t */\n\t\tupdate = value => this.write(untrack(() => value(this.value)))\n\n\t\t/**\n\t\t * @param {T} a\n\t\t * @param {T} b\n\t\t */\n\t\tequals(a, b) {\n\t\t\treturn a === b\n\t\t}\n\n\t\t/**\n\t\t * @param {T} a\n\t\t * @param {T} b\n\t\t */\n\t\tequalsFalse(a, b) {\n\t\t\treturn false\n\t\t}\n\n\t\t*[Symbol.iterator]() {\n\t\t\t/** @type SignalAccessor<T> */\n\t\t\tyield this.read\n\t\t\t/** @type SignalSetter<T> */\n\t\t\tyield this.write\n\t\t\t/** @type SignalUpdate<T> */\n\t\t\tyield this.update\n\t\t}\n\t}\n\n\t// API\n\n\t/**\n\t * Creates a new root\n\t *\n\t * @template T\n\t * @param {(dispose: () => void) => T} fn\n\t * @param {object} [options]\n\t * @returns {T}\n\t */\n\tfunction root(fn, options) {\n\t\tconst root = new Root(Owner, options)\n\t\treturn runWithOwner(root, () => fn(() => root.dispose()))\n\t}\n\n\t/**\n\t * Creates a signal\n\t *\n\t * @template T\n\t * @param {T} [initialValue] - Initial value of the signal\n\t * @param {SignalOptions<T>} [options] - Signal options\n\t */\n\t/* #__NO_SIDE_EFFECTS__ */ function signal(initialValue, options) {\n\t\treturn /** @type {SignalObject<T>} */ (\n\t\t\t/** @type {unknown} */ (new Signal(initialValue, options))\n\t\t)\n\t}\n\n\t/**\n\t * Creates an effect\n\t *\n\t * @template T\n\t * @param {() => T} fn\n\t * @param {object} [options]\n\t */\n\tfunction effect(fn, options) {\n\t\tnew Effect(Owner, fn, options)\n\t}\n\n\t/**\n\t * Creates an run once effect\n\t *\n\t * @template T\n\t * @param {() => T} fn\n\t * @param {object} [options]\n\t */\n\tfunction track(fn, options) {\n\t\tlet ran\n\t\tnew Effect(\n\t\t\tOwner,\n\t\t\t() => {\n\t\t\t\tif (ran === undefined) {\n\t\t\t\t\tran = null\n\t\t\t\t\tfn()\n\t\t\t\t}\n\t\t\t},\n\t\t\toptions,\n\t\t)\n\t}\n\n\t/**\n\t * Creates a syncEffect\n\t *\n\t * @template T\n\t * @param {() => T} fn\n\t * @param {object} [options]\n\t * @returns T\n\t */\n\tfunction syncEffect(fn, options) {\n\t\tnew SyncEffect(Owner, fn, options)\n\t}\n\n\t/**\n\t * Creates an effect with explicit dependencies\n\t *\n\t * @template T\n\t * @param {Function} depend - Function that causes tracking\n\t * @param {() => T} fn - Function that wont cause tracking\n\t * @param {object} [options]\n\t */\n\tfunction on(depend, fn, options) {\n\t\teffect(() => {\n\t\t\tdepend()\n\t\t\tuntrack(fn)\n\t\t}, options)\n\t}\n\n\t/**\n\t * Creates a read-only signal from the return value of a function\n\t * that automatically updates\n\t *\n\t * @template T\n\t * @param {() => T} fn - Function to re-run when dependencies change\n\t * @param {SignalOptions<T>} [options]\n\t * @returns {SignalAccessor<T>}\n\t */\n\t/* #__NO_SIDE_EFFECTS__ */ function memo(fn, options = undefined) {\n\t\treturn /** @type {SignalAccessor<T>} */ (\n\t\t\t/** @type {unknown} */ (new Memo(Owner, fn, options).read)\n\t\t)\n\t}\n\n\t/**\n\t * Lazy and writable version of `memo` that unwraps and tracks\n\t * functions and promises recursively\n\t */\n\t/* #__NO_SIDE_EFFECTS__ */ const derived =\n\t\t/** @type {import('./derived.d.ts').derived} */ (\n\t\t\t/** @type {unknown} */ (...fn) =>\n\t\t\t\t/** @type {import('./derived.d.ts').derived} */ (\n\t\t\t\t\t/** @type {unknown} */ (new Derived(Owner, fn))\n\t\t\t\t)\n\t\t)\n\n\t/**\n\t * Batches changes to signals\n\t *\n\t * @template T\n\t * @param {() => T} fn\n\t */\n\tconst batch = runUpdates\n\n\t/**\n\t * Returns current owner\n\t *\n\t * @returns {Computation}\n\t */\n\tfunction owner() {\n\t\treturn Owner\n\t}\n\n\t/**\n\t * Runs a function with owner and listener\n\t *\n\t * @param {Function} fn\n\t * @param {Computation} owner\n\t * @param {Listener} [listener]\n\t */\n\tfunction runWith(fn, owner, listener = undefined) {\n\t\tif (listener === Listener && owner === Owner) {\n\t\t\treturn fn()\n\t\t}\n\n\t\tconst prevOwner = Owner\n\t\tconst prevListener = Listener\n\n\t\tOwner = owner\n\t\tListener = listener\n\n\t\ttry {\n\t\t\treturn fn()\n\t\t} finally {\n\t\t\tOwner = prevOwner\n\t\t\tListener = prevListener\n\t\t}\n\t}\n\tfunction runWithOwner(owner, fn) {\n\t\treturn runWith(() => runUpdates(fn, true), owner)\n\t}\n\n\t/**\n\t * Disables tracking for a function\n\t *\n\t * @template T\n\t * @param {() => T} fn - Function to run with tracking disabled\n\t * @returns {T}\n\t */\n\tfunction untrack(fn) {\n\t\tif (Listener === undefined) {\n\t\t\treturn fn()\n\t\t}\n\n\t\treturn runWith(fn, Owner)\n\t}\n\n\t/**\n\t * Runs a callback on cleanup, returns callback\n\t *\n\t * @template {Function} T\n\t * @param {T} fn\n\t * @returns {T}\n\t */\n\tfunction cleanup(fn) {\n\t\tOwner?.addCleanups(fn)\n\t\treturn fn\n\t}\n\n\t// UPDATES\n\n\tfunction runTop(node) {\n\t\tswitch (node.state) {\n\t\t\tcase 0 /* CLEAN */: {\n\t\t\t\tbreak\n\t\t\t}\n\t\t\tcase 2 /* CHECK */: {\n\t\t\t\tupstream(node)\n\t\t\t\tbreak\n\t\t\t}\n\n\t\t\tdefault: {\n\t\t\t\tconst ancestors = []\n\n\t\t\t\tdo {\n\t\t\t\t\tnode.state && ancestors.push(node)\n\n\t\t\t\t\tnode = node.owner\n\t\t\t\t} while (node && node.updatedAt < Time)\n\n\t\t\t\tfor (let i = ancestors.length - 1, updates; i >= 0; i--) {\n\t\t\t\t\tnode = ancestors[i]\n\n\t\t\t\t\tswitch (node.state) {\n\t\t\t\t\t\tcase 1 /* STALE */: {\n\t\t\t\t\t\t\tnode.update()\n\t\t\t\t\t\t\tbreak\n\t\t\t\t\t\t}\n\t\t\t\t\t\tcase 2 /* CHECK */: {\n\t\t\t\t\t\t\tupdates = Updates\n\t\t\t\t\t\t\tUpdates = undefined\n\t\t\t\t\t\t\trunUpdates(() => upstream(node, ancestors[0]))\n\t\t\t\t\t\t\tUpdates = updates\n\t\t\t\t\t\t\tbreak\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\t/**\n\t * @template T\n\t * @param {() => T} fn\n\t * @param {boolean} init\n\t * @returns {T}\n\t */\n\tfunction runUpdates(fn, init = false) {\n\t\tif (Updates) {\n\t\t\treturn fn()\n\t\t}\n\n\t\tlet wait = false\n\n\t\tif (!init) {\n\t\t\tUpdates = []\n\t\t}\n\n\t\tif (Effects) {\n\t\t\twait = true\n\t\t} else {\n\t\t\tEffects = []\n\t\t}\n\n\t\tTime++\n\n\t\ttry {\n\t\t\tconst res = fn()\n\n\t\t\tif (Updates) {\n\t\t\t\tfor (const update of Updates) {\n\t\t\t\t\trunTop(update)\n\t\t\t\t}\n\t\t\t}\n\t\t\tUpdates = undefined\n\n\t\t\tif (!wait) {\n\t\t\t\tconst effects = Effects\n\t\t\t\tEffects = undefined\n\t\t\t\teffects.length && runUpdates(() => runEffects(effects))\n\t\t\t}\n\n\t\t\treturn res\n\t\t} catch (err) {\n\t\t\tif (!wait) {\n\t\t\t\tEffects = undefined\n\t\t\t}\n\t\t\tUpdates = undefined\n\n\t\t\tthrow err\n\t\t}\n\t}\n\n\tfunction runEffects(queue) {\n\t\tlet userLength = 0\n\t\tfor (const effect of queue) {\n\t\t\tif (effect.user) {\n\t\t\t\tqueue[userLength++] = effect\n\t\t\t} else {\n\t\t\t\trunTop(effect)\n\t\t\t}\n\t\t}\n\n\t\tfor (let i = 0; i < userLength; i++) {\n\t\t\trunTop(queue[i])\n\t\t}\n\t}\n\n\tfunction upstream(node, ignore) {\n\t\tnode.state = 0 /* CLEAN */\n\n\t\tfor (const source of node.sources) {\n\t\t\tif (source.sources) {\n\t\t\t\tswitch (source.state) {\n\t\t\t\t\tcase 1 /* STALE */: {\n\t\t\t\t\t\tif (source !== ignore && source.updatedAt < Time) {\n\t\t\t\t\t\t\trunTop(source)\n\t\t\t\t\t\t}\n\t\t\t\t\t\tbreak\n\t\t\t\t\t}\n\t\t\t\t\tcase 2 /* CHECK */: {\n\t\t\t\t\t\tupstream(source, ignore)\n\t\t\t\t\t\tbreak\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tfunction downstream(node) {\n\t\tfor (const observer of node.observers) {\n\t\t\tif (observer.state === 0 /* CLEAN */) {\n\t\t\t\tobserver.state = 2 /* CHECK */\n\t\t\t\tobserver.queue()\n\t\t\t\tobserver.observers && downstream(observer)\n\t\t\t}\n\t\t}\n\t}\n\n\t/**\n\t * Creates a context and returns a function to get or set the value\n\t *\n\t * @template T\n\t * @param {T} [defaultValue] - Default value for the context\n\t */\n\t/* #__NO_SIDE_EFFECTS__ */ function context(\n\t\tdefaultValue = undefined,\n\t) {\n\t\tconst id = Symbol()\n\n\t\t/**\n\t\t * @overload Runs `fn` with a new value as context\n\t\t * @param {T} newValue - New value for the context\n\t\t * @param {() => Children} fn - Callback to run with the new\n\t\t *   context value\n\t\t * @returns {Children} Context value\n\t\t */\n\t\t/**\n\t\t * @overload Gets the context value\n\t\t * @returns {T} Context value\n\t\t */\n\t\tfunction useContext(newValue, fn) {\n\t\t\tif (newValue === undefined) {\n\t\t\t\treturn Owner?.context && Owner.context[id] !== undefined\n\t\t\t\t\t? Owner.context[id]\n\t\t\t\t\t: defaultValue\n\t\t\t} else {\n\t\t\t\tlet ret\n\t\t\t\tsyncEffect(() => {\n\t\t\t\t\tOwner.context = {\n\t\t\t\t\t\t...Owner.context,\n\t\t\t\t\t\t[id]: newValue,\n\t\t\t\t\t}\n\t\t\t\t\tret = untrack(fn)\n\t\t\t\t})\n\t\t\t\treturn ret\n\t\t\t}\n\t\t}\n\n\t\t/**\n\t\t * Sets the `value` for the context\n\t\t *\n\t\t * @param {object} props\n\t\t * @param {Partial<T>} props.value\n\t\t * @param {Children} props.children\n\t\t * @returns {Children} Children\n\t\t * @url https://pota.quack.uy/Reactivity/Context\n\t\t */\n\t\tuseContext.Provider = props =>\n\t\t\t// @ts-expect-error\n\t\t\tuseContext(props.value, () => context.toHTML(props.children))\n\n\t\t/**\n\t\t * Maps context following `parent` property (if any). When `true`\n\t\t * is returned from the callback it stops walking.\n\t\t *\n\t\t * @param {(context: T) => boolean | void} callback\n\t\t * @param {T} [context]\n\t\t */\n\t\tuseContext.walk = (callback, context) =>\n\t\t\twalkParents(context || useContext(), 'parent', callback)\n\n\t\treturn useContext\n\t}\n\n\t/**\n\t * Returns an owned function, that will only run if the owner wasnt\n\t * dispose already. `onCancel` will run if the owner of the owned\n\t * function is disposed, and wont run if the owned function runs.\n\t *\n\t * @template T\n\t * @template A\n\t * @param {((...args: A[]) => T) | Function} cb\n\t * @param {() => void} [onCancel]\n\t */\n\tconst owned = (cb, onCancel) => {\n\t\tif (cb) {\n\t\t\tconst o = Owner\n\n\t\t\t/**\n\t\t\t * Canceling prevent the callback from running and runs\n\t\t\t * `onCancel` if provided.\n\t\t\t */\n\t\t\tlet cleaned\n\t\t\tconst clean = cleanup(() => {\n\t\t\t\tcleaned = null\n\t\t\t\tonCancel && onCancel()\n\t\t\t})\n\n\t\t\treturn (...args) => {\n\t\t\t\to?.cleanupCancel(clean)\n\t\t\t\treturn cleaned !== null && runWithOwner(o, () => cb(...args))\n\t\t\t}\n\t\t}\n\t\treturn noop\n\t}\n\n\t/**\n\t * Unwraps and tracks functions and promises recursively providing\n\t * the result to a callback\n\t *\n\t * @template T\n\t * @param {Accessor<T> | Promise<T>} value\n\t * @param {(value: T) => void} fn\n\t */\n\tfunction withValue(value, fn, writeDefaultValue = noop) {\n\t\tif (isFunction(value)) {\n\t\t\t// TODO maybe change this to be a memo\n\t\t\teffect(() => withValue(value(), fn, writeDefaultValue))\n\t\t} else if (isPromise(value)) {\n\t\t\tasyncTracking.add()\n\t\t\t/**\n\t\t\t * WriteDefaultValue is used to avoid a double write. If the\n\t\t\t * value has no promises, then it will be a native value or a\n\t\t\t * function, which will resolve without having to wait.\n\t\t\t *\n\t\t\t * In case of promises, the value is resolved at a later point\n\t\t\t * in time, so we need an intermediate default\n\t\t\t */\n\t\t\twriteDefaultValue()\n\n\t\t\tvalue.then(\n\t\t\t\towned(\n\t\t\t\t\tvalue => {\n\t\t\t\t\t\tasyncTracking.remove()\n\t\t\t\t\t\twithValue(value, fn, noop)\n\t\t\t\t\t},\n\t\t\t\t\t() => asyncTracking.remove(),\n\t\t\t\t),\n\t\t\t)\n\t\t} else {\n\t\t\tfn(value)\n\t\t}\n\t}\n\n\t/**\n\t * Unwraps functions and promises recursively canceling if owner\n\t * gets disposed\n\t */\n\tconst resolve = (value, cbs) =>\n\t\tisFunction(value)\n\t\t\t? track(() => resolve(getValue(value), cbs))\n\t\t\t: isPromise(value)\n\t\t\t\t? value.then(owned(value => resolve(value, cbs)))\n\t\t\t\t: cbs.length\n\t\t\t\t\t? resolve(() => cbs[0](value), cbs.slice(1))\n\t\t\t\t\t: value\n\n\t/**\n\t * Unwraps functions and promises recursively canceling if owner\n\t * gets disposed\n\t *\n\t * @type {import('./action.d.ts').action}\n\t */\n\tconst action = (...cbs) =>\n\t\towned((...args) => {\n\t\t\tresolve(() => cbs[0](...args), cbs.slice(1))\n\t\t})\n\n\t/** Utilities exposed for tracking async work from user-land. */\n\n\tconst asyncTracking = (() => {\n\t\tlet added = false\n\t\tlet fns = []\n\t\tlet count = 0\n\n\t\tfunction add() {\n\t\t\tcount++\n\t\t}\n\n\t\tfunction remove() {\n\t\t\t--count === 0 && queue()\n\t\t}\n\t\tfunction ready(fn) {\n\t\t\tfns.push(owned(fn))\n\t\t\tqueue()\n\t\t}\n\n\t\tfunction queue() {\n\t\t\tif (!added && fns.length) {\n\t\t\t\tadded = true\n\t\t\t\tqueueMicrotask(() => queueMicrotask(() => run()))\n\t\t\t}\n\t\t}\n\t\tfunction run() {\n\t\t\tadded = false\n\n\t\t\tif (count === 0) {\n\t\t\t\tconst cbs = fns.slice()\n\t\t\t\tfns.length = 0\n\t\t\t\tcall(cbs)\n\t\t\t}\n\t\t}\n\t\treturn { add, remove, ready }\n\t})()\n\n\t/** Suspense */\n\tclass createSuspenseContext {\n\t\ts = signal(false)\n\t\tc = 0\n\t\tadd() {\n\t\t\tthis.c++\n\t\t\tasyncTracking.add()\n\t\t}\n\t\tremove() {\n\t\t\tif (--this.c === 0) {\n\t\t\t\tthis.s.write(true)\n\t\t\t}\n\t\t\tasyncTracking.remove()\n\t\t}\n\t\tisEmpty() {\n\t\t\treturn this.c === 0\n\t\t}\n\t}\n\n\tconst useSuspense = context(new createSuspenseContext())\n\n\t// export\n\n\treturn {\n\t\taction,\n\t\tasyncTracking,\n\t\tbatch,\n\t\tcleanup,\n\t\tcontext,\n\t\tcreateSuspenseContext,\n\t\tderived,\n\t\teffect,\n\t\tmemo,\n\t\ton,\n\t\towned,\n\t\towner,\n\t\troot,\n\t\trunWithOwner,\n\t\tsignal,\n\t\tsyncEffect,\n\t\tuntrack,\n\t\tuseSuspense,\n\t\twithValue,\n\t}\n}\n","import { $isComponent, $isMap } from '../constants.js'\n\nimport {\n\temptyArray,\n\tflatNoArray,\n\tgetValue,\n\tisArray,\n\tisFunction,\n\tqueueMicrotask,\n\tremoveFromArray,\n\tresolved,\n\twithResolvers,\n\ttoEntries,\n} from './std.js'\n\n// solid\n\nimport { createReactiveSystem } from './solid.js'\n\nconst {\n\taction,\n\tasyncTracking,\n\tbatch,\n\tcleanup,\n\tcontext,\n\tcreateSuspenseContext,\n\tderived,\n\teffect,\n\tmemo,\n\ton,\n\towned,\n\towner,\n\troot,\n\trunWithOwner,\n\tsignal,\n\tsyncEffect,\n\tuntrack,\n\tuseSuspense,\n\twithValue,\n} = createReactiveSystem()\n\nexport {\n\taction,\n\tasyncTracking,\n\tbatch,\n\tcleanup,\n\tcontext,\n\tcreateSuspenseContext,\n\tderived,\n\teffect,\n\tmemo,\n\ton,\n\towned,\n\towner,\n\troot,\n\trunWithOwner,\n\tsignal,\n\tsyncEffect,\n\tuntrack,\n\tuseSuspense,\n\twithValue,\n\tcreateReactiveSystem,\n}\n\n/**\n * A self contained signal function, when an argument is present it\n * writes to the signal, when theres no argument it reads the signal.\n *\n * @template T\n * @param {T} [value] - Optional initial value\n * @returns {SignalFunction<T>}\n */\nexport function signalFunction(value) {\n\tconst [read, write] = signal(value)\n\t// @ts-expect-error\n\treturn (...args) => (args.length ? write(args[0]) : read())\n}\n\n/**\n * To set and read refs. To use in ref attribute.\n *\n * @template {DOMElement} T\n * @returns {SignalFunction<T>}\n */\nexport const ref = () => signalFunction()\n\n/**\n * Runs a function inside an effect if value is a function\n *\n * @param {unknown} value\n * @param {(value: unknown, prev?: unknown) => unknown} fn\n */\nexport function withPrevValue(value, fn) {\n\tif (isFunction(value)) {\n\t\tlet prev\n\t\teffect(() => {\n\t\t\tconst val = getValue(value)\n\t\t\tfn(val, prev)\n\t\t\tprev = val\n\t\t})\n\t} else {\n\t\tfn(value)\n\t}\n}\n\n/**\n * Returns `true` when all derived has been resolved\n *\n * @template {ReturnType<import('./derived.d.ts').derived>} T\n * @param {...T} args\n * @returns {boolean}\n */\nexport function isResolved(...args) {\n\treturn !args.some(x => !x.resolved())\n}\n\n/**\n * Creates an asynchronously effect\n *\n * @param {(currentRunningEffect: Promise<any>) => any} fn - A\n *   function that receives a `currentRunningEffect` that should be\n *   awaited for when wanting to run effects synchronously, that's it\n *   one effect after another.\n */\nexport function asyncEffect(fn) {\n\t/** @type {Promise<any>[]} */\n\tconst queue = []\n\teffect(() => {\n\t\tconst { promise, resolve } = withResolvers()\n\n\t\tqueue.push(promise)\n\n\t\tfunction onDone() {\n\t\t\tremoveFromArray(queue, promise)\n\t\t\tresolve()\n\t\t}\n\n\t\tresolved(\n\t\t\tfn(queue.length === 1 ? undefined : queue[queue.length - 2]),\n\t\t\tonDone,\n\t\t)\n\t})\n}\n\n/** @param {() => unknown} fn */\nexport const microtask = fn => queueMicrotask(owned(fn))\n\n// MAP\n\nclass Row {\n\trunId\n\titem\n\tindex\n\tisDupe\n\tdisposer\n\tnodes\n\tindexSignal\n\t_begin\n\t_end\n\tconstructor(item, index, fn, isDupe, reactiveIndex) {\n\t\tthis.item = item\n\t\tthis.index = index\n\t\tthis.isDupe = isDupe\n\n\t\troot(disposer => {\n\t\t\tthis.disposer = disposer\n\t\t\tif (reactiveIndex) {\n\t\t\t\tthis.indexSignal = signal(index)\n\t\t\t\t/** @type Children[] */\n\t\t\t\tthis.nodes = fn(item, this.indexSignal.read)\n\t\t\t} else {\n\t\t\t\t/** @type Children[] */\n\t\t\t\tthis.nodes = fn(item, index)\n\t\t\t}\n\t\t})\n\t}\n\n\tupdateIndex(index) {\n\t\tif (this.index !== index) {\n\t\t\tthis.index = index // save sort order\n\t\t\tif (this.indexSignal) {\n\t\t\t\tthis.indexSignal.write(index)\n\t\t\t}\n\t\t}\n\t}\n\tbegin() {\n\t\tif (!this._begin) {\n\t\t\tthis.getBegin(this.nodes)\n\t\t}\n\t\treturn this._begin\n\t}\n\tgetBegin(nodes) {\n\t\tif (isArray(nodes)) {\n\t\t\treturn this.getBegin(nodes[0])\n\t\t}\n\t\tthis._begin = nodes\n\t}\n\tend() {\n\t\tif (!this._end) {\n\t\t\tthis.getEnd(this.nodes)\n\t\t}\n\t\treturn this._end\n\t}\n\tgetEnd(nodes) {\n\t\tif (isArray(nodes)) {\n\t\t\treturn this.getEnd(nodes[nodes.length - 1])\n\t\t}\n\t\tthis._end = nodes\n\t}\n\tnodesForRow() {\n\t\tconst begin = this.begin()\n\t\tconst end = this.end()\n\n\t\tconst nodes = [begin]\n\n\t\tlet nextSibling = begin\n\t\twhile (nextSibling !== end) {\n\t\t\tnextSibling = nextSibling.nextSibling\n\t\t\tnodes.push(nextSibling)\n\t\t}\n\n\t\treturn nodes\n\t}\n}\n\n/**\n * Reactive Map\n *\n * @template T\n * @param {Each<T>} list\n * @param {(...args: unknown[]) => Children} callback\n * @param {boolean} [noSort]\n * @param {Children} [fallback]\n * @param {boolean} [reactiveIndex] - Make indices reactive signals\n */\nexport function map(list, callback, noSort, fallback, reactiveIndex) {\n\tconst cache = new Map()\n\tconst duplicates = new Map() // for when caching by value is not possible [1, 2, 1, 1, 1]\n\n\tlet runId = 0\n\n\t/** @type Row[] */\n\tlet rows = []\n\t/** @type Row[] */\n\tlet prev = []\n\n\tfunction clear() {\n\t\tfor (const row of prev) {\n\t\t\trow.disposer()\n\t\t}\n\t\tcache.clear()\n\t\tduplicates.clear()\n\n\t\trows.length = 0\n\t\tprev.length = 0\n\t}\n\n\t// to get rid of all nodes when parent disposes\n\tcleanup(clear)\n\n\tfunction dispose(row) {\n\t\t// delete from cache\n\t\tif (!row.isDupe) {\n\t\t\tcache.delete(row.item)\n\t\t} else {\n\t\t\tconst arr = duplicates.get(row.item)\n\t\t\tarr.length === 1\n\t\t\t\t? duplicates.delete(row.item)\n\t\t\t\t: removeFromArray(arr, row)\n\t\t}\n\n\t\trow.disposer()\n\t}\n\n\t/**\n\t * @param {Function} [fn]\n\t * @returns {Children}\n\t */\n\tfunction mapper(fn) {\n\t\tconst cb = fn\n\t\t\t? (item, index) => fn(callback(item, index), index)\n\t\t\t: callback\n\n\t\tconst value = getValue(list) || emptyArray\n\n\t\t/** To allow iterate objects as if were an array with indexes */\n\t\tconst items = toEntries(value)\n\n\t\trunId++\n\n\t\trows = []\n\t\tconst hasPrev = prev.length\n\n\t\tfor (const [index, item] of items) {\n\t\t\tlet row = hasPrev ? cache.get(item) : undefined\n\n\t\t\tif (row === undefined) {\n\t\t\t\t// if the item doesnt exists, create it\n\t\t\t\trow = new Row(item, index, cb, false, reactiveIndex)\n\t\t\t\tcache.set(item, row)\n\t\t\t} else if (row.runId === runId) {\n\t\t\t\t// a map will save only 1 of any primitive duplicates, say: [1, 1, 1, 1]\n\t\t\t\t// if the saved value was already used on this run, create a new one\n\t\t\t\tlet dupes = duplicates.get(item)\n\t\t\t\tif (!dupes) {\n\t\t\t\t\tdupes = []\n\t\t\t\t\tduplicates.set(item, dupes)\n\t\t\t\t}\n\t\t\t\tfor (const dupe of dupes) {\n\t\t\t\t\tif (dupe.runId !== runId) {\n\t\t\t\t\t\trow = dupe\n\t\t\t\t\t\tbreak\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif (row.runId === runId) {\n\t\t\t\t\trow = new Row(item, index, cb, true, reactiveIndex)\n\t\t\t\t\tdupes.push(row)\n\t\t\t\t}\n\t\t\t}\n\n\t\t\trow.runId = runId // mark used on this run\n\t\t\trow.updateIndex(index) // Update existing row's index (reactive if needed)\n\t\t\trows.push(row)\n\t\t}\n\n\t\t// fast clear\n\t\tif (rows.length === 0) {\n\t\t\thasPrev && clear()\n\t\t\tprev = rows\n\t\t\treturn fallback ? fn(fallback) : emptyArray\n\t\t}\n\n\t\t// sort\n\t\tif (hasPrev) {\n\t\t\t// remove rows that arent present on the current run\n\t\t\tfor (let i = 0; i < prev.length; i++) {\n\t\t\t\tif (prev[i].runId !== runId) {\n\t\t\t\t\tdispose(prev[i])\n\t\t\t\t\tremoveFromArray(prev, prev[i--])\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t// reorder elements\n\t\t\t// `rows.length > 1` because no need for sorting when there are no items\n\t\t\t// `prev.length > 0` to skip sorting on creation as its already sorted\n\t\t\tif (!noSort && rows.length > 1 && prev.length) {\n\t\t\t\t// when appending to already created it shouldnt sort\n\t\t\t\t// as its already sorted\n\t\t\t\tconst unsort = []\n\t\t\t\tfor (let i = 0; i < prev.length && i < rows.length; i++) {\n\t\t\t\t\tif (prev[i] !== rows[i]) {\n\t\t\t\t\t\tunsort.push(rows[i])\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tif (unsort.length) {\n\t\t\t\t\tlet unsorted = unsort.length\n\t\t\t\t\tif (unsorted) {\n\t\t\t\t\t\tconst sorted = []\n\n\t\t\t\t\t\t// handle swap - unsorted rows should move only next to already sorted\n\t\t\t\t\t\tfor (const usort of unsort) {\n\t\t\t\t\t\t\tif (\n\t\t\t\t\t\t\t\trows[usort.index - 1] &&\n\t\t\t\t\t\t\t\t(!unsort.includes(rows[usort.index - 1]) ||\n\t\t\t\t\t\t\t\t\tsorted.includes(rows[usort.index - 1]))\n\t\t\t\t\t\t\t) {\n\t\t\t\t\t\t\t\trows[usort.index - 1]\n\t\t\t\t\t\t\t\t\t.end()\n\t\t\t\t\t\t\t\t\t.after(...usort.nodesForRow())\n\t\t\t\t\t\t\t\tsorted.push(usort)\n\t\t\t\t\t\t\t\tunsorted--\n\t\t\t\t\t\t\t} else if (\n\t\t\t\t\t\t\t\trows[usort.index + 1] &&\n\t\t\t\t\t\t\t\t(!unsort.includes(rows[usort.index + 1]) ||\n\t\t\t\t\t\t\t\t\tsorted.includes(rows[usort.index - 1]))\n\t\t\t\t\t\t\t) {\n\t\t\t\t\t\t\t\trows[usort.index + 1]\n\t\t\t\t\t\t\t\t\t.begin()\n\t\t\t\t\t\t\t\t\t.before(...usort.nodesForRow())\n\t\t\t\t\t\t\t\tsorted.push(usort)\n\t\t\t\t\t\t\t\tunsorted--\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tif (unsorted) {\n\t\t\t\t\t\t\t// handles all other cases\n\t\t\t\t\t\t\t// best for any combination of: push/pop/shift/unshift/insertion/deletion\n\t\t\t\t\t\t\t// must check in reverse as on creation stuff is added to the end\n\n\t\t\t\t\t\t\tlet current = rows[rows.length - 1]\n\t\t\t\t\t\t\tfor (let i = rows.length - 1; i > 0; i--) {\n\t\t\t\t\t\t\t\tconst previous = rows[i - 1]\n\t\t\t\t\t\t\t\tif (\n\t\t\t\t\t\t\t\t\tcurrent.begin().previousSibling !== previous.end()\n\t\t\t\t\t\t\t\t) {\n\t\t\t\t\t\t\t\t\tcurrent.begin().before(...previous.nodesForRow())\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tcurrent = previous\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\t// save sorted list\n\t\tprev = rows\n\n\t\t// return external representation\n\t\treturn rows.map(item => item.nodes)\n\t}\n\tmapper[$isMap] = undefined\n\treturn mapper\n}\n\n/**\n * Resolves and returns `children` in a memo. A memo in a memo, so\n * reactivity on the inner memo doesnt trigger reactivity outside.\n *\n * @template {Children} T\n * @param {T | (() => T)} fn\n * @url https://pota.quack.uy/resolve\n */\nexport function resolve(fn) {\n\tconst children = isFunction(fn) ? memo(fn) : () => fn\n\treturn memo(() => unwrap(children()))\n}\n\n/**\n * Recursively unwrap children functions\n *\n * @param {Children} children\n */\nfunction unwrap(children) {\n\tif (isFunction(children)) {\n\t\treturn unwrap(children())\n\t}\n\n\tif (isArray(children)) {\n\t\tconst childrens = []\n\t\tfor (let child of children) {\n\t\t\tchild = unwrap(child)\n\t\t\tisArray(child)\n\t\t\t\t? childrens.push(...child)\n\t\t\t\t: childrens.push(child)\n\t\t}\n\t\treturn childrens\n\t}\n\n\treturn children\n}\n\n/**\n * Returns true if the `value` is a `Component`\n *\n * @param {any} value\n * @returns {boolean}\n */\nexport const isComponent = value =>\n\tisFunction(value) && $isComponent in value\n\n/**\n * Makes of `children` a function. Reactive children will run as is,\n * non-reactive children will run untracked, regular children will\n * just return.\n *\n * @template {Children | Children[]} T\n * @param {T} children\n * @returns {(...args: unknown[]) => T}\n */\nexport function makeCallback(children) {\n\t/** Shortcut the most used case */\n\tif (isFunction(children)) {\n\t\treturn markComponent(children)\n\t}\n\n\t/**\n\t * When children is an array, as in `>${[0, 1, 2]}<` then children\n\t * will end as `[[0, 1, 2]]`, so flat it\n\t */\n\tconst childrenMaybeArray = flatNoArray(children)\n\n\treturn isArray(childrenMaybeArray)\n\t\t? markComponent((...args) =>\n\t\t\t\tchildrenMaybeArray.map(child =>\n\t\t\t\t\tisFunction(child) ? child(...args) : child,\n\t\t\t\t),\n\t\t\t)\n\t\t: markComponent((...args) =>\n\t\t\t\tisFunction(childrenMaybeArray)\n\t\t\t\t\t? childrenMaybeArray(...args)\n\t\t\t\t\t: childrenMaybeArray,\n\t\t\t)\n}\n\n/**\n * Marks a function as a `Component`.\n *\n * Allows to tell a `signal function` from a `component function`.\n * Signals and user functions go in effects, for reactivity.\n * Components and callbacks are untracked and wont go in effects to\n * avoid re-rendering if signals are used in the components body\n */\nexport function markComponent(fn) {\n\tfn[$isComponent] = undefined\n\treturn fn\n}\n\n/**\n * Adds an event listener to a node\n *\n * @template {Document | typeof window | DOMElement} TargetElement\n * @param {TargetElement} node - Element to add the event listener\n * @param {EventName} type - The name of the event listener\n * @param {EventHandler<Event, TargetElement>} handler - Function to\n *   handle the event\n * @returns {Function} - An `off` function for removing the event\n *   listener\n * @url https://pota.quack.uy/props/EventListener\n */\nexport function addEvent(node, type, handler) {\n\tnode.addEventListener(\n\t\ttype,\n\t\t/** @type {EventListenerOrEventListenerObject} */ (\n\t\t\t/** @type unknown */ handler\n\t\t),\n\t\t!isFunction(handler)\n\t\t\t? /** @type {EventHandlerOptions} */ (handler)\n\t\t\t: undefined,\n\t)\n\n\t/**\n\t * Removes event on tracking scope disposal.\n\t *\n\t * Situation: the event was added to the `document` or `window`\n\t * manually using `addEvent`, say to listen for clicks as a \"click\n\t * outside\". The event needs to be removed when the component that\n\t * added it is disposed.\n\t */\n\n\treturn cleanup(() => removeEvent(node, type, handler))\n}\n\n/**\n * Removes an event listener from a node\n *\n * @template {Document | typeof window | DOMElement} TargetElement\n * @param {TargetElement} node - Element to add the event listener\n * @param {EventName} type - The name of the event listener\n * @param {EventHandler<Event, TargetElement>} handler - Function to\n *   handle the event\n * @returns {Function} - An `on` function for adding back the event\n *   listener\n * @url https://pota.quack.uy/props/EventListener\n */\nexport function removeEvent(node, type, handler) {\n\tnode.removeEventListener(\n\t\ttype,\n\t\t/** @type {EventListenerOrEventListenerObject} */ (\n\t\t\t/** @type unknown */ handler\n\t\t),\n\t\t!isFunction(handler)\n\t\t\t? /** @type {EventHandlerOptions} */ (handler)\n\t\t\t: undefined,\n\t)\n\n\treturn () => addEvent(node, type, handler)\n}\n\n/**\n * It gives a handler an owner, so stuff runs batched on it, and\n * things like context and cleanup work\n *\n * @template {EventHandler<Event, Element>} T\n * @param {T} handler\n */\nexport const ownedEvent = handler =>\n\t'handleEvent' in handler\n\t\t? {\n\t\t\t\t...handler,\n\t\t\t\thandleEvent: owned(e => handler.handleEvent(e)),\n\t\t\t}\n\t\t: owned(handler)\n","import {\n\temptyArray,\n\tgetValueWithArguments,\n\tisArray,\n\twindow,\n} from '../lib/std.js'\n\nexport const document = /** @type {Document} */ (window.document)\n\nexport const head = document?.head\n\n/**\n * Checks whether a node is connected to a document tree.\n *\n * @param {Node} node\n * @returns {boolean}\n */\nexport const isConnected = node => node.isConnected\n\n/** @returns {Element | null} The currently focused element. */\nexport const activeElement = () => document.activeElement\n\n/**\n * @returns {Element | undefined} The root `<html>` element if\n *   available.\n */\nexport const documentElement = document?.documentElement\n\n/** DocumentFragment constructor exposed for convenience. */\nexport const DocumentFragment = window.DocumentFragment\n\n/**\n * Safely binds a document method so it can be called later.\n *\n * @param {string} fn\n * @returns {Function | undefined}\n */\nconst bind = fn => document && document[fn].bind(document)\n\nexport const createElement = bind('createElement')\nexport const createElementNS = bind('createElementNS')\nexport const createTextNode = bind('createTextNode')\nexport const createComment = bind('createComment')\n\nexport const importNode = bind('importNode')\n\nexport const createTreeWalker = bind('createTreeWalker')\n\n// part\n\n/**\n * Adds a part token to an element, enabling ::part styling.\n *\n * @param {Element & { part: DOMTokenList }} node\n * @param {string} partName\n * @returns {void}\n */\nexport const addPart = (node, partName) => node.part.add(partName)\n\n/**\n * Removes a part token from an element.\n *\n * @param {Element & { part: DOMTokenList }} node\n * @param {string} partName\n * @returns {void}\n */\nexport const removePart = (node, partName) =>\n\tnode.part.remove(partName)\n\n// tokenList\n\n/**\n * Splits a string by whitespace into tokens; returns `emptyArray` for\n * falsy input.\n *\n * @param {string | undefined | null} s\n * @returns {string[]}\n */\nexport const tokenList = s =>\n\ts\n\t\t? s.trim().split(/\\s+/)\n\t\t: /** @type string[] */ (/** @type unknown */ emptyArray)\n\n/**\n * Adds CSS classes to an element using either a string or an array.\n *\n * @param {Element} node\n * @param {string | string[]} className\n */\nexport const addClass = (node, className) =>\n\tclassName.length &&\n\tnode.classList.add(\n\t\t...(isArray(className) ? className : tokenList(className)),\n\t)\n\n/**\n * Removes CSS classes from an element using either a string or an\n * array.\n *\n * @param {Element} node\n * @param {string | string[]} className\n */\nexport const removeClass = (node, className) =>\n\tclassName.length &&\n\tnode.classList.remove(\n\t\t...(isArray(className) ? className : tokenList(className)),\n\t)\n\n// attributes\n\n/**\n * Sets an attribute on a node.\n *\n * @param {Element} node\n * @param {string} name\n * @param {string} value\n */\nexport const setAttribute = (node, name, value) =>\n\tnode.setAttribute(name, value)\n\n/**\n * Determines whether an attribute exists on a node.\n *\n * @param {Element} node\n * @param {string} name\n * @returns {boolean}\n */\nexport const hasAttribute = (node, name) => node.hasAttribute(name)\n\n/**\n * Removes an attribute from a node.\n *\n * @param {Element} node\n * @param {string} name\n */\nexport const removeAttribute = (node, name) =>\n\tnode.removeAttribute(name)\n\n// selector\n\n/**\n * Finds the first matching descendant of `node` using a CSS selector.\n *\n * @param {ParentNode} node\n * @param {string} query\n * @returns {Element | null}\n */\nexport const querySelector = (node, query) =>\n\tnode.querySelector(query)\n\n/**\n * Finds all matching descendants of `node` using a CSS selector.\n *\n * @param {ParentNode} node\n * @param {string} query\n * @returns {NodeListOf<Element>}\n */\nexport const querySelectorAll = (node, query) =>\n\tnode.querySelectorAll(query)\n\n/**\n * Returns `document` for element. That could be a `shadowRoot`\n *\n * @template {Element | DocumentFragment} T\n * @param {T} node\n * @returns {Document | ShadowRoot}\n */\nexport const getDocumentForElement = node => {\n\tconst document = /** @type {Document | ShadowRoot} */ (\n\t\tnode.getRootNode()\n\t)\n\tconst { nodeType } = document\n\t// getRootNode returns:\n\t// 1. Node for isConnected = false\n\t// 2. Document for isConnected = true\n\t// 3. ShadowRoot for custom elements\n\n\t// always return a Document-like\n\treturn nodeType === 11 /* DOCUMENT_FRAGMENT_NODE (11) */ ||\n\t\tnodeType === 9 /* DOCUMENT_NODE (9)*/\n\t\t? document\n\t\t: node.ownerDocument\n}\n\n/**\n * Traverses element nodes depth-first collecting up to `max` results.\n *\n * @param {TreeWalker} walk\n * @param {Node} node\n * @param {number} [max=Infinity] Default is `Infinity`\n * @param {Node[]} [nodes=[]] Default is `[]`\n * @returns {Node[]}\n */\nexport const walkElements = function (\n\twalk,\n\tnode,\n\tmax = Infinity,\n\tnodes = [],\n) {\n\t/**\n\t * The first node is not walked by the walker.\n\t *\n\t * Also the first node could be a DocumentFragment\n\t */\n\tnode.nodeType === 1 && nodes.push(node)\n\n\twalk.currentNode = node\n\n\twhile (nodes.length !== max && (node = walk.nextNode())) {\n\t\tnodes.push(node)\n\t}\n\treturn nodes\n}.bind(\n\tnull,\n\tcreateTreeWalker &&\n\t\tcreateTreeWalker(document, 1 /*NodeFilter.SHOW_ELEMENT*/),\n)\n\n/**\n * Unwraps `value` and returns `element` if result is a `Node`, else\n * `undefined` in the case isn't a `Node`\n *\n * @template T\n * @param {T} value - Maybe function\n * @param {...unknown} args? - Arguments\n * @returns {DOMElement | T | undefined}\n */\nexport function getValueElement(value, ...args) {\n\tconst element = getValueWithArguments(value, ...args)\n\treturn element instanceof Node ? element : undefined\n}\n","import {\n\tpromise,\n\tremoveFromArray,\n\twindow,\n\twithCache,\n\twithState,\n} from '../lib/std.js'\n\nimport { document } from './dom.js'\n\nexport const CSSStyleSheet = window.CSSStyleSheet\n\n/**\n * Creates tagged css and returns a CSSStyleSheet. Mostly for css\n * highlighting in js\n *\n * @param {TemplateStringsArray} template\n * @param {...any} values\n * @returns {CSSStyleSheet}\n */\nexport const css = (template, ...values) =>\n\tsheet(String.raw({ raw: template }, ...values))\n\n/**\n * Creates a stylesheet from a css string\n *\n * @param {string} css\n * @returns {CSSStyleSheet}\n */\nexport const sheet = withCache(css => {\n\tconst sheet = new CSSStyleSheet()\n\t/**\n\t * Replace is asynchronous and can accept `@import` statements\n\t * referencing external resources.\n\t */\n\tsheet.replace(css)\n\n\treturn sheet\n})\n\n/**\n * Returns `adoptedStyleSheets` for a document\n *\n * @param {Document | ShadowRoot} document\n */\nexport const getAdoptedStyleSheets = document =>\n\tdocument?.adoptedStyleSheets\n\nexport const adoptedStyleSheets =\n\t/* #__PURE__*/ getAdoptedStyleSheets(document)\n\n/**\n * Adds a style sheet to the document\n *\n * @param {Document | ShadowRoot} document\n * @param {CSSStyleSheet} styleSheet\n */\nexport const addAdoptedStyleSheet = (document, styleSheet) =>\n\tgetAdoptedStyleSheets(document).push(styleSheet)\n\n/**\n * Removes a style sheet from the document\n *\n * @param {Document | ShadowRoot} document\n * @param {CSSStyleSheet} styleSheet\n */\nexport const removeAdoptedStyleSheet = (document, styleSheet) =>\n\tremoveFromArray(getAdoptedStyleSheets(document), styleSheet)\n\n/**\n * Adds multiple stylesheets to a document or shadow root.\n *\n * @param {Document | ShadowRoot} document - The document or shadow\n *   root to add the stylesheets to.\n * @param {(CSSStyleSheet | string)[]} styleSheets - Array of\n *   stylesheets or stylesheet URLs to add.\n */\nexport function addStyleSheets(document, styleSheets = []) {\n\tfor (const sheet of styleSheets) {\n\t\tif (sheet) {\n\t\t\tsheet instanceof CSSStyleSheet\n\t\t\t\t? addAdoptedStyleSheet(document, sheet)\n\t\t\t\t: addStyleSheetExternal(document, sheet)\n\t\t}\n\t}\n}\n\n/**\n * Adds the stylesheet from urls. It uses a cache, to avoid having to\n * fire a request for each external sheet when used in more than one\n * custom element. Also, all reference the same object.\n *\n * @param {Document | ShadowRoot} document\n * @param {string} text\n */\nexport const addStyleSheetExternal = withState(\n\t(state, document, text) => {\n\t\tstate\n\t\t\t.get(text, text =>\n\t\t\t\ttext.startsWith('http')\n\t\t\t\t\t? fetch(text)\n\t\t\t\t\t\t\t.then(r => r.text())\n\t\t\t\t\t\t\t.then(css => sheet(css))\n\t\t\t\t\t: promise(resolve => resolve(sheet(text))),\n\t\t\t)\n\t\t\t.then(styleSheet => addAdoptedStyleSheet(document, styleSheet))\n\t},\n)\n","import { asyncTracking, owned } from '../lib/reactive.js'\nimport { call, queueMicrotask } from '../lib/std.js'\n\n/**\n * The purpose of this file is to guarantee the timing of some\n * callbacks. It queues a microtask, then the callbacks are added to a\n * position in the array. These are run with a priority.\n */\n\n/** @type boolean */\nlet added\n\n/** @type (()=>void)[][] */\nlet queue\n\n/** Initializes the priority queue buckets and clears the pending flag. */\nfunction reset() {\n\tqueue = [[], [], [], [], [], []]\n\tadded = false\n}\n\n// initialization\nreset()\n\n/**\n * Queues a callback at a priority\n *\n * @param {PropertyKey} priority - Priority\n * @param {() => void} fn - Function to run once the callbacks at this\n *   priority run\n */\nfunction add(priority, fn) {\n\tif (!added) {\n\t\tadded = true\n\t\tqueueMicrotask(run)\n\t}\n\tqueue[priority].push(owned(fn))\n}\n\n/** Runs and clears the current queue batch. */\nfunction run() {\n\tconst q = queue\n\treset()\n\n\tfor (const fns of q) {\n\t\tfns.length && call(fns)\n\t}\n}\n\n/**\n * Queue a function to run before everything else (onProps, onRef,\n * onMount, ready) ex focus restoration\n *\n * @param {() => void} fn\n */\nexport const onFixes = fn => add(0, fn)\n\n/**\n * Queue a function to run before (onRef, onMount, ready) ex running\n * user functions on elements via plugins\n *\n * @param {() => void} fn\n */\nexport const onProps = fn => add(1, fn)\n\n/**\n * Queue a function to run onMount (before ready, after onRef)\n *\n * @param {() => void} fn\n */\nexport const onMount = fn => add(2, fn)\n\n/**\n * Queue a function to run on ready (after onMount)\n *\n * @param {() => void} fn\n * @url https://pota.quack.uy/ready\n */\nexport const ready = fn => add(3, fn)\n\n/**\n * Queue a function to run after all user defined processes\n *\n * @param {() => void} fn\n */\nexport const onDone = fn => add(4, fn)\n\n/**\n * Registers a callback that runs when all async tasks complete.\n *\n * @param {() => void} fn\n */\nexport const readyAsync = asyncTracking.ready\n","import { cacheStore, toArray } from '../../lib/std.js'\nimport { onProps } from '../scheduler.js'\n\nexport const plugins = cacheStore()\nexport const pluginsNS = cacheStore()\n\n/** @type {Set<string> & { xmlns?: string }} */\nexport const namespaces = new Set([\n\t'on',\n\t'prop',\n\t'class',\n\t'style',\n\t'use',\n])\n\n/**\n * Updates the xmlns string containing all registered namespaces Used\n * for XML serialization of components\n */\nfunction updateNamespaces() {\n\tnamespaces.xmlns = toArray(namespaces)\n\t\t.map(ns => `xmlns:${ns}=\"/\"`)\n\t\t.join(' ')\n}\nupdateNamespaces()\n\n/**\n * Defines a prop that can be used on any Element\n *\n * @template T\n * @param {string} propName - Name of the prop\n * @param {(node: DOMElement, propValue: T) => void} fn - Function to\n *   run when this prop is found on any Element\n * @param {boolean} [onMicrotask=true] - To avoid the problem of\n *   needed props not being set, or children elements not created yet.\n *   Default is `true`\n * @url https://pota.quack.uy/props/propsPlugin\n */\nexport const propsPlugin = (propName, fn, onMicrotask) => {\n\tplugin(plugins, propName, fn, onMicrotask)\n}\n\n/**\n * Defines a namespaced prop that can be used on any Element\n *\n * @template T\n * @param {string} NSName - Name of the namespace\n * @param {(\n * \tnode: DOMElement,\n * \tlocalName: string,\n * \tpropValue: T,\n * \tns?: string,\n * ) => void} fn\n *   - Function to run when this prop is found on any Element\n *\n * @param {boolean} [onMicrotask=true] - Set to run on a microtask to\n *   avoid the problem of needed props not being set, or children\n *   elements not being created yet. Default is `true`\n */\nexport const propsPluginNS = (NSName, fn, onMicrotask) => {\n\t// update namespace for the `xml` function\n\tnamespaces.add(NSName)\n\tupdateNamespaces()\n\tplugin(pluginsNS, NSName, fn, onMicrotask)\n}\n\n/**\n * Internal helper to register a prop plugin in a plugin store\n *\n * @param {typeof plugins} plugins - Plugin store to register in\n * @param {string} name - Name of the plugin/prop\n * @param {Function} fn - Handler function to run when prop is found\n * @param {boolean} [onMicrotask=true] - Whether to run on microtask.\n *   Default is `true`\n */\nconst plugin = (plugins, name, fn, onMicrotask = true) => {\n\tplugins.set(\n\t\tname,\n\t\t!onMicrotask ? fn : (...args) => onProps(() => fn(...args)),\n\t)\n}\n","import { withValue } from '../../lib/reactive.js'\n\n/**\n * Sets DOM properties while unwrapping reactive accessors.\n *\n * @param {Element} node\n * @param {string} name\n * @param {unknown} value\n * @url https://pota.quack.uy/props/setProperty\n */\nexport const setProperty = (node, name, value) => {\n\twithValue(value, value => _setProperty(node, name, value))\n}\n\n/**\n * Sets Namespace-awareDOM properties while unwrapping reactive\n * accessors.\n *\n * @param {Element} node\n * @param {string} localName\n * @param {unknown} value\n */\nexport const setPropertyNS = (node, localName, value) => {\n\tsetProperty(node, localName, value)\n}\n\n/**\n * Writes raw values to DOM properties.\n *\n * @param {Element} node\n * @param {string} name\n * @param {unknown} value\n */\nexport function _setProperty(node, name, value) {\n\t// if the value is null or undefined it will be set to null\n\tif (value == null) {\n\t\t// defaulting to `undefined` breaks `progress` tag and the whole page\n\t\tnode[name] = null\n\t} else {\n\t\tnode[name] = value\n\t}\n}\n","import { addEvent, ownedEvent } from '../../lib/reactive.js'\nimport { flatForEach } from '../../lib/std.js'\n\n/**\n * Attaches event handlers (singular or array) to an element.\n *\n * @template {DOMElement} T\n * @param {T} node\n * @param {string} name\n * @param {EventHandlers<Event, T>} value\n */\nexport const setEvent = (node, name, value) => {\n\tflatForEach(value, value => {\n\t\taddEvent(\n\t\t\tnode,\n\t\t\tname,\n\t\t\townedEvent(/** @type EventHandler<Event, Element> */ (value)),\n\t\t)\n\t})\n}\n\n/**\n * Attaches namespaced event handlers, (singular or array) to an\n * element.\n *\n * @template {DOMElement} T\n * @param {T} node\n * @param {string} localName\n * @param {EventHandlers<Event, T>} value\n */\nexport const setEventNS = (node, localName, value) => {\n\tflatForEach(value, value => {\n\t\tsetEvent(node, localName, value)\n\t})\n}\n","/** Returns true or false with a `chance` of getting `true` */\nexport const chance = (chance = 50, generator = random) => {\n\treturn generator() < chance / 100\n}\n\n/** Returns random number between 0 and 1 */\nexport const random = () =>\n\tcrypto.getRandomValues(new Uint32Array(1))[0] / (0xffffffff + 1)\n\n/**\n * Returns an integer between `min` and `max` (inclusive) using the\n * provided generator.\n *\n * @param {number} [min=0] Lowest value in the range. Default is `0`\n * @param {number} [max=100] Highest value in the range. Default is\n *   `100`\n * @param {() => number} [generator=random] Source of uniform floats\n *   between 0 and 1. Default is `random`\n * @returns {number}\n */\nexport const randomBetween = (\n\tmin = 0,\n\tmax = 100,\n\tgenerator = random,\n) => Math.floor(generator() * (max - min + 1)) + min\n\n/**\n * Creates an RGB color string by sampling each channel in the\n * [min,max] range.\n *\n * @param {number} [min=0] Lowest channel value. Default is `0`\n * @param {number} [max=255] Highest channel value. Default is `255`\n * @returns {string}\n */\nexport const randomColor = (min = 0, max = 255) =>\n\t'rgb(' +\n\trandomBetween(min, max) +\n\t',' +\n\trandomBetween(min, max) +\n\t',' +\n\trandomBetween(min, max) +\n\t')'\n\n/**\n * Generates a base36 id string by reading 64 bits from `crypto`.\n *\n * @returns {string}\n */\nexport const randomId = () =>\n\tcrypto.getRandomValues(new BigUint64Array(1))[0].toString(36)\n\n/**\n * Returns a random number generator based on a seed that generates\n * numbers between 0 and 1\n *\n * @param {number} seed\n */\nexport function randomSeeded(seed) {\n\tconst m = 2 ** 35 - 31\n\tlet s = seed % m\n\treturn () => (s = (s * 185852) % m) / m\n}\n","import { withState } from '../../lib/std.js'\nimport { addAdoptedStyleSheet, sheet } from '../../use/css.js'\nimport {\n\taddClass,\n\tgetDocumentForElement,\n\tisConnected,\n} from '../../use/dom.js'\n\nimport { randomId } from '../../use/random.js'\nimport { onMount } from '../scheduler.js'\n\n/**\n * @param {Element} node\n * @param {string} value\n */\nexport const setCSS = (node, value) => {\n\tisConnected(node)\n\t\t? setNodeCSS(node, value)\n\t\t: onMount(() => {\n\t\t\t\tsetNodeCSS(node, value)\n\t\t\t})\n}\n\n/** @type {(node: Element, value: string) => void} */\nconst setNodeCSS = withState((state, node, value) => {\n\tif (value) {\n\t\taddClass(\n\t\t\tnode,\n\t\t\tstate.get(value, value => {\n\t\t\t\tconst id = 'c' + randomId()\n\t\t\t\taddAdoptedStyleSheet(\n\t\t\t\t\tgetDocumentForElement(node),\n\t\t\t\t\tsheet(value.replace(/class/g, '.' + id)),\n\t\t\t\t)\n\t\t\t\treturn id\n\t\t\t}),\n\t\t)\n\t}\n})\n","import { cleanup } from '../../lib/reactive.js'\nimport { flatForEach } from '../../lib/std.js'\n\nimport { onMount } from '../scheduler.js'\n\n/**\n * Invokes `ref` callbacks immediately with the element instance.\n *\n * @param {Element} node\n * @param {Function} value\n */\nexport const setRef = (node, value) => {\n\tflatForEach(value, fn => fn(node))\n}\n\n/**\n * Runs callbacks once the node is connected (after mount).\n *\n * @param {Element} node\n * @param {Function} value\n */\nexport const setConnected = (node, value) => {\n\tonMount(() => flatForEach(value, fn => fn(node)))\n}\n\n/**\n * Registers cleanup callbacks that fire when the scope disposes.\n *\n * @param {Element} node\n * @param {Function} value\n */\nexport const setDisconnected = (node, value) => {\n\tcleanup(() => flatForEach(value, fn => fn(node)))\n}\n","// node style\n\nimport { withValue } from '../../lib/reactive.js'\nimport { isFunction, isObject, isString } from '../../lib/std.js'\n\n/**\n * Applies style attributes (string/object/function) to an element.\n *\n * @param {DOMElement} node\n * @param {StyleAttribute} value\n * @url https://pota.quack.uy/props/setStyle\n */\nexport const setStyle = (node, value) => {\n\tsetNodeStyle(node.style, value)\n}\n\n/**\n * Applies styles within a namespace (e.g. `style:color` bindings).\n *\n * @param {DOMElement} node\n * @param {string} localName\n * @param {StyleAttribute} value\n */\nexport const setStyleNS = (node, localName, value) => {\n\tsetNodeStyle(\n\t\tnode.style,\n\t\tisObject(value) ? value : { [localName]: value },\n\t)\n}\n\n/**\n * Normalizes strings/functions/objects into concrete style\n * assignments.\n *\n * @param {CSSStyleDeclaration} style\n * @param {StyleAttribute} value\n */\nfunction setNodeStyle(style, value) {\n\tif (isString(value)) {\n\t\tstyle.cssText = value\n\t} else if (isFunction(value)) {\n\t\twithValue(value, value => setNodeStyle(style, value))\n\t} else if (isObject(value)) {\n\t\tfor (const name in value) {\n\t\t\tsetStyleValue(style, name, value[name])\n\t\t}\n\t}\n}\n\n/**\n * Sets a single style property, unwrapping reactive values.\n *\n * @param {DOMElement} node\n * @param {string} name\n * @param {unknown} value\n */\nexport const setElementStyle = (node, name, value) => {\n\tsetStyleValue(node.style, name, value)\n}\n\n/**\n * Resolves a possibly reactive style binding before delegating.\n *\n * @param {CSSStyleDeclaration} style\n * @param {string} name\n * @param {unknown} value\n */\nconst setStyleValue = (style, name, value) => {\n\twithValue(value, value => _setStyleValue(style, name, value))\n}\n\n/**\n * Writes raw styles, removing properties for falsy/nullish values.\n *\n * @param {CSSStyleDeclaration} style\n * @param {string} name\n * @param {unknown} value\n */\nconst _setStyleValue = (style, name, value) => {\n\t// if the value is null or undefined it will be removed\n\tvalue == null || value === false\n\t\t? style.removeProperty(name)\n\t\t: style.setProperty(name, /** @type string */ (value))\n}\n","// node class / classList\n\nimport { isFunction, isObject, isString } from '../../lib/std.js'\nimport { withPrevValue } from '../../lib/reactive.js'\n\nimport { addClass, removeClass } from '../../use/dom.js'\n\n/**\n * @param {Element} node\n * @param {object | string | ArrayLike<any>} value\n */\nexport const setClass = (node, value) => {\n\tisString(value)\n\t\t? node.setAttribute('class', value)\n\t\t: setClassList(node, value)\n}\n\n/**\n * @param {Element} node\n * @param {object | string | ArrayLike<any>} value\n * @param {string} localName\n */\nexport const setClassNS = (node, localName, value) => {\n\tisFunction(value) || !isObject(value)\n\t\t? setElementClass(node, localName, value)\n\t\t: setClassList(node, value)\n}\n\n/**\n * @param {Element} node\n * @param {object | string | ArrayLike<any>} value\n * @param {object | string | ArrayLike<any>} [prev]\n */\nexport function setClassList(node, value, prev) {\n\tif (isString(value) || value == null) {\n\t\tprev && _setClassListValue(node, prev, false)\n\t\tvalue && _setClassListValue(node, value, true)\n\t} else if (isObject(value)) {\n\t\tfor (let name in value) {\n\t\t\tsetElementClass(node, name, value[name])\n\t\t}\n\t} else if (isFunction(value)) {\n\t\twithPrevValue(value, (value, prev) => {\n\t\t\tsetClassList(node, value, prev)\n\t\t})\n\t}\n}\n/**\n * @param {Element} node\n * @param {string} name\n * @param {unknown} value\n */\nexport const setElementClass = (node, name, value) => {\n\twithPrevValue(value, (value, prev) => {\n\t\tif (!value && !prev) {\n\t\t\t// on initialization do not remove whats not there\n\t\t} else {\n\t\t\t_setClassListValue(node, name, value)\n\t\t}\n\t})\n}\n\n/**\n * @param {Element} node\n * @param {string} name\n * @param {unknown} value\n */\nconst _setClassListValue = (node, name, value) => {\n\t// null, undefined or false, the class is removed\n\t!value ? removeClass(node, name) : addClass(node, name)\n}\n","import { withValue } from '../../lib/reactive.js'\n\nimport { NS } from '../../constants.js'\n\n// NODE ATTRIBUTES\n\n/**\n * @param {Element} node\n * @param {string} name\n * @param {Accessor<string | boolean>} value\n * @url https://pota.quack.uy/props/setAttribute\n */\nexport const setAttribute = (node, name, value) => {\n\twithValue(value, value => _setAttribute(node, name, value))\n}\n\n/**\n * @param {Element} node\n * @param {string} name\n * @param {string | boolean} value\n */\nfunction _setAttribute(node, name, value) {\n\t// if the value is false/null/undefined it will be removed\n\tvalue === false || value == null\n\t\t? node.removeAttribute(name)\n\t\t: node.setAttribute(name, value === true ? '' : value)\n}\n\n/**\n * @param {Element} node\n * @param {string} name\n * @param {Accessor<string | boolean>} value\n * @param {string} ns\n * @url https://pota.quack.uy/props/setAttribute\n */\nexport const setAttributeNS = (node, name, value, ns) => {\n\twithValue(value, value => _setAttributeNS(node, name, value, ns))\n}\n\n/**\n * @param {Element} node\n * @param {string} name\n * @param {string | boolean} value\n * @param {string} ns\n */\nfunction _setAttributeNS(node, name, value, ns) {\n\t// if the value is false/null/undefined it will be removed\n\tvalue === false || value == null\n\t\t? NS[ns]\n\t\t\t? node.removeAttributeNS(NS[ns], name)\n\t\t\t: node.removeAttribute(name)\n\t\t: NS[ns]\n\t\t\t? node.setAttributeNS(NS[ns], name, value === true ? '' : value)\n\t\t\t: node.setAttribute(name, value === true ? '' : value)\n}\n","import { empty } from '../../lib/std.js'\n\nimport {\n\tplugins,\n\tpluginsNS,\n\tpropsPlugin,\n\tpropsPluginNS,\n} from './plugin.js'\n\n// PLUGINS NS\n\n// properties\n\nimport { setPropertyNS } from './property.js'\npropsPluginNS('prop', setPropertyNS, false)\n\n// events\n\nimport { setEventNS } from './event.js'\npropsPluginNS('on', setEventNS, false)\n\n// PLUGIN BOTH\n\n// css\n\nimport { setCSS } from './css.js'\npropsPlugin('use:css', setCSS) // run in microtask\n\n// mount\n\nimport { setConnected } from './lifecycle.js'\npropsPlugin('use:connected', setConnected, false)\n\n// unmount\n\nimport { setDisconnected } from './lifecycle.js'\npropsPlugin('use:disconnected', setDisconnected, false)\n\n// ref\n\nimport { setRef } from './lifecycle.js'\npropsPlugin('use:ref', setRef, false)\n\n// PLUGIN BOTH DIFFERENT\n\n// styles\n\nimport { setStyle, setStyleNS } from './style.js'\npropsPlugin('style', setStyle, false)\npropsPluginNS('style', setStyleNS, false)\n\n// class\n\nimport { setClass, setClassNS } from './class.js'\npropsPlugin('class', setClass, false)\npropsPluginNS('class', setClassNS, false)\n\n// catch all\n\nconst propNS = empty()\n\nimport { setAttribute, setAttributeNS } from './attribute.js'\n\n/**\n * Assigns props to an Element\n *\n * @template T\n * @param {Element} node - Element to which assign props\n * @param {T} props - Props to assign\n */\nexport function assignProps(node, props) {\n\tfor (const name in props) {\n\t\tassignProp(node, name, props[name])\n\t}\n}\n\n/**\n * Assigns a prop to an Element\n *\n * @template T\n * @param {Element} node\n * @param {string} name\n * @param {any} value\n */\nexport function assignProp(node, name, value) {\n\t// run plugins\n\tlet plugin = plugins.get(name)\n\tif (plugin) {\n\t\tplugin(node, value)\n\t} else if (propNS[name] || name.includes(':')) {\n\t\t// with ns\n\t\tpropNS[name] = propNS[name] || name.split(':')\n\n\t\t// run plugins NS\n\t\tplugin = pluginsNS.get(propNS[name][0])\n\t\tplugin\n\t\t\t? plugin(node, propNS[name][1], value)\n\t\t\t: setAttributeNS(node, name, value, propNS[name][0])\n\t} else {\n\t\t// catch all\n\t\tsetAttribute(node, name, value)\n\t}\n}\n\n/**\n * Assigns a prop to an Element\n *\n * @template T\n * @param {DOMElement} node\n * @param {string} name\n * @param {any} value\n * @param {string} localName\n * @param {string} ns\n */\nexport function assignPropNS(node, name, value, localName, ns) {\n\t// run plugins NS\n\tlet plugin = plugins.get(name)\n\tif (plugin) {\n\t\tplugin(node, value)\n\t} else {\n\t\tplugin = pluginsNS.get(ns)\n\t\tplugin\n\t\t\t? plugin(node, localName, value)\n\t\t\t: setAttributeNS(node, name, value, ns)\n\t}\n}\n","// CONSTANTS\n\nimport { $isComponent, $isMap, NS } from '../constants.js'\n\n// LIB\n\nimport {\n\tunwrapArray,\n\tfreeze,\n\tisArray,\n\titerator,\n\tnothing,\n\tresolved,\n\tstringify,\n\ttoArray,\n\tflatToArray,\n\ttoValues,\n\tisFunction,\n} from '../lib/std.js'\n\nimport {\n\tcreateElement,\n\tcreateElementNS,\n\tcreateTextNode,\n\tdocument,\n\tDocumentFragment,\n\tgetDocumentForElement,\n\thead,\n\timportNode,\n\tisConnected,\n\tquerySelector,\n\twalkElements,\n} from '../use/dom.js'\n\nimport {\n\taddAdoptedStyleSheet,\n\tremoveAdoptedStyleSheet,\n} from '../use/css.js'\n\n// REACTIVE\n\nimport {\n\tcleanup,\n\tcontext,\n\teffect,\n\towned,\n\troot,\n\tsignal,\n\tuntrack,\n\tmarkComponent,\n\tuseSuspense,\n} from '../lib/reactive.js'\n\nimport { onFixes } from './scheduler.js'\n\n// PROPERTIES / ATTRIBUTES\n\nimport { assignProps } from './props/@main.js'\nimport { propsPlugin } from './props/plugin.js'\n\n// STATE\n\nconst useXMLNS = context()\n\n// COMPONENTS\n\n/**\n * Used by the regular JSX transform, as `<>...</>` or\n * `<Fragment>...</Fragment>`.\n */\nexport const Fragment = props => props.children\n\n/**\n * Creates components for things. When props argument is given, the\n * props become fixed. When props argument is ommited, it allows you\n * to keep calling the returned function with new props. Returns a\n * function because we need to render from parent to children instead\n * of from children to parent. This allows to properly set the\n * reactivity tree (think of nested effects that clear inner effects,\n * context, etc).\n *\n * @template {string | Function | Element | object | symbol} T\n * @template {ComponentProps<T>} P\n * @param {T} value\n * @param {P} [props]\n * @returns {(props?: P) => Children}\n * @url https://pota.quack.uy/Component\n */\nexport function Component(value, props) {\n\tif (value === Fragment) {\n\t\treturn /** @type P & {children: Children} */ (\n\t\t\t/** @type {unkonwn} */ props\n\t\t).children\n\t}\n\n\t/** Freeze props so isnt directly writable */\n\tfreeze(props)\n\n\t/** Create a callable function to pass `props` */\n\tconst component = Factory(value)\n\n\treturn props === undefined\n\t\t? component\n\t\t: markComponent(propsOverride =>\n\t\t\t\tcomponent(\n\t\t\t\t\tpropsOverride\n\t\t\t\t\t\t? freeze({\n\t\t\t\t\t\t\t\t/** @ts-expect-error freaking typescript */\n\t\t\t\t\t\t\t\t...props,\n\t\t\t\t\t\t\t\t...propsOverride,\n\t\t\t\t\t\t\t})\n\t\t\t\t\t\t: props,\n\t\t\t\t),\n\t\t\t)\n}\n\n/**\n * Creates a component that could be called with a props object\n *\n * @template T\n * @param {string | Function | Element | object | symbol} value -\n *   Component value\n * @returns {(props?: Props<T>) => Children}\n */\nfunction Factory(value) {\n\tswitch (typeof value) {\n\t\tcase 'string': {\n\t\t\t// string component, 'div' becomes <div>\n\t\t\treturn markComponent(props => createTag(value, props))\n\t\t}\n\t\tcase 'function': {\n\t\t\treturn $isComponent in value ? value : markComponent(value)\n\t\t}\n\t\tdefault: {\n\t\t\tif (value instanceof Element) {\n\t\t\t\t// node component <div>\n\t\t\t\treturn markComponent(props => createNode(value, props))\n\t\t\t}\n\n\t\t\t// creates anything\n\t\t\treturn markComponent(() => value)\n\t\t}\n\t}\n}\n\n/**\n * Creates a x/html element from a tagName\n *\n * @template {Props<{ xmlns?: string; is?: string }>} P\n * @param {string} tagName\n * @param {P} props\n * @returns {Element} Element\n */\nfunction createTag(tagName, props) {\n\t/**\n\t * Namespace, use props xmlns or special case svg, math, etc in case\n\t * of missing xmlns attribute\n\t */\n\tconst xmlns = props?.xmlns || NS[tagName]\n\n\treturn withXMLNS(\n\t\txmlns,\n\t\txmlns =>\n\t\t\tcreateNode(\n\t\t\t\txmlns\n\t\t\t\t\t? createElementNS(xmlns, tagName, { is: props?.is })\n\t\t\t\t\t: createElement(tagName, { is: props?.is }),\n\t\t\t\tprops,\n\t\t\t),\n\t\ttagName,\n\t)\n}\n\n/** @type {boolean} */\nlet usedXML\n\n/**\n * Ensures children inherit the right namespace as elements are\n * created.\n *\n * @template T\n * @param {string} xmlns\n * @param {(xmlns: string) => T} fn\n * @param {string} [tagName]\n */\nfunction withXMLNS(xmlns, fn, tagName) {\n\tif (!usedXML) {\n\t\tif (!xmlns) {\n\t\t\treturn fn(xmlns)\n\t\t}\n\t\tusedXML = true\n\t}\n\n\tconst nsContext = useXMLNS()\n\n\tif (xmlns && xmlns !== nsContext) {\n\t\t// the xmlns changed, use the new xmlns\n\t\treturn useXMLNS(xmlns, () => fn(xmlns))\n\t}\n\n\t/**\n\t * `foreignObject` children are created with html xmlns (default\n\t * browser behaviour)\n\t */\n\tif (nsContext && tagName === 'foreignObject') {\n\t\treturn useXMLNS(NS.html, () => fn(nsContext))\n\t}\n\n\treturn fn(nsContext)\n}\n\n// PARTIALS\n\n/**\n * Turns string markup into DOM nodes using the provided namespace.\n *\n * @param {string} content\n * @param {string} [xmlns]\n * @returns {Element | DocumentFragment}\n */\nfunction parseXML(content, xmlns) {\n\tconst template = xmlns\n\t\t? createElementNS(xmlns, 'template')\n\t\t: createElement('template')\n\n\ttemplate.innerHTML = content\n\n\t// xml\n\tlet tlpContent = template.content\n\tif (!tlpContent) {\n\t\tconst childNodes = template.childNodes\n\t\tif (childNodes.length === 1) {\n\t\t\treturn template.firstChild\n\t\t}\n\n\t\ttlpContent = new DocumentFragment()\n\t\ttlpContent.append(...childNodes)\n\t\treturn tlpContent\n\t}\n\n\treturn tlpContent.childNodes.length === 1\n\t\t? tlpContent.firstChild\n\t\t: tlpContent\n}\n\n/**\n * Wraps values for JSX runtime helpers, ensuring we always return a\n * component function.\n *\n * @template T\n * @param {string | Function | Element | object | symbol} value\n * @returns {(props?: Props<T>) => Children}\n */\nexport function createComponent(value) {\n\tconst component = Factory(value)\n\n\treturn props => {\n\t\t/** Freeze props so isnt directly writable */\n\t\tfreeze(props)\n\t\treturn markComponent(() => component(props))\n\t}\n}\n\n/**\n * @template T\n * @param {string} content\n * @param {{\n * \tx?: string\n * \t[i: number]: number\n * \tm?: number\n * } & Record<string, unknown>} [propsData]\n * @returns {(props: T[]) => Children}\n */\nexport function createPartial(content, propsData = nothing) {\n\tlet clone = () => {\n\t\tconst node = withXMLNS(propsData.x, xmlns =>\n\t\t\tparseXML(content, xmlns),\n\t\t)\n\n\t\tclone =\n\t\t\t'i' in propsData\n\t\t\t\t? importNode.bind(null, node, true)\n\t\t\t\t: node.cloneNode.bind(node, true)\n\t\treturn clone()\n\t}\n\n\treturn props =>\n\t\tmarkComponent(() => assignPartialProps(clone(), props, propsData))\n}\n\n/**\n * @template T\n * @param {Element} node\n * @param {Children[]} props\n * @param {{\n * \tx?: string\n * \t[i: number]: number\n * \tm?: number\n * } & Record<string, unknown>} propsData\n * @returns {Children}\n */\nfunction assignPartialProps(node, props, propsData) {\n\tif (props) {\n\t\tconst nodes = walkElements(node, propsData.m)\n\n\t\twithXMLNS(propsData.x, xmlns => {\n\t\t\tfor (let i = 0; i < props.length; i++) {\n\t\t\t\tprops[i](nodes[i in propsData ? propsData[i] : i])\n\t\t\t}\n\t\t})\n\t}\n\n\treturn node instanceof DocumentFragment\n\t\t? toArray(node.childNodes)\n\t\t: node\n}\n\n/**\n * Assigns props to an element and creates its children\n *\n * @template T\n * @param {Element} node - Element to assign props to\n * @param {Props<T>} props - Props to assign\n * @returns {Element} The element with props assigned\n */\nfunction createNode(node, props) {\n\tprops && assignProps(node, props)\n\n\treturn node\n}\n\n/**\n * Creates the children for a parent\n *\n * @template T\n * @param {Element | DocumentFragment} parent\n * @param {Children | ((...unknonwn) => T)} child\n * @param {boolean} [relative]\n * @param {Text} [prev]\n * @param {true} [isComponent]\n * @returns {Children}\n */\nexport function createChildren(\n\tparent,\n\tchild,\n\trelative,\n\tprev,\n\tisComponent,\n) {\n\tswitch (typeof child) {\n\t\t// string/number\n\t\tcase 'string':\n\t\tcase 'number': {\n\t\t\tif (prev instanceof Text) {\n\t\t\t\tprev.nodeValue = /** @type string */ (child)\n\t\t\t\treturn prev\n\t\t\t}\n\n\t\t\t/**\n\t\t\t * The text node could be created by just doing\n\t\t\t * `parent.textContent = value` when the parent node has no\n\t\t\t * children.\n\t\t\t */\n\t\t\tif (!relative && parent.childNodes.length === 0) {\n\t\t\t\tparent.textContent = /** @type string */ (child)\n\t\t\t\treturn parent.firstChild\n\t\t\t}\n\n\t\t\treturn insertNode(parent, createTextNode(child), relative)\n\t\t}\n\n\t\tcase 'function': {\n\t\t\t// component\n\t\t\tif ($isComponent in child) {\n\t\t\t\treturn createChildren(\n\t\t\t\t\tparent,\n\t\t\t\t\tuntrack(/** @type {() => Children} */ (child)),\n\t\t\t\t\trelative,\n\t\t\t\t\tundefined,\n\t\t\t\t\ttrue,\n\t\t\t\t)\n\t\t\t}\n\n\t\t\tlet node = []\n\n\t\t\t// signal/memo/external/user provided function\n\t\t\t// needs placeholder to stay in position\n\t\t\tparent = createPlaceholder(parent, relative)\n\n\t\t\t// For - TODO move this to the `For` component\n\t\t\t$isMap in child\n\t\t\t\t? effect(() => {\n\t\t\t\t\t\tnode = toDiff(\n\t\t\t\t\t\t\tnode,\n\t\t\t\t\t\t\tflatToArray(\n\t\t\t\t\t\t\t\tchild(child => createChildren(parent, child, true)),\n\t\t\t\t\t\t\t),\n\t\t\t\t\t\t\ttrue,\n\t\t\t\t\t\t)\n\t\t\t\t\t})\n\t\t\t\t: effect(() => {\n\t\t\t\t\t\t// maybe a signal (at least a function) so needs an effect\n\t\t\t\t\t\tnode = toDiff(\n\t\t\t\t\t\t\tnode,\n\t\t\t\t\t\t\tflatToArray(\n\t\t\t\t\t\t\t\tcreateChildren(parent, child(), true, node[0]),\n\t\t\t\t\t\t\t),\n\t\t\t\t\t\t\ttrue,\n\t\t\t\t\t\t)\n\t\t\t\t\t})\n\n\t\t\tcleanup(() => {\n\t\t\t\ttoDiff(node)\n\t\t\t\t// @ts-expect-error\n\t\t\t\tparent.remove()\n\t\t\t})\n\n\t\t\t/**\n\t\t\t * A placeholder is created and added to the document but doesnt\n\t\t\t * form part of the children. The placeholder needs to be\n\t\t\t * returned so it forms part of the group of children. If\n\t\t\t * children are moved and the placeholder is not moved with\n\t\t\t * them, then, whenever children update these will be at the\n\t\t\t * wrong place. wrong place: where the placeholder is and not\n\t\t\t * where the children were moved to\n\t\t\t */\n\t\t\treturn parent\n\t\t}\n\n\t\tcase 'object': {\n\t\t\t// Node/DocumentFragment\n\t\t\tif (child instanceof Node) {\n\t\t\t\t/**\n\t\t\t\t * DocumentFragment are special as only the children get added\n\t\t\t\t * to the document and the document becomes empty. If we dont\n\t\t\t\t * insert them 1 by 1 then we wont have a reference to them\n\t\t\t\t * for deletion on cleanup with node.remove()\n\t\t\t\t */\n\t\t\t\tif (child instanceof DocumentFragment) {\n\t\t\t\t\treturn createChildren(\n\t\t\t\t\t\tparent,\n\t\t\t\t\t\ttoArray(child.childNodes),\n\t\t\t\t\t\trelative,\n\t\t\t\t\t)\n\t\t\t\t}\n\t\t\t\treturn insertNode(\n\t\t\t\t\tparent,\n\t\t\t\t\t/** @type Element */ (child),\n\t\t\t\t\trelative,\n\t\t\t\t)\n\t\t\t}\n\n\t\t\t// children/fragments\n\t\t\tif (isArray(child)) {\n\t\t\t\treturn child.length === 1\n\t\t\t\t\t? createChildren(parent, child[0], relative)\n\t\t\t\t\t: child.map(child =>\n\t\t\t\t\t\t\tcreateChildren(parent, child, relative),\n\t\t\t\t\t\t)\n\t\t\t}\n\n\t\t\t/**\n\t\t\t * The value is `null`, as in {null} or like a show returning\n\t\t\t * `null` on the falsy case\n\t\t\t */\n\t\t\tif (child === null || child === nothing) {\n\t\t\t\treturn undefined\n\t\t\t}\n\n\t\t\t// async values\n\t\t\tif ('then' in child) {\n\t\t\t\tconst suspense = useSuspense()\n\t\t\t\tsuspense.add()\n\n\t\t\t\tconst [value, setValue] = signal(undefined)\n\t\t\t\tconst onResult = owned(\n\t\t\t\t\tresult => {\n\t\t\t\t\t\tif (isComponent && isFunction(result)) {\n\t\t\t\t\t\t\tmarkComponent(result)\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tsetValue(result)\n\t\t\t\t\t\tsuspense.remove()\n\t\t\t\t\t},\n\t\t\t\t\t() => suspense.remove(),\n\t\t\t\t)\n\n\t\t\t\tresolved(child, onResult)\n\n\t\t\t\treturn createChildren(parent, value, relative)\n\t\t\t}\n\n\t\t\t// iterable/Map/Set/NodeList\n\t\t\tif (iterator in child) {\n\t\t\t\t/**\n\t\t\t\t * For some reason this breaks with a node list in the\n\t\t\t\t * `Context` example of the `html` docs section.\n\t\t\t\t *\n\t\t\t\t *     return toArray(child.values(), child =>\n\t\t\t\t *     \tcreateChildren(parent, child, relative),\n\t\t\t\t *     )\n\t\t\t\t */\n\t\t\t\treturn createChildren(parent, toValues(child), relative)\n\t\t\t}\n\n\t\t\t// CSSStyleSheet\n\t\t\tif (child instanceof CSSStyleSheet) {\n\t\t\t\t/**\n\t\t\t\t * Custom elements wont report a document unless is already\n\t\t\t\t * connected. So our stylesheet would end on the main document\n\t\t\t\t * instead of the shadowRoot\n\t\t\t\t */\n\t\t\t\tonFixes(() => {\n\t\t\t\t\tif (isConnected(parent)) {\n\t\t\t\t\t\tconst doc = getDocumentForElement(parent)\n\t\t\t\t\t\taddAdoptedStyleSheet(doc, child)\n\n\t\t\t\t\t\tcleanup(() => removeAdoptedStyleSheet(doc, child))\n\t\t\t\t\t}\n\t\t\t\t})\n\n\t\t\t\treturn undefined\n\t\t\t}\n\n\t\t\t// object.toString fancy objects\n\t\t\treturn createChildren(\n\t\t\t\tparent,\n\t\t\t\t// Object.create(null) would fail to convert to string\n\t\t\t\t'toString' in child ? child.toString() : stringify(child),\n\t\t\t\trelative,\n\t\t\t)\n\t\t}\n\t\tcase 'undefined': {\n\t\t\treturn undefined\n\t\t}\n\t\tdefault: {\n\t\t\t// boolean/bigint/symbol/catch all\n\t\t\t// toString() is needed for `Symbol`\n\t\t\treturn insertNode(\n\t\t\t\tparent,\n\t\t\t\tcreateTextNode(child.toString()),\n\t\t\t\trelative,\n\t\t\t)\n\t\t}\n\t}\n}\n\npropsPlugin(\n\t'children',\n\t(node, propValue) => {\n\t\tcreateChildren(node, propValue)\n\t},\n\tfalse,\n)\n\n/**\n * Creates placeholder to keep nodes in position\n *\n * @param {Element | DocumentFragment} parent\n * @param {boolean} [relative]\n * @returns {Element} The placeholder element\n */\nconst createPlaceholder = (parent, relative) =>\n\tinsertNode(parent, createTextNode(''), relative)\n\n/**\n * Adds the element to the document\n *\n * @param {Element | DocumentFragment | ChildNode} parent\n * @param {Element} node\n * @param {boolean} [relative]\n * @returns {Element} The inserted node\n */\nfunction insertNode(parent, node, relative) {\n\t// special case `head`\n\tif (parent === head) {\n\t\tconst name = node.tagName\n\n\t\t// search for tags that should be unique\n\t\tlet prev\n\t\tif (name === 'TITLE') {\n\t\t\tprev = querySelector(head, 'title')\n\t\t} else if (name === 'META') {\n\t\t\tprev =\n\t\t\t\tquerySelector(\n\t\t\t\t\thead,\n\t\t\t\t\t'meta[name=\"' + node.getAttribute('name') + '\"]',\n\t\t\t\t) ||\n\t\t\t\tquerySelector(\n\t\t\t\t\thead,\n\t\t\t\t\t'meta[property=\"' + node.getAttribute('property') + '\"]',\n\t\t\t\t)\n\t\t} else if (\n\t\t\tname === 'LINK' &&\n\t\t\t/** @type HTMLLinkElement */ (node).rel === 'canonical'\n\t\t) {\n\t\t\tprev = querySelector(head, 'link[rel=\"canonical\"]')\n\t\t}\n\n\t\t// replace old node if there's any\n\t\tprev ? prev.replaceWith(node) : parent.appendChild(node)\n\t} else {\n\t\trelative\n\t\t\t? parent.parentNode.insertBefore(node, parent)\n\t\t\t: parent.appendChild(node)\n\t}\n\n\treturn node\n}\n\n// RENDERING\n\n/**\n * WARNINGS Removal of the element on where you render/insert into,\n * wont cause disposal of what you render/insert.\n */\n\n/**\n * Inserts children into a parent\n *\n * @param {any} children - Thing to render\n * @param {Element | null} [parent] - Mount point, defaults to\n *   document.body\n * @param {{ clear?: boolean; relative?: boolean }} [options] -\n *   Mounting options\n * @returns {() => void} Disposer\n * @url https://pota.quack.uy/render\n */\nexport function render(children, parent, options = nothing) {\n\tconst dispose = root(dispose => {\n\t\tinsert(children, parent, options)\n\t\treturn dispose\n\t})\n\n\t// run dispose when the parent scope disposes\n\tcleanup(dispose)\n\n\treturn dispose\n}\n\n/**\n * @param {any} children - Thing to render\n * @param {Element | null} [parent] - Mount point, defaults to\n *   `document.body`\n * @param {{ clear?: boolean; relative?: boolean }} [options] -\n *   Mounting options\n */\nexport function insert(\n\tchildren,\n\tparent = document.body,\n\toptions = nothing,\n) {\n\tif (options.clear && parent) parent.textContent = ''\n\n\tconst node = createChildren(\n\t\tparent,\n\t\tFactory(isFunction(children) ? children : () => children),\n\t\toptions.relative,\n\t)\n\n\tcleanup(() => toDiff(flatToArray(node)))\n\n\treturn node\n}\n\n/**\n * Creates and returns HTML Elements for `children`\n *\n * @param {Children} children\n * @returns {Children}\n * @url https://pota.quack.uy/toHTML\n */\nexport function toHTML(children) {\n\t/**\n\t * DocumentFragment is transformed to an `Array` of `Node/Element`,\n\t * that way we can keep a reference to the nodes. Because when the\n\t * DocumentFragment is used, it removes the nodes from the\n\t * DocumentFragment and then we will lose the reference.\n\t */\n\n\treturn unwrapArray(toHTMLFragment(children).childNodes)\n}\n\n/** @ts-expect-error freaking typescript */\ncontext.toHTML = toHTML\n\n/**\n * Creates and returns a DocumentFragment for `children`\n *\n * @param {Children} children\n * @returns {DocumentFragment}\n * @url https://pota.quack.uy/toHTML\n */\nexport function toHTMLFragment(children) {\n\tconst fragment = new DocumentFragment()\n\tcreateChildren(fragment, children)\n\n\treturn fragment\n}\n\n/**\n * Removes from the DOM `prev` elements not found in `next`\n *\n * @param {DOMElement[]} [prev=[]] - Array with previous elements.\n *   Default is `[]`\n * @param {DOMElement[]} [next=[]] - Array with next elements. Default\n *   is `[]`\n * @param {boolean} [short=false] - Whether to use fast clear. Default\n *   is `false`\n * @returns {DOMElement[]} The next array of elements\n */\nfunction toDiff(prev = [], next = [], short = false) {\n\t// if theres something to remove\n\tif (prev.length) {\n\t\t// fast clear\n\t\tif (\n\t\t\tshort &&\n\t\t\tnext.length === 0 &&\n\t\t\t// + 1 because of the original placeholder\n\t\t\tprev.length + 1 === prev[0].parentNode.childNodes.length\n\t\t) {\n\t\t\tconst parent = prev[0].parentNode\n\t\t\t// save the placeholder\n\t\t\tconst lastChild = parent.lastChild\n\t\t\tparent.textContent = ''\n\t\t\tparent.appendChild(lastChild)\n\t\t} else if (next.length === 0) {\n\t\t\tfor (const item of prev) {\n\t\t\t\titem && item.remove()\n\t\t\t}\n\t\t} else {\n\t\t\tfor (const item of prev) {\n\t\t\t\tif (item && !next.includes(item)) {\n\t\t\t\t\titem.remove()\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\treturn next\n}\n","import {\n\tactiveElement,\n\tdocumentElement,\n\tisConnected,\n} from '../use/dom.js'\n\nimport { makeCallback, map } from '../lib/reactive.js'\n\nimport { onFixes } from '../core/scheduler.js'\n\n/**\n * Renders reactive values from an signal that returns an Iterable\n * object\n *\n * @template T\n * @param {object} props\n * @param {Each<T>} props.each\n * @param {boolean} [props.restoreFocus] - If the focused element\n *   moves it may lose focus\n * @param {boolean} [props.reactiveIndex] - Make indices reactive\n *   signals\n * @param {(item: T, index: number) => Children} [props.children]\n * @param {Children} [props.fallback]\n * @returns {Children}\n * @url https://pota.quack.uy/Components/For\n */\n\nexport const For = props =>\n\tmap(\n\t\t() => {\n\t\t\tprops.restoreFocus && queue()\n\t\t\treturn props.each\n\t\t},\n\t\tmakeCallback(props.children),\n\t\tfalse,\n\t\tprops.fallback,\n\t\tprops.reactiveIndex,\n\t)\n\n/** @type {boolean} */\nlet queued\n\n// because re-ordering the elements trashes focus\nfunction queue() {\n\tif (!queued) {\n\t\tqueued = true\n\n\t\tconst active = activeElement()\n\t\tconst scroll = documentElement.scrollTop\n\n\t\tonFixes(() => {\n\t\t\tqueued = false\n\t\t\t// re-ordering the elements trashes focus\n\t\t\tactive &&\n\t\t\t\tactive !== activeElement() &&\n\t\t\t\tisConnected(active) &&\n\t\t\t\t// @ts-expect-error\n\t\t\t\tactive.focus()\n\n\t\t\tdocumentElement.scrollTop = scroll\n\t\t})\n\t}\n}\n","import { signal, cleanup, syncEffect } from '../lib/reactive.js'\nimport { isIterable, toArray } from '../lib/std.js'\n\n/**\n * Returns a `function` that receives as a second argument whats\n * returned from it.\n *\n * @template T\n * @param {(next: T, previous: T) => T} fn\n */\nexport function usePrevious(fn) {\n\tlet previous\n\n\t/** @param {T} [next] */\n\treturn next => {\n\t\tprevious = fn(next, previous)\n\t}\n}\n\n/**\n * Returns a `isSelected` function that will return `true` when the\n * argument for it matches the original signal `value`.\n *\n * @param {SignalAccessor<unknown>} value - Signal with the current\n *   value\n */\nexport function useSelector(value) {\n\tconst map = new Map()\n\n\tlet prev = []\n\n\tsyncEffect(() => {\n\t\tconst val = value()\n\n\t\tconst selected = isIterable(val)\n\t\t\t? toArray(\n\t\t\t\t\t// @ts-expect-error, no idea how to type this\n\t\t\t\t\tval.values(),\n\t\t\t\t)\n\t\t\t: val === undefined\n\t\t\t\t? []\n\t\t\t\t: [val]\n\n\t\t// unselect\n\t\tfor (const value of prev) {\n\t\t\tif (!selected.includes(value)) {\n\t\t\t\tconst current = map.get(value)\n\t\t\t\tcurrent && current.write(false)\n\t\t\t}\n\t\t}\n\n\t\t// select\n\t\tfor (const value of selected) {\n\t\t\tif (!prev.includes(value)) {\n\t\t\t\tconst current = map.get(value)\n\t\t\t\tcurrent && current.write(true)\n\t\t\t}\n\t\t}\n\t\tprev = selected\n\t})\n\n\t/**\n\t * Is selected function, it will return `true` when the value\n\t * matches the current signal.\n\t *\n\t * @template T\n\t * @param {T} item - Values to compare with current\n\t * @returns {SignalAccessor<T>} A signal with a boolean value\n\t */\n\treturn function isSelected(item) {\n\t\tlet selected = map.get(item)\n\t\tif (!selected) {\n\t\t\tselected = signal(prev.includes(item))\n\t\t\tselected.counter = 1\n\t\t\tmap.set(item, selected)\n\t\t} else {\n\t\t\tselected.counter++\n\t\t}\n\n\t\tcleanup(() => {\n\t\t\tif (--selected.counter === 0) {\n\t\t\t\tmap.delete(item)\n\t\t\t}\n\t\t})\n\n\t\treturn selected.read\n\t}\n}\n","import { render, signal } from 'pota'\nimport { For } from 'pota/components'\n\nimport { usePrevious } from 'pota/use/selector'\n\nlet idCounter = 1\nconst adjectives = [\n    'pretty',\n    'large',\n    'big',\n    'small',\n    'tall',\n    'short',\n    'long',\n    'handsome',\n    'plain',\n    'quaint',\n    'clean',\n    'elegant',\n    'easy',\n    'angry',\n    'crazy',\n    'helpful',\n    'mushy',\n    'odd',\n    'unsightly',\n    'adorable',\n    'important',\n    'inexpensive',\n    'cheap',\n    'expensive',\n    'fancy',\n  ],\n  colours = [\n    'red',\n    'yellow',\n    'blue',\n    'green',\n    'pink',\n    'brown',\n    'purple',\n    'brown',\n    'white',\n    'black',\n    'orange',\n  ],\n  nouns = [\n    'table',\n    'chair',\n    'house',\n    'bbq',\n    'desk',\n    'car',\n    'pony',\n    'cookie',\n    'sandwich',\n    'burger',\n    'pizza',\n    'mouse',\n    'keyboard',\n  ]\n\nfunction _random(max) {\n  return Math.round(Math.random() * 1000) % max\n}\n\nfunction buildData(count) {\n  const data = new Array(count)\n  for (let i = 0; i < count; i++) {\n    const [label, , update] = signal(\n      `${adjectives[_random(adjectives.length)]} ${colours[_random(colours.length)]} ${nouns[_random(nouns.length)]}`,\n    )\n    data[i] = {\n      id: idCounter++,\n      label,\n      update,\n    }\n  }\n  return data\n}\n\nconst Button = ({ id, text, fn }) => (\n  <div class=\"col-sm-6 smallpad\">\n    <button\n      prop:textContent={/* @static */ text}\n      id={/* @static */ id}\n      class=\"btn btn-primary btn-block\"\n      type=\"button\"\n      on:click={fn}\n    />\n  </div>\n)\n\nconst App = () => {\n  const [data, setData, updateData] = signal([]),\n    run = () => {\n      setData(buildData(1000))\n    },\n    runLots = () => {\n      setData(buildData(10000))\n    },\n    add = () => {\n      updateData(d => [...d, ...buildData(1000)])\n    },\n    update = () => {\n      const d = data()\n      const len = d.length\n      for (let i = 0; i < len; i += 10) d[i].update(l => l + ' !!!')\n    },\n    swapRows = () => {\n      const d = [...data()]\n      if (d.length > 998) {\n        const tmp = d[1]\n        d[1] = d[998]\n        d[998] = tmp\n        setData(d)\n      }\n    },\n    clear = () => {\n      setData([])\n    },\n    remove = id => {\n      updateData(d => {\n        const idx = d.findIndex(datum => datum.id === id)\n        d.splice(idx, 1)\n        return [...d]\n      })\n    },\n    danger = usePrevious((next, previous) => {\n      next.setAttribute('class', 'danger')\n\n      if (previous) {\n        previous.removeAttribute('class')\n      }\n      return next\n    })\n\n  return (\n    <div class=\"container\">\n      <div class=\"jumbotron\">\n        <div class=\"row\">\n          <div class=\"col-md-6\">\n            <h1>pota Keyed</h1>\n          </div>\n          <div class=\"col-md-6\">\n            <div class=\"row\">\n              <Button\n                id=\"run\"\n                text=\"Create 1,000 rows\"\n                fn={run}\n              />\n              <Button\n                id=\"runlots\"\n                text=\"Create 10,000 rows\"\n                fn={runLots}\n              />\n              <Button\n                id=\"add\"\n                text=\"Append 1,000 rows\"\n                fn={add}\n              />\n              <Button\n                id=\"update\"\n                text=\"Update every 10th row\"\n                fn={update}\n              />\n              <Button\n                id=\"clear\"\n                text=\"Clear\"\n                fn={clear}\n              />\n              <Button\n                id=\"swaprows\"\n                text=\"Swap Rows\"\n                fn={swapRows}\n              />\n            </div>\n          </div>\n        </div>\n      </div>\n      <table class=\"table table-hover table-striped test-data\">\n        <tbody\n          on:click={e => {\n            if ('remove' in e.target.dataset) {\n              remove(\n                +e.target.parentNode.parentNode.parentNode.firstChild\n                  .textContent,\n              )\n            } else if ('select' in e.target.dataset) {\n              danger(e.target.parentNode.parentNode)\n            }\n          }}\n        >\n          <For each={data}>\n            {row => {\n              return (\n                <tr>\n                  <td\n                    prop:textContent={/* @static  */ row.id}\n                    class=\"col-md-1\"\n                  />\n                  <td class=\"col-md-4\">\n                    <a\n                      data-select\n                      prop:textContent={row.label}\n                    />\n                  </td>\n                  <td class=\"col-md-1\">\n                    <a>\n                      <span\n                        data-remove\n                        aria-hidden=\"true\"\n                        class=\"glyphicon glyphicon-remove\"\n                      />\n                    </a>\n                  </td>\n                  <td class=\"col-md-6\" />\n                </tr>\n              )\n            }}\n          </For>\n        </tbody>\n      </table>\n      <span\n        aria-hidden=\"true\"\n        class=\"preloadicon glyphicon glyphicon-remove\"\n      />\n    </div>\n  )\n}\n\nrender(App, document.getElementById('main'))\n"],"names":["window","globalThis","queueMicrotask","Object","Array","Symbol","assign","freeze","toArray","from","toValues","value","isArray","isObject","values","toEntries","entries","iterator","stringify","JSON","resolved","promise","onDone","then","catch","e","error","toString","call","fns","fn","flatForEach","arr","flat","Infinity","forEach","nothing","empty","create","bind","emptyArray","unwrapArray","length","flatToArray","flatNoArray","withState","state","cacheStore","withCache","cache","thing","get","getValue","isFunction","isString","isPromise","noop","removeFromArray","array","index","indexOf","splice","walkParents","context","propertyName","cb","DataStore","constructor","kind","store","set","has","del","delete","target","defaults","o","undefined","Map","args","console","$isComponent","$isMap","prefix","NS","__proto__","svg","math","html","xlink","xmlns","xml","createReactiveSystem","Owner","Listener","Updates","Effects","Time","Root","owner","owned","cleanups","options","addCleanups","push","cleanupCancel","addOwned","dispose","disposeOwned","doCleanups","i","Computation","updatedAt","sources","sourceSlots","update","time","runWith","source","observers","observer","slot","pop","observerSlots","queue","Effect","user","batch","SyncEffect","Memo","equals","equalsFalse","read","updates","runUpdates","upstream","sourceSlot","observerSlot","write","downstream","a","b","nextValue","Derived","isResolved","self","run","slice","withValue","shift","writeNextValue","resolve","thenRestore","reject","_then","Signal","untrack","root","runWithOwner","signal","initialValue","effect","track","ran","syncEffect","on","depend","memo","derived","listener","prevOwner","prevListener","cleanup","runTop","node","ancestors","init","wait","res","effects","runEffects","err","userLength","ignore","defaultValue","id","useContext","newValue","ret","Provider","props","toHTML","children","walk","callback","onCancel","cleaned","clean","writeDefaultValue","asyncTracking","add","remove","cbs","action","added","count","ready","createSuspenseContext","s","c","isEmpty","useSuspense","withPrevValue","prev","val","Row","runId","item","isDupe","disposer","nodes","indexSignal","_begin","_end","reactiveIndex","updateIndex","begin","getBegin","end","getEnd","nodesForRow","nextSibling","map","list","noSort","fallback","duplicates","rows","clear","row","mapper","items","hasPrev","dupes","dupe","unsort","unsorted","sorted","usort","includes","after","before","current","previous","previousSibling","makeCallback","markComponent","childrenMaybeArray","child","addEvent","type","handler","addEventListener","removeEvent","removeEventListener","ownedEvent","handleEvent","document","head","isConnected","activeElement","documentElement","DocumentFragment","createElement","createElementNS","createTextNode","importNode","createTreeWalker","tokenList","trim","split","addClass","className","classList","removeClass","querySelector","query","getDocumentForElement","getRootNode","nodeType","ownerDocument","walkElements","max","currentNode","nextNode","CSSStyleSheet","sheet","css","replace","getAdoptedStyleSheets","adoptedStyleSheets","addAdoptedStyleSheet","styleSheet","removeAdoptedStyleSheet","reset","priority","q","onFixes","onProps","onMount","plugins","pluginsNS","namespaces","Set","updateNamespaces","ns","join","propsPlugin","propName","onMicrotask","plugin","propsPluginNS","NSName","name","setProperty","_setProperty","setPropertyNS","localName","setEvent","setEventNS","randomId","crypto","getRandomValues","BigUint64Array","setCSS","setNodeCSS","setRef","setConnected","setDisconnected","setStyle","setNodeStyle","style","setStyleNS","cssText","setStyleValue","_setStyleValue","removeProperty","setClass","setAttribute","setClassList","setClassNS","setElementClass","_setClassListValue","_setAttribute","removeAttribute","setAttributeNS","_setAttributeNS","removeAttributeNS","propNS","assignProps","assignProp","useXMLNS","Factory","createTag","Element","createNode","tagName","withXMLNS","is","usedXML","nsContext","parseXML","content","template","innerHTML","tlpContent","childNodes","firstChild","append","createComponent","component","createPartial","propsData","clone","x","cloneNode","assignPartialProps","m","createChildren","parent","relative","isComponent","Text","nodeValue","textContent","insertNode","createPlaceholder","toDiff","Node","suspense","setValue","onResult","result","doc","propValue","getAttribute","rel","replaceWith","appendChild","parentNode","insertBefore","render","insert","body","toHTMLFragment","fragment","next","short","lastChild","For","restoreFocus","each","queued","active","scroll","scrollTop","focus","usePrevious","_For","_createComponent","idCounter","adjectives","colours","nouns","_random","Math","round","random","buildData","data","label","Button","text","_div","_node","_getValue","_setEvent","_Button","App","setData","updateData","runLots","d","len","l","swapRows","tmp","idx","findIndex","datum","danger","_div2","_node5","_createChildren","_node15","dataset","_tr","_node9","_node0","getElementById"],"mappings":"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"}